/**
 * skylark-domx-plugins-panels - The skylark panel plugins library for dom api extension
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-widgets/skylark-domx-plugins-panels/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./panels","./panel"],function(t,e,s,i,n,a,r,l,d){var p=d.inherit({klassName:"Wizard",pluginName:"lark.panels.wizard",options:{disablePreviousStep:!1,selectedItem:{step:-1}},_construct:function(e,s){d.prototype._construct.call(this,e,s),this.$element=this.$(),this.options.disablePreviousStep="previous"===this.$element.attr("data-restrict")||this.options.disablePreviousStep,this.currentStep=this.options.selectedItem.step,this.numSteps=this.$element.find(".steps li").length,this.$prevBtn=this.$element.find("button.btn-prev"),this.$nextBtn=this.$element.find("button.btn-next");var i=this.$nextBtn.children().detach();this.nextText=t.trim(this.$nextBtn.text()),this.$nextBtn.append(i);var n=this.$element.children(".steps-container");0===n.length&&(n=this.$element,this.$element.addClass("no-steps-container"),window&&window.console&&window.console.warn&&window.console.warn('please update your wizard markup to include ".steps-container" as seen in http://getfuelux.com/javascript.html#wizard-usage-markup')),n=n.find(".steps"),this.$prevBtn.on("click.fu.wizard",t.proxy(this.previous,this)),this.$nextBtn.on("click.fu.wizard",t.proxy(this.next,this)),n.on("click.fu.wizard","li.complete",t.proxy(this.stepclicked,this)),this.selectedItem(this.options.selectedItem),this.options.disablePreviousStep&&(this.$prevBtn.attr("disabled",!0),this.$element.find(".steps").addClass("previous-disabled"))},destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},addSteps:function(t){var e,s,i,n,r,l,d=[].slice.call(arguments).slice(1),p=this.$element.find(".steps"),h=this.$element.find(".step-content");for(t=-1===t||t>this.numSteps+1?this.numSteps+1:t,d[0]instanceof Array&&(d=d[0]),r=p.find("li:nth-child("+t+")"),n=h.find(".step-pane:nth-child("+t+")"),r.length<1&&(r=null),e=0,s=d.length;e<s;e++)(l=a('<li data-step="'+t+'"><span class="badge badge-info"></span></li>')).append(d[e].label||"").append('<span class="chevron"></span>'),l.find(".badge").append(d[e].badge||t),(i=a('<div class="step-pane" data-step="'+t+'"></div>')).append(d[e].pane||""),r?(r.before(l),n.before(i)):(p.append(l),h.append(i)),t++;this.syncSteps(),this.numSteps=p.find("li").length,this.setState()},removeSteps:function(t,e){var s,i="nextAll",n=0,r=this.$element.find(".steps"),l=this.$element.find(".step-content");e=void 0!==e?e:1,t>r.find("li").length?s=r.find("li:last"):(s=r.find("li:nth-child("+t+")").prev()).length<1&&(i="children",s=r),s[i]().each(function(){var t=a(this),s=t.attr("data-step");if(!(n<e))return!1;t.remove(),l.find('.step-pane[data-step="'+s+'"]:first').remove(),n++}),this.syncSteps(),this.numSteps=r.find("li").length,this.setState()},setState:function(){var t=this.currentStep>1,e=1===this.currentStep,i=this.currentStep===this.numSteps;this.options.disablePreviousStep||this.$prevBtn.attr("disabled",!0===e||!1===t);var n=this.$nextBtn.attr("data-last");if(n){this.lastText=n;var r=this.nextText;!0===i?(r=this.lastText,this.$element.addClass("complete")):this.$element.removeClass("complete");var l=this.$nextBtn.children().detach();this.$nextBtn.text(r).append(l)}var d=this.$element.find(".steps li");d.removeClass("active").removeClass("complete"),d.find("span.badge").removeClass("badge-info").removeClass("badge-success");var p=".steps li:lt("+(this.currentStep-1)+")",h=this.$element.find(p);h.addClass("complete"),h.find("span.badge").addClass("badge-success");var c=".steps li:eq("+(this.currentStep-1)+")",o=this.$element.find(c);o.addClass("active"),o.find("span.badge").addClass("badge-info");var f=this.$element.find(".step-content"),m=o.attr("data-step");f.find(".step-pane").removeClass("active"),f.find('.step-pane[data-step="'+m+'"]:first').addClass("active"),this.$element.find(".steps").first().attr("style","margin-left: 0");var u=0;this.$element.find(".steps > li").each(function(){u+=a(this).outerWidth()});var v=0;if(v=this.$element.find(".actions").length?this.$element.width()-this.$element.find(".actions").first().outerWidth():this.$element.width(),u>v){var $=u-v;this.$element.find(".steps").first().attr("style","margin-left: -"+$+"px"),this.$element.find("li.active").first().position().left<200&&(($+=this.$element.find("li.active").first().position().left-200)<1?this.$element.find(".steps").first().attr("style","margin-left: 0"):this.$element.find(".steps").first().attr("style","margin-left: -"+$+"px"))}if(void 0!==this.initialized){var g=s.create("changed.fu.wizard");this.$element.trigger(g,{step:this.currentStep})}this.initialized=!0},stepclicked:function(t){var e=a(t.currentTarget),i=this.$element.find(".steps li").index(e);if(!(i<this.currentStep&&this.options.disablePreviousStep)){var n=s.create("stepclicked.fu.wizard");this.$element.trigger(n,{step:i+1}),n.isDefaultPrevented()||(this.currentStep=i+1,this.setState())}},syncSteps:function(){var t=1,e=this.$element.find(".steps"),s=this.$element.find(".step-content");e.children().each(function(){var e=a(this),i=e.find(".badge"),n=e.attr("data-step");isNaN(parseInt(i.html(),10))||i.html(t),e.attr("data-step",t),s.find('.step-pane[data-step="'+n+'"]:last').attr("data-step",t),t++})},previous:function(){if(!this.options.disablePreviousStep&&1!==this.currentStep){var t=s.create("actionclicked.fu.wizard");if(this.$element.trigger(t,{step:this.currentStep,direction:"previous"}),!t.isDefaultPrevented()&&(this.currentStep-=1,this.setState(),this.$prevBtn.is(":focus"))){var e=this.$element.find(".active").find("input, select, textarea")[0];void 0!==e?a(e).focus():0===this.$element.find(".active input:first").length&&this.$prevBtn.is(":disabled")&&this.$nextBtn.focus()}}},next:function(){var t=s.create("actionclicked.fu.wizard");if(this.$element.trigger(t,{step:this.currentStep,direction:"next"}),!t.isDefaultPrevented()&&(this.currentStep<this.numSteps?(this.currentStep+=1,this.setState()):this.$element.trigger("finished.fu.wizard"),this.$nextBtn.is(":focus"))){var e=this.$element.find(".active").find("input, select, textarea")[0];void 0!==e?a(e).focus():0===this.$element.find(".active input:first").length&&this.$nextBtn.is(":disabled")&&this.$prevBtn.focus()}},selectedItem:function(t){var e,s;return t?(s=t.step||-1,1<=(s=Number(this.$element.find('.steps li[data-name="'+s+'"]').first().attr("data-step"))||Number(s))&&s<=this.numSteps?(this.currentStep=s,this.setState()):(s=this.$element.find(".steps li.active:first").attr("data-step"),isNaN(s)||(this.currentStep=parseInt(s,10),this.setState())),e=this):(e={step:this.currentStep},this.$element.find(".steps li.active:first[data-name]").length&&(e.stepname=this.$element.find(".steps li.active:first").attr("data-name"))),e}});return r.register(p),l.Wizard=p});
//# sourceMappingURL=sourcemaps/wizard.js.map
