/**
 * skylark-slax-runtime - The skylark shells widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-slax/skylark-slax-runtime/
 * @license MIT
 */
!function(factory,globals){var define=globals.define,require=globals.require,isAmd="function"==typeof define&&define.amd,isCmd=!isAmd&&"undefined"!=typeof exports;if(!isAmd&&!define){var map={};define=globals.define=function(t,e,n){"function"==typeof n?(map[t]={factory:n,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var n=e.split("/"),r=t.split("/");n.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?n.pop():n.push(r[i]));return n.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):map[t]={factory:null,resolved:!0,exports:n}},require=globals.require=function(t){if(!map.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=map[t];if(!module.resolved){var e=[];module.deps.forEach(function(t){e.push(require(t))}),module.exports=module.factory.apply(globals,e)||null,module.resolved=!0}return module.exports}}if(!define)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(define,require){define("skylark-langx-ns/_attach",[],function(){return function(t,e,n){"string"==typeof e&&(e=e.split("."));for(var r=e.length,i=t,s=0,a=e[s++];s<r;)i=i[a]=i[a]||{},a=e[s++];return i[a]=n}}),define("skylark-langx-ns/ns",["./_attach"],function(t){var e={attach:function(n,r){return t(e,n,r)}};return e}),define("skylark-langx-ns/main",["./ns"],function(t){return t}),define("skylark-langx-ns",["skylark-langx-ns/main"],function(t){return t}),define("skylark-langx-types/types",["skylark-langx-ns"],function(t){var e,n=Array.isArray,r={}.toString,i=(e={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t){e["[object "+t+"]"]=t.toLowerCase()}),function(t){return null==t?String(t):e[r.call(t)]||"object"}),s=n||function(t){return object&&object.constructor===Array};function a(t){var e;for(e in t)if(null!==t[e])return!1;return!0}function o(t){return"function"==i(t)}function l(t){return t&&t.nodeType}function u(t){return"number"==typeof t}function c(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function h(t){return"string"==typeof t}function f(t){return t&&t==t.window}function d(t){return"symbol"==typeof t||isObjectLike(t)&&objectToString.call(t)==symbolTag}var p=1/0,m=1.7976931348623157e308,g=NaN,y=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,x=/^0b[01]+$/i,k=/^0o[0-7]+$/i,b=parseInt;function _(t){if(!t)return 0===t?t:0;if((t=w(t))===p||t===-p){var e=t<0?-1:1;return e*m}return t==t?t:0}function w(t){if("number"==typeof t)return t;if(d(t))return g;if(c(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=c(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(y,"");var n=x.test(t);return n||k.test(t)?b(t.slice(2),n?2:8):v.test(t)?g:+t}return t.attach("langx.types",{isArray:s,isArrayLike:function(t){return!h(t)&&!l(t)&&"number"==typeof t.length&&!o(t)},isBoolean:function(t){return!0===t||!1===t||"[object Boolean]"===r.call(t)},isDefined:function(t){return void 0!==t},isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isElement:function(t){return!(!t||1!==t.nodeType)},isEmpty:a,isEmptyObject:a,isFunction:o,isHtmlNode:l,isNaN:function(t){return isNaN(t)},isNull:function(t){return null===t},isNumber:u,isNumeric:u,isObject:c,isPlainObject:function(t){return c(t)&&!f(t)&&Object.getPrototypeOf(t)==Object.prototype},isString:h,isSameOrigin:function(t){if(t){var e=location.protocol+"//"+location.hostname;return location.port&&(e+=":"+location.port),t.startsWith(e)}},isSymbol:d,isUndefined:function(t){return void 0===t},isWindow:f,type:i,toFinite:_,toNumber:w,toInteger:function(t){var e=_(t),n=e%1;return e==e?n?e-n:e:0}})}),define("skylark-langx-types/main",["./types"],function(t){return t}),define("skylark-langx-types",["skylark-langx-types/main"],function(t){return t}),define("skylark-langx-objects/objects",["skylark-langx-ns","skylark-langx-types"],function(t,e){var n,r,i=Object.prototype.hasOwnProperty,s=Array.prototype.slice,a=e.isBoolean,o=e.isFunction,l=e.isObject,u=e.isPlainObject,c=e.isArray,h=e.isArrayLike,f=e.isString,d=e.toInteger;var p,m,g="undefined"!=typeof Symbol?Symbol.prototype:null;function y(t){if(!l(t))return[];var e=[];for(var n in t)e.push(n);return e}function v(t,e){if(!c(e))return null!=t&&i.call(t,e);for(var n=e.length,r=0;r<n;r++){var s=e[r];if(null==t||!i.call(t,s))return!1;t=t[s]}return!!n}function x(t,e,n,r){for(var i in e)r&&void 0!==t[i]||(n&&u(e[i])?(u(t[i])||(t[i]={}),x(t[i],e[i],n,r)):void 0!==e[i]&&(t[i]=e[i]));return t}function k(t){var e=s.call(arguments,0),n=e.shift(),r=!1;return a(e[e.length-1])&&(r=e.pop()),{target:n,sources:e,deep:r}}function b(){var t=k.apply(this,arguments);return t.sources.forEach(function(e){x(t.target,e,t.deep,!1)}),t.target}function _(t){for(var e=y(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r}return n=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var s=typeof t;return("function"===s||"object"===s||"object"==typeof e)&&r(t,e,n,i)},r=function(t,e,r,i){var s=toString.call(t);if(s!==toString.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return g.valueOf.call(t)===g.valueOf.call(e)}var a="[object Array]"===s;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,u=e.constructor;if(l!==u&&!(o(l)&&l instanceof l&&o(u)&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}r=r||[],i=i||[];for(var c=r.length;c--;)if(r[c]===t)return i[c]===e;if(r.push(t),i.push(e),a){if((c=t.length)!==e.length)return!1;for(;c--;)if(!n(t[c],e[c],r,i))return!1}else{var h,f=Object.keys(t);if(c=f.length,Object.keys(e).length!==c)return!1;for(;c--;)if(h=f[c],void 0===e[h]||!n(t[h],e[h],r,i))return!1}return r.pop(),i.pop(),!0},t.attach("langx.objects",{allKeys:y,attach:t.attach,clone:function t(e,n){var r;if(void 0===e||null===e)r=e;else if(n&&e.clone)r=e.clone();else if(c(e)){r=[];for(var i=0;i<e.length;i++)r.push(t(e[i]))}else if(u(e))for(var s in r={},e)r[s]=t(e[s]);else r=e;return r},defaults:(p=y,m=!0,function(t){var e=arguments.length;if(m&&(t=Object(t)),e<2||null==t)return t;for(var n=1;n<e;n++)for(var r=arguments[n],i=p(r),s=i.length,a=0;a<s;a++){var o=i[a];m&&void 0!==t[o]||(t[o]=r[o])}return t}),each:function(t,e,n){var r,i,s,a;if(t)if(void 0===(r=t.length)){for(i in t)if(t.hasOwnProperty(i)&&(a=t[i],!1===(n?e.call(a,a,i):e.call(a,i,a))))break}else for(s=0;s<r&&(a=t[s],!1!==(n?e.call(a,a,s):e.call(a,s,a)));s++);return this},extend:function(t){var e,n=s.call(arguments,1);"boolean"==typeof t&&(e=t,t=n.shift());0==n.length&&(n=[t],t=this);return n.forEach(function(n){b(t,n,e)}),t},has:v,isEqual:function(t,e){return n(t,e)},includes:function(t,e,n,r){t=h(t)?t:_(t),n=n&&!r?d(n):0;var i=t.length;n<0&&(n=nativeMax(i+n,0));return f(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&baseIndexOf(t,e,n)>-1},isMatch:function(t,e){var n=n(e),r=n.length;if(null==t)return!r;for(var i=Object(t),s=0;s<r;s++){var a=n[s];if(e[a]!==i[a]||!(a in i))return!1}return!0},keys:function(t){if(l(t))return[];var e=[];for(var n in t)v(t,n)&&e.push(n);return e},mixin:b,omit:function(t,e,n){if(!t)return null;for(var r=b({},t),i=1;i<arguments.length;i++){var s=arguments[i];s in t&&delete r[s]}return r},pick:function(t,e,n){if(!t)return null;for(var r={},i=1;i<arguments.length;i++){var s=arguments[i];s in t&&(r[s]=t[s])}return r},removeItem:function(t,e){if(c(t)){var n=t.indexOf(e);-1!=n&&t.splice(n,1)}else if(u(t))for(var r in t)if(t[r]==e){delete t[r];break}return this},result:function(t,e,n){c(e)||(e=e.split("."));var r=e.length;if(!r)return o(n)?n.call(t):n;for(var i=0;i<r;i++){var s=null==t?void 0:t[e[i]];void 0===s&&(s=n,i=r),t=o(s)?s.call(t):s}return t},safeMixin:function(){var t=k.apply(this,arguments);return t.sources.forEach(function(e){x(t.target,e,t.deep,!0)}),t.target},scall:function(t,e,n,r){if(t&&t[e]){var i=2 in arguments&&s.call(arguments,2);return t[e].apply(t,i)}},values:_})}),define("skylark-langx-objects/main",["./objects"],function(t){return t}),define("skylark-langx-objects",["skylark-langx-objects/main"],function(t){return t}),define("skylark-langx-hoster/hoster",["skylark-langx-ns"],function(t){var e={isBrowser:!0,isNode:null,global:this,browser:null,node:null};"object"==typeof process&&process.versions&&process.versions.node&&process.versions.v8&&(e.isNode=!0,e.isBrowser=!1),e.global=function(){return"undefined"!=typeof global&&"function"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}();var n=null;if(Object.defineProperty(e,"document",function(){if(!n){var t="undefined"==typeof window?require("html-element"):window;n=t.document}return n}),void 0===e.global.CustomEvent&&(e.global.CustomEvent=function(t,e){this.type=t,this.props=e}),Object.defineProperty(e,"document",function(){if(!n){var t="undefined"==typeof window?require("html-element"):window;n=t.document}return n}),e.isBrowser){var r=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(navigator.userAgent),i=e.browser={};r.browser&&(i[r.browser]=!0,i.version=r.version),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0)}return e.detects={},t.attach("langx.hoster",e)}),define("skylark-langx-hoster/detects/mobile",["../hoster"],function(t){var e=/iPhone/i,n=/iPod/i,r=/iPad/i,i=/\biOS-universal(?:.+)Mac\b/i,s=/\bAndroid(?:.+)Mobile\b/i,a=/Android/i,o=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,l=/Silk/i,u=/Windows Phone/i,c=/\bWindows(?:.+)ARM\b/i,h=/BlackBerry/i,f=/BB10/i,d=/Opera Mini/i,p=/\b(CriOS|Chrome)(?:.+)Mobile/i,m=/Mobile(?:.+)Firefox\b/i,g=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};return t.detects.mobile=function(t){var y={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?y.userAgent=t:t&&t.userAgent&&(y={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):y={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var v=y.userAgent,x=v.split("[FBAN");void 0!==x[1]&&(v=x[0]);void 0!==(x=v.split("Twitter"))[1]&&(v=x[0]);var k=function(t){return function(e){return e.test(t)}}(v),b={apple:{phone:k(e)&&!k(u),ipod:k(n),tablet:!k(e)&&(k(r)||g(y))&&!k(u),universal:k(i),device:(k(e)||k(n)||k(r)||k(i)||g(y))&&!k(u)},amazon:{phone:k(o),tablet:!k(o)&&k(l),device:k(o)||k(l)},android:{phone:!k(u)&&k(o)||!k(u)&&k(s),tablet:!k(u)&&!k(o)&&!k(s)&&(k(l)||k(a)),device:!k(u)&&(k(o)||k(l)||k(s)||k(a))||k(/\bokhttp\b/i)},windows:{phone:k(u),tablet:k(c),device:k(u)||k(c)},other:{blackberry:k(h),blackberry10:k(f),opera:k(d),firefox:k(m),chrome:k(p),device:k(h)||k(f)||k(d)||k(m)||k(p)},any:!1,phone:!1,tablet:!1};return b.any=b.apple.device||b.android.device||b.windows.device||b.other.device,b.phone=b.apple.phone||b.android.phone||b.windows.phone,b.tablet=b.apple.tablet||b.android.tablet||b.windows.tablet,b}}),define("skylark-langx-hoster/isMobile",["./hoster","./detects/mobile"],function(t,e){return void 0==t.isMobile&&(t.isMobile=e()),t.isMobile}),define("skylark-langx-hoster/main",["./hoster","./isMobile"],function(t){return t}),define("skylark-langx-hoster",["skylark-langx-hoster/main"],function(t){return t}),define("skylark-langx-arrays/arrays",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects"],function(t,e,n){var r=Array.prototype.filter,i=Array.prototype.find,s=e.isArrayLike;function a(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function o(t){return t!=t}function l(t){if(s(t)){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(s(r))for(var i=0;i<r.length;i++)e.push(r[i]);else e.push(r)}return e}return t}function u(t,e,n){return s(t)?(n||[]).concat(Array.prototype.slice.call(t,e||0)):[t]}return t.attach("langx.arrays",{baseFindIndex:a,baseIndexOf:function(t,e,n){if(e!=e)return a(t,o,n);var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1},compact:function(t){return r.call(t,function(t){return null!=t})},first:function(t,e){return e?t.slice(0,e):t[0]},filter:function(t,e){return r.call(t,e)},find:function(t,e){return i.call(t,e)},flatten:l,grep:function(t,e){var r=[];return n.each(t,function(t,n){e(n,t)&&r.push(n)}),r},inArray:function(t,e){if(!e)return-1;var n;if(e.indexOf)return e.indexOf(t);n=e.length;for(;n--;)if(e[n]===t)return n;return-1},makeArray:u,toArray:u,merge:function(t,e){var n=e.length,r=t.length,i=0;if("number"==typeof n)for(;i<n;i++)t[r++]=e[i];else for(;void 0!==e[i];)t[r++]=e[i++];return t.length=r,t},forEach:function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n)},map:function(t,e){var n,r,i,a=[];if(s(t))for(r=0;r<t.length;r++)null!=(n=e.call(t[r],t[r],r))&&a.push(n);else for(i in t)null!=(n=e.call(t[i],t[i],i))&&a.push(n);return l(a)},reduce:function(t,e,n){return Array.prototype.reduce.call(t,e,n)},uniq:function(t){return r.call(t,function(e,n){return t.indexOf(e)==n})}})}),define("skylark-langx-arrays/main",["./arrays"],function(t){return t}),define("skylark-langx-arrays",["skylark-langx-arrays/main"],function(t){return t}),define("skylark-langx-funcs/funcs",["skylark-langx-ns"],function(t,e,n){return t.attach("langx.funcs",{noop:function(){},returnTrue:function(){return!0},returnFalse:function(){return!1}})}),define("skylark-langx-funcs/debounce",["./funcs"],function(t){return t.debounce=function(t,e){var n;return function(){var r=this,i=arguments;function s(){n&&clearTimeout(n),n=void 0}return s(),n=setTimeout(function(){n=null,t.apply(r,i)},e),{stop:s}}}}),define("skylark-langx-funcs/defer",["./funcs"],function(t){return t.defer=function(t){var e,n={stop:null};requestAnimationFrame?(e=requestAnimationFrame(t),n.stop=function(){return cancelAnimationFrame(e)}):(e=setTimeoutout(t),n.stop=function(){return clearTimeout(e)});return n}}),define("skylark-langx-funcs/delegate",["skylark-langx-objects","./funcs"],function(t,e){var n=t.mixin,r=function(){function t(){}return function(e,r){t.prototype=e;var i=new t;return t.prototype=null,r&&n(i,r),i}}();return e.delegate=r}),define("skylark-langx-funcs/loop",["./funcs"],function(t){function e(t){this.callback=t,this.running=!1,this.id=-1}return e.prototype.start=function(){if(!this.running){this.running=!0;var t=this;!function e(){t.callback();t.running&&(t.id=requestAnimationFrame(e))}()}},e.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},t.loop=function(t){return new e(t)}}),define("skylark-langx-funcs/negate",["./funcs"],function(t){return t.negate=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(...e){return!t.apply(this,e)}}}),define("skylark-langx-funcs/proxy",["skylark-langx-types","./funcs"],function(t,e){var n=Array.prototype.slice,r=t.isFunction,i=t.isString;return e.bind=e.proxy=function t(e,s){var a=2 in arguments&&n.call(arguments,2);if(r(e)){return function(){return e.apply(s,a?a.concat(n.call(arguments)):arguments)}}if(i(s))return a?(a.unshift(e[s],e),t.apply(null,a)):t(e[s],e);throw new TypeError("expected function")}}),define("skylark-langx-funcs/template",["./funcs"],function(t){Array.prototype.slice;var e={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},n=/(.)^/,r={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},i=/\\|'|\r|\n|\t|\u2028|\u2029/g;function s(t,s,a){var o;a=objects.defaults({},a,e);var l=RegExp([(a.escape||n).source,(a.interpolate||n).source,(a.evaluate||n).source].join("|")+"|$","g"),u=0,c="__p+='";t.replace(l,function(e,n,s,a,o){return c+=t.slice(u,o).replace(i,function(t){return"\\"+r[t]}),n&&(c+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),s&&(c+="'+\n((__t=("+s+"))==null?'':__t)+\n'"),a&&(c+="';\n"+a+"\n__p+='"),u=o+e.length,e}),c+="';\n",a.variable||(c="with(obj||{}){\n"+c+"}\n"),c="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+c+"return __p;\n";try{o=new Function(a.variable||"obj","_",c)}catch(t){throw t.source=c,t}if(s)return o(s,this);var h=proxy(function(t){return o.call(this,t,this)},this),f=a.variable||"obj";return h.source="function("+f+"){\n"+c+"}",h}return s.templateSettings=t.templateSettings=e,t.template=s}),define("skylark-langx-funcs/main",["./funcs","./debounce","./defer","./delegate","./loop","./negate","./proxy","./template"],function(t){return t}),define("skylark-langx-funcs",["skylark-langx-funcs/main"],function(t){return t}),define("skylark-langx-async/Deferred",["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(t,e,n){"use strict";var r=Array.prototype.slice,i=e.proxy,s=t.makeArray,a=n.result,o=n.mixin;o(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(){for(var t=0;t<arguments.length;t++)this.then(arguments[t]);return this},fail:function(t){return this.catch(t),this}});var l=function(){var t=this;this.promise=u(new Promise(function(e,n){t._resolve=e,t._reject=n}))};function u(t){if(t.isResolved)return t;var e=!0,n=!1,r=!1,i=t.then(function(t){return r=!0,e=!1,t},function(t){throw n=!0,e=!1,t});i.isResolved=function(){return r},i.isPending=function(){return e},i.isRejected=function(){return n},i.state=function(){return r?"resolved":n?"rejected":"pending"};var s=[],a=[];return i.then=function(t,e,n){return n&&this.progress(n),u(Promise.prototype.then.call(this,t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)},e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)}))},i.progress=function(t){return s.forEach(function(e){t(e)}),a.push(t),this},i.pipe=i.then,i.notify=function(t){try{return s.push(t),a.forEach(function(e){return e(t)})}catch(t){this.reject(t)}return this},i}return l.prototype.resolve=function(t){var e=r.call(arguments);return this.resolveWith(null,e)},l.prototype.resolveWith=function(t,e){return(e=e?s(e):[]).__ctx__=t,this._resolve(e),this._resolved=!0,this},l.prototype.notify=function(t){var e=a(this,"promise");return e.notify(t),this},l.prototype.reject=function(t){var e=r.call(arguments);return this.rejectWith(null,e)},l.prototype.rejectWith=function(t,e){return(e=e?s(e):[]).__ctx__=t,this._reject(e),this._rejected=!0,this},l.prototype.isResolved=function(){var t=a(this,"promise");return t.isResolved()},l.prototype.isRejected=function(){var t=a(this,"promise");return t.isRejected()},l.prototype.state=function(){var t=a(this,"promise");return t.state()},l.prototype.then=function(t,e,n){var r=a(this,"promise");return r.then(t,e,n)},l.prototype.progress=function(t){var e=a(this,"promise");return e.progress(t)},l.prototype.catch=function(t){var e=a(this,"promise");return e.catch(t)},l.prototype.always=function(){var t=a(this,"promise");return t.always.apply(t,arguments),this},l.prototype.done=function(){var t=a(this,"promise");return t.done.apply(t,arguments),this},l.prototype.fail=function(t){var e=a(this,"promise");return e.fail(t),this},l.all=function(t){var e=new l;return Promise.all(t).then(e.resolve.bind(e),e.reject.bind(e)),a(e,"promise")},l.first=function(t){return u(Promise.race(t))},l.when=function(t,e,n,r){var s=t&&"function"==typeof t.then,a=s&&t instanceof Promise;if(!s)return arguments.length>1?e?e(t):t:(new l).resolve(t);if(!a){var o=new l(t.cancel);t.then(i(o.resolve,o),i(o.reject,o),o.notify),t=o.promise}return e||n||r?t.then(e,n,r):t},l.reject=function(t){var e=new l;return e.reject(t),e.promise},l.immediate=l.resolve=function(t){var e=new l;return e.resolve.apply(e,arguments),e.promise},l.promise=function(t){var e=new l;return t(e.resolve.bind(e),e.reject.bind(e),e.progress.bind(e)),e.promise},l}),define("skylark-langx-async/async",["skylark-langx-ns","skylark-langx-objects","./Deferred"],function(t,e,n){var r=e.each,i={Deferred:n,parallel:function(t,e,i){var s=[];return i=i||null,e=e||[],r(t,function(t,n){s.push(n.apply(i,e))}),n.all(s)},series:function(t,e,i){var s=[],a=new n,o=a.promise;return i=i||null,e=e||[],a.resolve(),r(t,function(t,n){o=o.then(function(){return n.apply(i,e)}),s.push(o)}),n.all(s)},waterful:function(t,e,i){var s=new n,a=s.promise;return i=i||null,e=e||[],s.resolveWith(i,e),r(t,function(t,e){a=a.then(e)}),a}};return t.attach("langx.async",i)}),define("skylark-langx-async/main",["./async"],function(t){return t}),define("skylark-langx-async",["skylark-langx-async/main"],function(t){return t}),define("skylark-langx-events/events",["skylark-langx-ns"],function(t){return t.attach("langx.events",{})}),define("skylark-langx-klass/klass",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays"],function(t,e,n,r){var i=r.uniq,s=n.has,a=n.mixin,o=e.isArray,l=e.isDefined;var u=function(){function t(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function n(r,u,c,h){o(u)&&(h=c,c=u,u=null),u=u||Object,l(c)&&!o(c)&&(h=c,c=!1);var f=u;c&&(c=function(t,e){var n=[];return e.forEach(function(t){if(s(t,"__mixins__"))throw new Error("nested mixins");for(var e=[];t;)e.unshift(t),t=t.superclass;n=n.concat(e)}),(n=(n=i(n)).filter(function(e){for(var n=t;n;){if(e===n)return!1;if(s(n,"__mixins__"))for(var r=n.__mixins__,i=0;i<r.length;i++)if(r[i]===e)return!1;n=n.superclass}return!0})).length>0&&n}(f,c)),c&&(f=function(t,e){for(var n=t,r=0;r<e.length;r++){var i=new Function;i.prototype=Object.create(n.prototype),i.__proto__=n,i.superclass=null,a(i.prototype,e[r].prototype),i.prototype.__mixin__=e[r],n=i}return n}(f,c));var d=r.klassName||"",p=new Function("return function "+d+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return p.prototype=Object.create(f.prototype),p.prototype.constructor=p,p.superclass=u,p.__proto__=f,p._constructor||(p._constructor=t),c&&(p.__mixins__=c),p.partial||(p.partial=function(t,n){return function(t,n,r){var i=t.prototype,s=t.superclass.prototype,a=r&&r.noOverrided;r&&r.overrides;for(var o in n)if("constructor"!==o){var l=n[o];"function"==typeof n[o]?i[o]=l._constructor||a||"function"!=typeof s[o]?l:function(t,e,n){return function(){var t=this.overrided;this.overrided=n;var r=e.apply(this,arguments);return this.overrided=t,r}}(0,l,s[o]):e.isPlainObject(l)&&null!==l&&l.get?Object.defineProperty(i,o,l):i[o]=l}return t}(this,t,n)}),p.inherit||(p.inherit=function(t,e,r){return n(t,this,e,r)}),p.partial(r,h),p}}();return t.attach("langx.klass",u)}),define("skylark-langx-klass/main",["./klass"],function(t){return t}),define("skylark-langx-klass",["skylark-langx-klass/main"],function(t){return t}),define("skylark-langx-events/Event",["skylark-langx-objects","skylark-langx-funcs","skylark-langx-klass","skylark-langx-hoster","./events"],function(t,e,n,r){var i={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function s(n,r){return!r&&n.isDefaultPrevented||(r||(r=n),t.each(i,function(t,i){var s=r[t];n[t]=function(){return this[i]=e.returnTrue,s&&s.apply(r,arguments)},n[i]=e.returnFalse})),n}class a extends CustomEvent{constructor(e,n){super(e,n),t.safeMixin(this,n),s(this)}}return a.compatible=s,r.Event=a}),define("skylark-langx-events/Listener",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event"],function(t,e,n,r,i,s){Array.prototype.slice;var a=n.compact,o=(t.isDefined,t.isPlainObject,t.isFunction,t.isBoolean),l=t.isString,u=t.isEmptyObject,c=(e.mixin,e.safeMixin,r({listenTo:function(e,n,r,i){if(!e)return this;if(o(r)&&(i=r,r=null),t.isPlainObject(n)){var s=n;for(var a in s)this.listenTo(e,a,s[a],i);return this}r||(r="handleEvent"),l(r)&&(r=this[r]),i?e.one(n,r,this):e.on(n,r,this);for(var u,c=this._listeningTo||(this._listeningTo=[]),h=0;h<c.length;h++)if(c[h].obj==e){u=c[h];break}u||c.push(u={obj:e,events:{}});var f=u.events,d=f[n]=f[n]||[];return-1==d.indexOf(r)&&d.push(r),this},listenToOnce:function(t,e,n){return this.listenTo(t,e,n,1)},unlistenTo:function(t,e,n){var r=this._listeningTo;if(!r)return this;l(n)&&(n=this[n]);for(var i=0;i<r.length;i++){var s=r[i];if(!t||t==s.obj){var o=s.events;for(var c in o)if(!e||e==c){for(var h=o[c],f=0;f<h.length;f++)n&&n!=h[i]||(s.obj.off(c,h[i],this),h[i]=null);h=o[c]=a(h),u(h)&&(o[c]=null)}u(o)&&(r[i]=null)}}return r=this._listeningTo=a(r),u(r)&&(this._listeningTo=null),this}}));return i.Listener=c}),define("skylark-langx-events/Emitter",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event","./Listener"],function(t,e,n,r,i,s,a){var o=Array.prototype.slice,l=n.compact,u=t.isDefined,c=t.isPlainObject,h=t.isFunction,f=t.isString,d=(t.isEmptyObject,e.mixin);e.safeMixin;function p(t){var e=(""+t).split(".");return{name:e[0],ns:e.slice(1).join(" ")}}var m=a.inherit({_prepareArgs:function(t,e){return e=u(e)?[t].concat(e):[t]},on:function(t,e,n,r,i,s){var a=this,o=this._hub||(this._hub={});if(c(t))return i=r,each(t,function(t,r){a.on(t,e,n,r,i,s)}),this;if(f(e)||h(r)||(i=r,r=n,n=e,e=void 0),h(n)&&(i=r,r=n,n=null),!r)throw new Error("No callback function");if(!h(r))throw new Error("The callback  is not afunction");return f(t)&&(t=t.split(/\s/)),t.forEach(function(t){var a=p(t),l=a.name,u=a.ns;(o[l]||(o[l]=[])).push({fn:r,selector:e,data:n,ctx:i,ns:u,one:s})}),this},one:function(t,e,n,r,i){return this.on(t,e,n,r,i,1)},emit:function(t){if(!this._hub)return this;var e=this;f(t)&&(t=new s(t)),Object.defineProperty(t,"target",{value:this});var n=o.call(arguments,1);return n=this._prepareArgs(t,n),[t.type||t.name,"all"].forEach(function(r){var i=p(r),s=i.name,a=i.ns,o=e._hub[s];if(o){for(var u=o.length,c=!1,h=0;h<u;h++){if(t.isImmediatePropagationStopped&&t.isImmediatePropagationStopped())return this;var f=o[h];(!a||f.ns&&f.ns.startsWith(a))&&(t.data?f.data&&(t.data=d({},f.data,t.data)):t.data=f.data||null,f.fn.apply(f.ctx,n),f.one&&(o[h]=null,c=!0))}c&&(e._hub[r]=l(o))}}),this},listened:function(t){var e=(this._hub||(this._events={}))[t]||[];return e.length>0},off:function(t,e){var n=this._hub||(this._hub={});return f(t)&&(t=t.split(/\s/)),t.forEach(function(t){var r=p(t),i=r.name,s=r.ns,a=n[i];if(a){var o=[];if(e||s)for(var l=0,u=a.length;l<u;l++)e&&a[l].fn!==e&&a[l].fn._!==e?o.push(a[l]):!s||a[l].ns&&0==a[l].ns.indexOf(s)||o.push(a[l]);o.length?n[i]=o:delete n[i]}}),this},trigger:function(){return this.emit.apply(this,arguments)}});return i.Emitter=m}),define("skylark-langx-events/createEvent",["./events","./Event"],function(t,e){return t.createEvent=function(t,n){return new e(t,n)}}),define("skylark-langx-events/main",["./events","./Event","./Listener","./Emitter","./createEvent"],function(t){return t}),define("skylark-langx-events",["skylark-langx-events/main"],function(t){return t}),define("skylark-langx-emitter/Emitter",["skylark-langx-events"],function(t){return t.Emitter}),define("skylark-langx-emitter/Evented",["./Emitter"],function(t){return t}),define("skylark-net-http/http",["skylark-langx-ns/ns"],function(t){return t.attach("net.http",{})}),define("skylark-net-http/Xhr",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-funcs","skylark-langx-async/Deferred","skylark-langx-emitter/Evented","./http"],function(skylark,types,objects,arrays,funcs,Deferred,Evented,http){var each=objects.each,mixin=objects.mixin,noop=funcs.noop,isArray=types.isArray,isFunction=types.isFunction,isPlainObject=types.isPlainObject,type=types.type,getAbsoluteUrl=function(t){return a||(a=document.createElement("a")),a.href=t,a.href},a,Xhr=function(){var jsonpID=0,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/,XhrDefaultOptions={async:!0,type:"GET",beforeSend:noop,success:noop,error:noop,complete:noop,context:null,global:!0,accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,processData:!1,cache:!0,traditional:!1,xhrFields:{withCredentials:!1}};function mimeToDataType(t){if(t&&(t=t.split(";",2)[0]),t){if(t==htmlType)return"html";if(t==jsonType)return"json";if(scriptTypeRE.test(t))return"script";if(xmlTypeRE.test(t))return"xml"}return"text"}function appendQuery(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function serializeData(t){t.data=t.data||t.query,t.processData&&t.data&&"string"!=type(t.data)&&(t.data=param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||("string"!=type(t.data)&&(t.data=param(t.data,t.traditional)),t.url=appendQuery(t.url,t.data),t.data=void 0)}function serialize(t,e,n,r){var i,s=isArray(e),a=isPlainObject(e);each(e,function(e,o){i=type(o),r&&(e=n?r:r+"["+(a||"object"==i||"array"==i?e:"")+"]"),!r&&s?t.add(o.name,o.value):"array"==i||!n&&"object"==i?serialize(t,o,n,e):t.add(e,o)})}var param=function(t,e){var n=[];return n.add=function(t,e){isFunction(e)&&(e=e()),null==e&&(e=""),this.push(encodeURIComponent(t)+"="+encodeURIComponent(e))},serialize(n,t,e),n.join("&").replace(/%20/g,"+")},Xhr=Evented.inherit({klassName:"Xhr",_request:function(args){var _=this._,self=this,options=mixin({},XhrDefaultOptions,_.options,args),xhr=_.xhr=new XMLHttpRequest;serializeData(options),options.beforeSend&&options.beforeSend.call(this,xhr,options);var dataType=options.dataType||options.handleAs,mime=options.mimeType||options.accepts[dataType],headers=options.headers,xhrFields=options.xhrFields,isFormData=options.data&&options.data instanceof FormData,basicAuthorizationToken=options.basicAuthorizationToken,type=options.type,url=options.url,async=options.async,user=options.user,password=options.password,deferred=new Deferred,contentType=options.contentType||!isFormData&&"application/x-www-form-urlencoded";if(xhrFields)for(name in xhrFields)xhr[name]=xhrFields[name];mime&&mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),mime&&xhr.overrideMimeType&&xhr.overrideMimeType(mime);var finish=function(){xhr.onloadend=noop,xhr.onabort=noop,xhr.onprogress=noop,xhr.ontimeout=noop,xhr=null},onloadend=function(){var result,error=!1;if(xhr.status>=200&&xhr.status<300||304==xhr.status||0==xhr.status&&getAbsoluteUrl(url).startsWith("file:")){dataType=dataType||mimeToDataType(options.mimeType||xhr.getResponseHeader("content-type")),result=xhr.responseText;try{"script"==dataType?eval(result):"xml"==dataType?result=xhr.responseXML:"json"==dataType?result=blankRE.test(result)?null:JSON.parse(result):"blob"==dataType?result=Blob([xhrObj.response]):"arraybuffer"==dataType&&(result=xhr.reponse)}catch(t){error=t}error?deferred.reject(error,xhr.status,xhr):deferred.resolve(result,xhr.status,xhr)}else deferred.reject(new Error(xhr.statusText),xhr.status,xhr);finish()},onabort=function(){deferred&&deferred.reject(new Error("abort"),xhr.status,xhr),finish()},ontimeout=function(){deferred&&deferred.reject(new Error("timeout"),xhr.status,xhr),finish()},onprogress=function(t){deferred&&deferred.notify(t,xhr.status,xhr)};if(xhr.onloadend=onloadend,xhr.onabort=onabort,xhr.ontimeout=ontimeout,xhr.onprogress=onprogress,xhr.open(type,url,async,user,password),headers)for(var key in headers){var value=headers[key];"content-type"===key.toLowerCase()?contentType=value:xhr.setRequestHeader(key,value)}return contentType&&!1!==contentType&&xhr.setRequestHeader("Content-Type",contentType),headers&&"X-Requested-With"in headers||xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),basicAuthorizationToken&&xhr.setRequestHeader("Authorization",basicAuthorizationToken),xhr.send(options.data?options.data:null),deferred.promise},abort:function(){var t=this._,e=t.xhr;e&&e.abort()},request:function(t){return this._request(t)},get:function(t){return(t=t||{}).type="GET",this._request(t)},post:function(t){return(t=t||{}).type="POST",this._request(t)},patch:function(t){return(t=t||{}).type="PATCH",this._request(t)},put:function(t){return(t=t||{}).type="PUT",this._request(t)},del:function(t){return(t=t||{}).type="DELETE",this._request(t)},init:function(t){this._={options:t||{}}}});return["request","get","post","put","del","patch"].forEach(function(t){Xhr[t]=function(e,n){var r=new Xhr({url:e});return r[t](n)}}),Xhr.defaultOptions=XhrDefaultOptions,Xhr.param=param,Xhr}();return http.Xhr=Xhr}),define("skylark-langx/skylark",["skylark-langx-ns"],function(t){return t}),define("skylark-langx/arrays",["skylark-langx-arrays"],function(t){return t}),define("skylark-langx/klass",["skylark-langx-klass"],function(t){return t}),define("skylark-langx/ArrayStore",["./klass"],function(t){var e=function(t){if(!t)return t;var n=!!t.then;function r(r){t[r]=function(){var i=arguments,s=Deferred.when(t,function(t){return e(Array.prototype[r].apply(t,i))});if("forEach"!==r||n)return s}}return n&&(t=Object.delegate(t)),r("forEach"),r("filter"),r("map"),null==t.total&&(t.total=Deferred.when(t,function(t){return t.length})),t},n=t({klassName:"ArrayStore",queryEngine:function(t,e){switch(typeof t){default:throw new Error("Can not query with a "+typeof t);case"object":case"undefined":var n=t;t=function(t){for(var e in n){var r=n[e];if(r&&r.test){if(!r.test(t[e],t))return!1}else if(r!=t[e])return!1}return!0};break;case"string":if(!this[t])throw new Error("No filter function "+t+" was found in store");t=this[t];case"function":}function r(n){var r=function(t,e,n){var r,i=0,s=t&&t.length||0,a=[];s&&"string"==typeof t&&(t=t.split(""));"string"==typeof e&&(e=cache[e]||buildFn(e));if(n)for(;i<s;++i)r=t[i],e.call(n,r,i,t)&&a.push(r);else for(;i<s;++i)r=t[i],e(r,i,t)&&a.push(r);return a}(n,t),i=e&&e.sort;if(i&&r.sort("function"==typeof i?i:function(t,e){for(var n,r=0;n=i[r];r++){var s=t[n.attribute],a=e[n.attribute];if(s=null!=s?s.valueOf():s,a=null!=a?a.valueOf():a,s!=a)return!!n.descending==(null==s||s>a)?-1:1}return 0}),e&&(e.start||e.count)){var s=r.length;(r=r.slice(e.start||0,(e.start||0)+(e.count||1/0))).total=s}return r}return r.matches=t,r},idProperty:"id",get:function(t){return this.data[this.index[t]]},getIdentity:function(t){return t[this.idProperty]},put:function(t,e){var n=this.data,r=this.index,i=this.idProperty,s=t[i]=e&&"id"in e?e.id:i in t?t[i]:Math.random();if(s in r){if(e&&!1===e.overwrite)throw new Error("Object already exists");n[r[s]]=t}else r[s]=n.push(t)-1;return s},add:function(t,e){return(e=e||{}).overwrite=!1,this.put(t,e)},remove:function(t){var e=this.index,n=this.data;if(t in e)return n.splice(e[t],1),this.setData(n),!0},query:function(t,n){return e(this.queryEngine(t,n)(this.data))},setData:function(t){t.items?(this.idProperty=t.identifier||this.idProperty,t=this.data=t.items):this.data=t,this.index={};for(var e=0,n=t.length;e<n;e++)this.index[t[e][this.idProperty]]=e},init:function(t){for(var e in t)this[e]=t[e];this.setData(this.data||[])}});return n}),define("skylark-langx-aspect/aspect",["skylark-langx-ns"],function(t){var e,n=0;function r(t){return function(r,i,s,a){var o,l=r[i];l&&l.target==r||(r[i]=o=function(){for(var t=n,r=arguments,i=o.before;i;)r=i.advice.apply(this,r)||r,i=i.next;if(o.around)var s=o.around.advice(this,r);for(var a=o.after;a&&a.id<t;){if(a.receiveArguments){var l=a.advice.apply(this,r);s=l===e?s:l}else s=a.advice.call(this,s,r);a=a.next}return s},l&&(o.around={advice:function(t,e){return l.apply(t,e)}}),o.target=r);var u=function(t,e,r,i){var s,a=t[e],o="around"==e;if(o){var l=r(function(){return a.advice(this,arguments)});s={remove:function(){l&&(l=t=r=null)},advice:function(t,e){return l?l.apply(t,e):a.advice(t,e)}}}else s={remove:function(){if(s.advice){var n=s.previous,i=s.next;i||n?(n?n.next=i:t[e]=i,i&&(i.previous=n)):delete t[e],t=r=s.advice=null}},id:n++,advice:r,receiveArguments:i};if(a&&!o)if("after"==e){for(;a.next&&(a=a.next););a.next=s,s.previous=a}else"before"==e&&(t[e]=s,s.next=a,a.previous=s);else t[e]=s;return s}(o||l,t,s,a);return s=null,u}}return t.attach("langx.aspect",{after:r("after"),around:r("around"),before:r("before")})}),define("skylark-langx-aspect/main",["./aspect"],function(t){return t}),define("skylark-langx-aspect",["skylark-langx-aspect/main"],function(t){return t}),define("skylark-langx/aspect",["skylark-langx-aspect"],function(t){return t}),define("skylark-langx/async",["skylark-langx-async"],function(t){return t}),define("skylark-langx-binary/binary",["skylark-langx-ns"],function(t){"use strict";return t.attach("langx.binary",{fromBase64:function(t){for(var e,n,r,i,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=t.length/4*3,o=new ArrayBuffer(a),l=new Uint8Array(o),u=0,c=0;u<a;u+=3)e=s.indexOf(t.charAt(c++)),n=s.indexOf(t.charAt(c++)),r=s.indexOf(t.charAt(c++)),i=s.indexOf(t.charAt(c++)),l[u]=e<<2|n>>4,64!==r&&(l[u+1]=(15&n)<<4|r>>2),64!==i&&(l[u+2]=(3&r)<<6|i);return o},fromBinaryString:function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n},fromBuffer:function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;r++)n[r]=t[r];return e}})}),define("skylark-langx-binary/main",["./binary"],function(t){return t}),define("skylark-langx-binary",["skylark-langx-binary/main"],function(t){return t}),define("skylark-langx/binary",["skylark-langx-binary"],function(t){return t}),define("skylark-langx-datetimes/datetimes",["skylark-langx-ns"],function(t){return t.attach("langx.datetimes",{parseMilliSeconds:function(t){var e=t.split(" "),n=parseInt(e[0]);if(isNaN(n))return 0;switch(e[1].trim().replace(/\./g,"")){case"minutes":case"minute":case"min":case"mm":case"m":return 6e4*n;case"hours":case"hour":case"HH":case"hh":case"h":case"H":return 36e5*n;case"seconds":case"second":case"sec":case"ss":case"s":return 1e3*n;case"days":case"day":case"DD":case"dd":case"d":return 864e5*n;case"months":case"month":case"MM":case"M":return 24192e5*n;case"weeks":case"week":case"W":case"w":return 6048e5*n;case"years":case"year":case"yyyy":case"yy":case"y":return 31536e6*n;default:return 0}}})}),define("skylark-langx-datetimes/main",["./datetimes"],function(t){return t}),define("skylark-langx-datetimes",["skylark-langx-datetimes/main"],function(t){return t}),define("skylark-langx/datetimes",["skylark-langx-datetimes"],function(t){return t}),define("skylark-langx/Deferred",["skylark-langx-async"],function(t){return t.Deferred}),define("skylark-langx/Emitter",["skylark-langx-events"],function(t){return t.Emitter}),define("skylark-langx/Evented",["./Emitter"],function(t){return t}),define("skylark-langx/events",["skylark-langx-events"],function(t){return t}),define("skylark-langx/funcs",["skylark-langx-funcs"],function(t){return t}),define("skylark-langx/hoster",["skylark-langx-hoster"],function(t){return t}),define("skylark-langx-maths/maths",["skylark-langx-ns","skylark-langx-types"],function(t,e){for(var n=[],r=0;r<256;r++)n[r]=(r<16?"0":"")+r.toString(16);var i={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*i.DEG2RAD},radToDeg:function(t){return t*i.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),u=s((e+r)/2),c=a((e+r)/2),h=s((e-r)/2),f=a((e-r)/2),d=s((r-e)/2),p=a((r-e)/2);"XYX"===i?t.set(o*c,l*h,l*f,o*u):"YZY"===i?t.set(l*f,o*c,l*h,o*u):"ZXZ"===i?t.set(l*h,l*f,o*c,o*u):"XZX"===i?t.set(o*c,l*p,l*d,o*u):"YXY"===i?t.set(l*d,o*c,l*p,o*u):"ZYZ"===i?t.set(l*p,l*d,o*c,o*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};return t.attach("langx.maths",i)}),define("skylark-langx-maths/main",["./maths"],function(t){return t}),define("skylark-langx-maths",["skylark-langx-maths/main"],function(t){return t}),define("skylark-langx/maths",["skylark-langx-maths"],function(t){return t}),define("skylark-langx-numerics/numerics",["skylark-langx-ns","skylark-langx-types"],function(t,e){return t.attach("langx.numerics",{toFinite:e.toFinite,toNumber:e.toNumber,toInteger:e.toInteger})}),define("skylark-langx-numerics/maths",["skylark-langx-ns","skylark-langx-types","./numerics"],function(t,e,n){for(var r=[],i=0;i<256;i++)r[i]=(i<16?"0":"")+i.toString(16);var s={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*s.DEG2RAD},radToDeg:function(t){return t*s.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),u=s((e+r)/2),c=a((e+r)/2),h=s((e-r)/2),f=a((e-r)/2),d=s((r-e)/2),p=a((r-e)/2);"XYX"===i?t.set(o*c,l*h,l*f,o*u):"YZY"===i?t.set(l*f,o*c,l*h,o*u):"ZXZ"===i?t.set(l*h,l*f,o*c,o*u):"XZX"===i?t.set(o*c,l*p,l*d,o*u):"YXY"===i?t.set(l*d,o*c,l*p,o*u):"ZYZ"===i?t.set(l*p,l*d,o*c,o*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};return n.maths=s}),define("skylark-langx-numerics/Quaternion",["skylark-langx-klass","./numerics","./maths"],function(t,e,n){var r=t({klassName:"Quaternion",x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}},set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("mathsQuaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,s=t.order,a=Math.cos,o=Math.sin,l=a(n/2),u=a(r/2),c=a(i/2),h=o(n/2),f=o(r/2),d=o(i/2);return"XYZ"===s?(this._x=h*u*c+l*f*d,this._y=l*f*c-h*u*d,this._z=l*u*d+h*f*c,this._w=l*u*c-h*f*d):"YXZ"===s?(this._x=h*u*c+l*f*d,this._y=l*f*c-h*u*d,this._z=l*u*d-h*f*c,this._w=l*u*c+h*f*d):"ZXY"===s?(this._x=h*u*c-l*f*d,this._y=l*f*c+h*u*d,this._z=l*u*d+h*f*c,this._w=l*u*c-h*f*d):"ZYX"===s?(this._x=h*u*c-l*f*d,this._y=l*f*c+h*u*d,this._z=l*u*d-h*f*c,this._w=l*u*c+h*f*d):"YZX"===s?(this._x=h*u*c+l*f*d,this._y=l*f*c+h*u*d,this._z=l*u*d-h*f*c,this._w=l*u*c-h*f*d):"XZY"===s&&(this._x=h*u*c-l*f*d,this._y=l*f*c-h*u*d,this._z=l*u*d+h*f*c,this._w=l*u*c+h*f*d),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],s=n[8],a=n[1],o=n[5],l=n[9],u=n[2],c=n[6],h=n[10],f=r+o+h;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(c-l)*e,this._y=(s-u)*e,this._z=(a-i)*e):r>o&&r>h?(e=2*Math.sqrt(1+r-o-h),this._w=(c-l)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(s+u)/e):o>h?(e=2*Math.sqrt(1+o-r-h),this._w=(s-u)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(l+c)/e):(e=2*Math.sqrt(1+h-r-o),this._w=(a-i)/e,this._x=(s+u)/e,this._y=(l+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(n.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("mathsQuaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,s=t._w,a=e._x,o=e._y,l=e._z,u=e._w;return this._x=n*u+s*a+r*l-i*o,this._y=r*u+s*o+i*a-n*l,this._z=i*u+s*l+n*o-r*a,this._w=s*u-n*a-r*o-i*l,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,s=this._w,a=s*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=r,this._z=i,this;var o=1-a*a;if(o<=Number.EPSILON){var l=1-e;return this._w=l*s+e*this._w,this._x=l*n+e*this._x,this._y=l*r+e*this._y,this._z=l*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(o),c=Math.atan2(u,a),h=Math.sin((1-e)*c)/u,f=Math.sin(e*c)/u;return this._w=s*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){},_construct:function(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}});return Object.assign(r,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,s,a){var o=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[s+0],f=i[s+1],d=i[s+2],p=i[s+3];if(c!==p||o!==h||l!==f||u!==d){var m=1-a,g=o*h+l*f+u*d+c*p,y=g>=0?1:-1,v=1-g*g;if(v>Number.EPSILON){var x=Math.sqrt(v),k=Math.atan2(x,g*y);m=Math.sin(m*k)/x,a=Math.sin(a*k)/x}var b=a*y;if(o=o*m+h*b,l=l*m+f*b,u=u*m+d*b,c=c*m+p*b,m===1-a){var _=1/Math.sqrt(o*o+l*l+u*u+c*c);o*=_,l*=_,u*=_,c*=_}}t[e]=o,t[e+1]=l,t[e+2]=u,t[e+3]=c}}),Object.assign(r.prototype,{}),e.Quaternion=r}),define("skylark-langx-numerics/Vector3",["skylark-langx-klass","./numerics","./maths","./Quaternion"],function(t,e,n,r){var i=new r,s=t({klassName:"Vector3",set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("mathsVector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("mathsVector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("mathsVector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("mathsVector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(i.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(i.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,s=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*s,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,a=t.z,o=t.w,l=o*e+s*r-a*n,u=o*n+a*e-i*r,c=o*r+i*n-s*e,h=-i*e-s*n-a*r;return this.x=l*o+h*-i+u*-a-c*-s,this.y=u*o+h*-s+c*-i-l*-a,this.z=c*o+h*-a+l*-s-u*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("mathsVector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,s=e.x,a=e.y,o=e.z;return this.x=r*o-i*a,this.y=i*s-n*o,this.z=n*a-r*s,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return a.copy(this).projectOnVector(t),this.sub(a)},reflect:function(t){return this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(MathUtils.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("mathsVector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},_construct:function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}}),a=new s;return e.Vector3=s}),define("skylark-langx-numerics/Matrix4",["skylark-langx-klass","./numerics","./Vector3"],function(t,e,n){var r=new n,i=new n(0,0,0),s=new n(1,1,1),a=new n,o=new n,l=new n,u=t({set:function(t,e,n,r,i,s,a,o,l,u,c,h,f,d,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new u).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,i=1/r.setFromMatrixColumn(t,0).length(),s=1/r.setFromMatrixColumn(t,1).length(),a=1/r.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("mathsMatrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=s*u,f=s*c,d=a*u,p=a*c;e[0]=o*u,e[4]=-o*c,e[8]=l,e[1]=f+d*l,e[5]=h-p*l,e[9]=-a*o,e[2]=p-h*l,e[6]=d+f*l,e[10]=s*o}else if("YXZ"===t.order){var m=o*u,g=o*c,y=l*u,v=l*c;e[0]=m+v*a,e[4]=y*a-g,e[8]=s*l,e[1]=s*c,e[5]=s*u,e[9]=-a,e[2]=g*a-y,e[6]=v+m*a,e[10]=s*o}else if("ZXY"===t.order){var m=o*u,g=o*c,y=l*u,v=l*c;e[0]=m-v*a,e[4]=-s*c,e[8]=y+g*a,e[1]=g+y*a,e[5]=s*u,e[9]=v-m*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){var h=s*u,f=s*c,d=a*u,p=a*c;e[0]=o*u,e[4]=d*l-f,e[8]=h*l+p,e[1]=o*c,e[5]=p*l+h,e[9]=f*l-d,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){var x=s*o,k=s*l,b=a*o,_=a*l;e[0]=o*u,e[4]=_-x*c,e[8]=b*c+k,e[1]=c,e[5]=s*u,e[9]=-a*u,e[2]=-l*u,e[6]=k*c+b,e[10]=x-_*c}else if("XZY"===t.order){var x=s*o,k=s*l,b=a*o,_=a*l;e[0]=o*u,e[4]=-c,e[8]=l*u,e[1]=x*c+_,e[5]=s*u,e[9]=k*c-b,e[2]=b*c-k,e[6]=a*u,e[10]=_*c+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(i,t,s)},lookAt:function(t,e,n){var r=this.elements;return l.subVectors(t,e),0===l.lengthSq()&&(l.z=1),l.normalize(),a.crossVectors(n,l),0===a.lengthSq()&&(1===Math.abs(n.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),a.crossVectors(n,l)),a.normalize(),o.crossVectors(l,a),r[0]=a.x,r[4]=o.x,r[8]=l.x,r[1]=a.y,r[5]=o.y,r[9]=l.y,r[2]=a.z,r[6]=o.z,r[10]=l.z,this},multiply:function(t,e){return void 0!==e?(console.warn("mathsMatrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],u=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],g=n[14],y=n[3],v=n[7],x=n[11],k=n[15],b=r[0],_=r[4],w=r[8],C=r[12],S=r[1],M=r[5],E=r[9],A=r[13],z=r[2],T=r[6],O=r[10],P=r[14],I=r[3],N=r[7],F=r[11],j=r[15];return i[0]=s*b+a*S+o*z+l*I,i[4]=s*_+a*M+o*T+l*N,i[8]=s*w+a*E+o*O+l*F,i[12]=s*C+a*A+o*P+l*j,i[1]=u*b+c*S+h*z+f*I,i[5]=u*_+c*M+h*T+f*N,i[9]=u*w+c*E+h*O+f*F,i[13]=u*C+c*A+h*P+f*j,i[2]=d*b+p*S+m*z+g*I,i[6]=d*_+p*M+m*T+g*N,i[10]=d*w+p*E+m*O+g*F,i[14]=d*C+p*A+m*P+g*j,i[3]=y*b+v*S+x*z+k*I,i[7]=y*_+v*M+x*T+k*N,i[11]=y*w+v*E+x*O+k*F,i[15]=y*C+v*A+x*P+k*j,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],s=t[1],a=t[5],o=t[9],l=t[13],u=t[2],c=t[6],h=t[10],f=t[14],d=t[3],p=t[7],m=t[11],g=t[15];return d*(+i*o*c-r*l*c-i*a*h+n*l*h+r*a*f-n*o*f)+p*(+e*o*f-e*l*h+i*s*h-r*s*f+r*l*u-i*o*u)+m*(+e*l*c-e*a*f-i*s*c+n*s*f+i*a*u-n*l*u)+g*(-r*a*u-e*o*c+e*a*h+r*s*c-n*s*h+n*o*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("mathsMatrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],s=r[1],a=r[2],o=r[3],l=r[4],u=r[5],c=r[6],h=r[7],f=r[8],d=r[9],p=r[10],m=r[11],g=r[12],y=r[13],v=r[14],x=r[15],k=d*v*h-y*p*h+y*c*m-u*v*m-d*c*x+u*p*x,b=g*p*h-f*v*h-g*c*m+l*v*m+f*c*x-l*p*x,_=f*y*h-g*d*h+g*u*m-l*y*m-f*u*x+l*d*x,w=g*d*c-f*y*c-g*u*p+l*y*p+f*u*v-l*d*v,C=i*k+s*b+a*_+o*w;if(0===C)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var S=1/C;return n[0]=k*S,n[1]=(y*p*o-d*v*o-y*a*m+s*v*m+d*a*x-s*p*x)*S,n[2]=(u*v*o-y*c*o+y*a*h-s*v*h-u*a*x+s*c*x)*S,n[3]=(d*c*o-u*p*o-d*a*h+s*p*h+u*a*m-s*c*m)*S,n[4]=b*S,n[5]=(f*v*o-g*p*o+g*a*m-i*v*m-f*a*x+i*p*x)*S,n[6]=(g*c*o-l*v*o-g*a*h+i*v*h+l*a*x-i*c*x)*S,n[7]=(l*p*o-f*c*o+f*a*h-i*p*h-l*a*m+i*c*m)*S,n[8]=_*S,n[9]=(g*d*o-f*y*o-g*s*m+i*y*m+f*s*x-i*d*x)*S,n[10]=(l*y*o-g*u*o+g*s*h-i*y*h-l*s*x+i*u*x)*S,n[11]=(f*u*o-l*d*o-f*s*h+i*d*h+l*s*m-i*u*m)*S,n[12]=w*S,n[13]=(f*y*a-g*d*a+g*s*p-i*y*p-f*s*v+i*d*v)*S,n[14]=(g*u*a-l*y*a-g*s*c+i*y*c+l*s*v-i*u*v)*S,n[15]=(l*d*a-f*u*a+f*s*c-i*d*c-l*s*p+i*u*p)*S,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,s=t.x,a=t.y,o=t.z,l=i*s,u=i*a;return this.set(l*s+n,l*a-r*o,l*o+r*a,0,l*a+r*o,u*a+n,u*o-r*s,0,l*o-r*a,u*o+r*s,i*o*o+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,s=e._y,a=e._z,o=e._w,l=i+i,u=s+s,c=a+a,h=i*l,f=i*u,d=i*c,p=s*u,m=s*c,g=a*c,y=o*l,v=o*u,x=o*c,k=n.x,b=n.y,_=n.z;return r[0]=(1-(p+g))*k,r[1]=(f+x)*k,r[2]=(d-v)*k,r[3]=0,r[4]=(f-x)*b,r[5]=(1-(h+g))*b,r[6]=(m+y)*b,r[7]=0,r[8]=(d+v)*_,r[9]=(m-y)*_,r[10]=(1-(h+p))*_,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var i=this.elements,s=r.set(i[0],i[1],i[2]).length(),a=r.set(i[4],i[5],i[6]).length(),o=r.set(i[8],i[9],i[10]).length(),l=this.determinant();l<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],c.copy(this);var u=1/s,h=1/a,f=1/o;return c.elements[0]*=u,c.elements[1]*=u,c.elements[2]*=u,c.elements[4]*=h,c.elements[5]*=h,c.elements[6]*=h,c.elements[8]*=f,c.elements[9]*=f,c.elements[10]*=f,e.setFromRotationMatrix(c),n.x=s,n.y=a,n.z=o,this},makePerspective:function(t,e,n,r,i,s){void 0===s&&console.warn("mathsMatrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,o=2*i/(e-t),l=2*i/(n-r),u=(e+t)/(e-t),c=(n+r)/(n-r),h=-(s+i)/(s-i),f=-2*s*i/(s-i);return a[0]=o,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,s){var a=this.elements,o=1/(e-t),l=1/(n-r),u=1/(s-i),c=(e+t)*o,h=(n+r)*l,f=(s+i)*u;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t},_construct:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("mathsMatrix4: the constructor no longer reads arguments. use .set() instead.")}}),c=new u;return e.Matrix4=u}),define("skylark-langx-numerics/Euler",["skylark-langx-klass","./numerics","./maths","./Quaternion","./Vector3","./Matrix4"],function(t,e,n,r,i,s){var a=new s,o=new r,l=t({x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}},isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,r){var i=n.clamp,s=t.elements,a=s[0],o=s[4],l=s[8],u=s[1],c=s[5],h=s[9],f=s[2],d=s[6],p=s[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-f,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===e?(this._y=Math.asin(-i(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===e?(this._z=Math.asin(i(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(l,p))):"XZY"===e?(this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("skylark-nunustudio/editor/gui/element/RendererCanvasEuler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return a.makeRotationFromQuaternion(t),this.setFromRotationMatrix(a,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return o.setFromEuler(this),this.setFromQuaternion(o,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new i(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){},_construct:function(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||l.DefaultOrder}});return l.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],l.DefaultOrder="XYZ",e.Euler=l}),define("skylark-langx-numerics/Matrix3",["skylark-langx-klass","./numerics"],function(t,e){var n=t({klassName:"Matrix3",isMatrix3:!0,set:function(t,e,n,r,i,s,a,o,l){var u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=i,u[5]=o,u[6]=n,u[7]=s,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],u=n[4],c=n[7],h=n[2],f=n[5],d=n[8],p=r[0],m=r[3],g=r[6],y=r[1],v=r[4],x=r[7],k=r[2],b=r[5],_=r[8];return i[0]=s*p+a*y+o*k,i[3]=s*m+a*v+o*b,i[6]=s*g+a*x+o*_,i[1]=l*p+u*y+c*k,i[4]=l*m+u*v+c*b,i[7]=l*g+u*x+c*_,i[2]=h*p+f*y+d*k,i[5]=h*m+f*v+d*b,i[8]=h*g+f*x+d*_,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],l=t[7],u=t[8];return e*s*u-e*a*l-n*i*u+n*a*o+r*i*l-r*s*o},getInverse:function(t,e){void 0!==e&&console.warn("mathsMatrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],s=n[1],a=n[2],o=n[3],l=n[4],u=n[5],c=n[6],h=n[7],f=n[8],d=f*l-u*h,p=u*c-f*o,m=h*o-l*c,g=i*d+s*p+a*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);var y=1/g;return r[0]=d*y,r[1]=(a*h-f*s)*y,r[2]=(u*s-a*l)*y,r[3]=p*y,r[4]=(f*i-a*c)*y,r[5]=(a*o-u*i)*y,r[6]=m*y,r[7]=(s*c-h*i)*y,r[8]=(l*i-s*o)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,s,a){var o=Math.cos(i),l=Math.sin(i);this.set(n*o,n*l,-n*(o*s+l*a)+s+t,-r*l,r*o,-r*(-l*s+o*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],s=r[3],a=r[6],o=r[1],l=r[4],u=r[7];return r[0]=e*i+n*o,r[3]=e*s+n*l,r[6]=e*a+n*u,r[1]=-n*i+e*o,r[4]=-n*s+e*l,r[7]=-n*a+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t},_construct:function(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}});return e.Matrix3=n}),define("skylark-langx-numerics/Transform",["skylark-langx-klass","./numerics"],function(t,e){var n=t({klassName:"Transform",value:{get:function(){return this._.value}}});return e.Transform=n}),define("skylark-langx-numerics/MatrixTransform",["./numerics","./Transform"],function(t,e){var n=e.inherit({klassName:"MatrixTransform",value:{get:function(){return this.matrix.clone()}},matrix:{get:function(){return this._.matrix}},clone:function(){},transform:function(t){},transformBounds:function(t){},_construct:function(t){var e=this._={};e.matrix=t}});return t.MatrixTransform=n}),define("skylark-langx-numerics/Plane",["skylark-langx-klass","./numerics","./Matrix3","./Vector3"],function(t,e,n,r){var i=new r,s=new r,a=new n,o=t({klassName:"Plane",set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=i.subVectors(n,e).cross(s.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("mathsPlane: .projectPoint() target is now required"),e=new r),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("mathsPlane: .intersectLine() target is now required"),e=new r);var n=t.delta(i),s=this.normal.dot(n);if(0===s)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/s;return a<0||a>1?void 0:e.copy(n).multiplyScalar(a).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("mathsPlane: .coplanarPoint() target is now required"),t=new r),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||a.getNormalMatrix(t),r=this.coplanarPoint(i).applyMatrix4(t),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},_construct:function(t,e){this.normal=void 0!==t?t:new r(1,0,0),this.constant=void 0!==e?e:0}});return e.Plane=o}),define("skylark-langx-numerics/RotateTransform",["./numerics","./Transform","./MatrixTransform"],function(t,e,n){var r=t.RotateTransform=e.inherit({klassName:"RotateTransform",value:{get:function(){return n.rotateAt(this.angle,this.centerX,this.centerY)}},angle:{get:function(){return this._.angle}},centerX:{get:function(){return this._.centerX}},centerY:{get:function(){return this._.centerY}},clone:function(){},transform:function(t){},transformBounds:function(t){},init:function(t,e,n){var r=this._={};r.angle=t||0,r.centerX=e||0,r.centerY=n||0}});return r}),define("skylark-langx-numerics/ScaleTransform",["./numerics","./Transform","./MatrixTransform"],function(t,e,n){var r=e.inherit({klassName:"ScaleTransform",value:{get:function(){return n.scaleAt(this.scaleX,this.scaleY,this.centerX,this.centerY)}},scaleX:{get:function(){return this._.scaleX}},scaleY:{get:function(){return this._.scaleY}},centerX:{get:function(){return this._.centerX}},centerY:{get:function(){return this._.centerY}},clone:function(){},transform:function(t){},transformBounds:function(t){},_construct:function(t,e,n,r){var i=this._={};i.scaleX=t||1,i.scaleY=e||1,i.centerX=n||0,i.centerY=r||0}});return t.ScaleTransform=r}),define("skylark-langx-numerics/SkewTransform",["./numerics","./Transform","./MatrixTransform"],function(t,e,n){var r=e.inherit({klassName:"SkewTransform",value:{get:function(){return n.scaleAt(this.skewX,this.skewY)}},skewX:{get:function(){return this._.skewX}},skewY:{get:function(){return this._.skewY}},clone:function(){},transform:function(t){},transformBounds:function(t){},_construct:function(t,e){var n=this._={};n.skewX=t||0,n.skewY=e||0}});return t.SkewTransform=r}),define("skylark-langx-numerics/Vector2",["skylark-langx-klass","./numerics"],function(t,e){var n=t({klassName:"Vector2",set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(-this.y,-this.x)+Math.PI;return t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,s=this.y-t.y;return this.x=i*n-s*r+t.x,this.y=i*r+s*n+t.y,this},_construct:function(t,e){this.x=t||0,this.y=e||0}});return e.Vector2=n}),define("skylark-langx-numerics/TransformMatrix",["skylark-langx-klass","./numerics","./Vector2"],function(t,e,n){var r=Math.PI/180,i={},s=function(t){return i[t]||(i[t]=Math.PI*t/180)},a=t({klassName:"TransformMatrix",_multiplyPoint:function(t){var e=this._,r=t.x*e.m11+t.y*e.m21+e.dx,i=t.x*e.m12+t.y*e.m22+e.dy;return new n(r,i)},m11:{get:function(){return this._.m11}},m12:{get:function(){return this._.m12}},m21:{get:function(){return this._.m21}},m22:{get:function(){return this._.m22}},dx:{get:function(){return this._.dx}},dy:{get:function(){return this._.dy}},alpha:{get:function(){return this._.alpha}},shadow:{get:function(){return this._.shadow}},compositeOperation:{get:function(){return this._.compositeOperation}},multiplyPoint:function(t){return this._multiplyPoint(t)},multiplyRectangle:function(t){if(this.isIdentity())return t.clone();var e=this.multiplyPoint(t.leftTop),n=this.multiplyPoint(t.leftBottom),r=this.multiplyPoint(t.right),i=this.multiplyPoint(t.rightBottom),s=Math.min(e.x,n.x,r.x,i.x),a=Math.min(e.y,n.y,r.y,i.y),o=Math.max(e.x,n.x,r.x,i.x),l=Math.max(e.y,n.y,r.y,i.y);return new Rect(s,a,o-s,l-a)},prepend:function(t,e,n,r,i,s){var a=this.dx;if(1!=t||0!=e||0!=n||1!=r){var o=this.m11,l=this.m21;this.m11=o*t+this.m12*n,this.m12=o*e+this.m12*r,this.m21=l*t+this.m22*n,this.m22=l*e+this.m22*r}return this.dx=a*t+this.dy*n+i,this.dy=a*e+this.dy*r+s,this},append:function(t,e,n,r,i,s){var a=this.m11,o=this.m12,l=this.m21,u=this.m22;return this.m11=t*a+e*l,this.m12=t*o+e*u,this.m21=n*a+r*l,this.m22=n*o+r*u,this.dx=i*a+s*l+this.dx,this.dy=i*o+s*u+this.dy,this},prependMatrix:function(t){return this.prepend(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),this.prependProperties(t.alpha,t.shadow,t.compositeOperation),this},appendMatrix:function(t){return this.append(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),this.appendProperties(t.alpha,t.shadow,t.compositeOperation),this},prependTransform:function(t,e,n,i,s,a,o,l,u){if(s%360)var c=s*r,h=Math.cos(c),f=Math.sin(c);else h=1,f=0;return(l||u)&&(this.dx-=l,this.dy-=u),a||o?(a*=r,o*=r,this.prepend(h*n,f*n,-f*i,h*i,0,0),this.prepend(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),t,e)):this.prepend(h*n,f*n,-f*i,h*i,t,e),this},appendTransform:function(t,e,n,i,s,a,o,l,u){if(s%360)var c=s*r,h=Math.cos(c),f=Math.sin(c);else h=1,f=0;return a||o?(a*=r,o*=r,this.append(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),t,e),this.append(h*n,f*n,-f*i,h*i,0,0)):this.append(h*n,f*n,-f*i,h*i,t,e),(l||u)&&(this.dx-=l*this.m11+u*this.m21,this.dy-=l*this.m12+u*this.m22),this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.m11,i=this.m21,s=this.dx;return this.m11=r*e-this.m12*n,this.m12=r*n+this.m12*e,this.m21=i*e-this.m22*n,this.m22=i*n+this.m22*e,this.dx=s*e-this.dy*n,this.dy=s*n+this.dy*e,this},skew:function(t,e){return t*=r,e*=r,this.append(Math.cos(e),Math.sin(e),-Math.sin(t),Math.cos(t),0,0),this},scale:function(t,e){return this.m11*=t,this.m22*=e,this.dx*=t,this.dy*=e,this},translate:function(t,e){return this.dx+=t,this.dy+=e,this},identity:function(){return this.alpha=this.m11=this.m22=1,this.m12=this.m21=this.dx=this.dy=0,this.shadow=this.compositeOperation=null,this},invert:function(){var t=this.m11,e=this.m12,n=this.m21,r=this.m22,i=this.dx,s=t*r-e*n;return this.m11=r/s,this.m12=-e/s,this.m21=-n/s,this.m22=t/s,this.dx=(n*this.dy-r*i)/s,this.dy=-(t*this.dy-e*i)/s,this},isIdentity:function(){return 0==this.dx&&0==this.dy&&1==this.m11&&0==this.m12&&0==this.m21&&1==this.m22},decompose:function(t){null==t&&(t={}),t.x=this.dx,t.y=this.dy,t.scaleX=Math.sqrt(this.m11*this.m11+this.m12*this.m12),t.scaleY=Math.sqrt(this.m21*this.m21+this.m22*this.m22);var e=Math.atan2(-this.m21,this.m22),n=Math.atan2(this.m12,this.m11);return e==n?(t.rotation=n/r,this.m11<0&&this.m22>=0&&(t.rotation+=t.rotation<=0?180:-180),t.skewX=t.skewY=0):(t.skewX=e/r,t.skewY=n/r),t},reinitialize:function(t,e,n,r,i,s,a,o,l){return this._initialize(t,e,n,r,i,s),this.alpha=a||1,this.shadow=o,this.compositeOperation=l,this},appendProperties:function(t,e,n){return this.alpha*=t,this.shadow=e||this.shadow,this.compositeOperation=n||this.compositeOperation,this},prependProperties:function(t,e,n){return this.alpha*=t,this.shadow=this.shadow||e,this.compositeOperation=this.compositeOperation||n,this},multiply:function(t){var e=this.m11,n=this.m12,r=this.m21,i=this.m22,s=this.dx,a=this.dy,o=t;return this.m11=e*o.m11+r*o.m12,this.m12=n*o.m11+i*o.m12,this.m21=e*o.m21+r*o.m22,this.m22=n*o.m21+i*o.m22,this.dx=e*o.dx+r*o.dy+s,this.dy=n*o.dx+i*o.dy+a,this},clone:function(){var t=this._,e=new a(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy);return e.shadow=this.shadow,e.alpha=this.alpha,e.compositeOperation=this.compositeOperation,e},toString:function(){var t=this._;return"[TransformMatrix (m11="+t.m11+" m12="+t.m12+" m21="+t.m21+" m22="+t.m22+" dx="+t.dx+" dy="+t.dy+")]"},_construct:function(t,e,n,r,i,s){var a=this._={};a.m11=t||1,a.m12=e||0,a.m21=n||0,a.m22=r||1,a.dx=i||0,a.dy=s||0}});return Object.assign(a,{translate:function(t,e){return new a(1,0,0,1,t,e)},scale:function(t,e){return new a(t,0,0,e||t,0,0)},rotate:function(t){var e=Math.cos(t),n=Math.sin(t);return new a(e,n,-n,e,0,0)},rotateg:function(t){return this.rotate(s(t))},skewX:function(t){var e=Math.tan(t);return new a(1,0,e,1)},skewXg:function(t){return this.skewX(s(t))},skewY:function(t){var e=Math.tan(t);return new a(1,e,0,1)},skewYg:function(t){return this.skewY(s(t))},reflect:function(t,e){1==arguments.length&&(e=t.y,t=t.x);var n=t*t,r=e*e,i=n+r,s=2*n/i-1,o=2*t*e/i,l=o,u=2*r/i-1;return new a(s,l,o,u)},project:function(t,e){var n=t*t,r=e*e,i=n+r,s=n/i,o=t*e/i;return yx=o,yy=r/i,new a(s,yx,o,yy)},_sandwich:function(t,e,n){return this.translate(e,n).multiply(t).multiply(this.translate(-e,-n))},scaleAt:function(t,e,n,r){switch(arguments.length){case 4:return this._sandwich(this.scale(t,e),n,r);case 3:return"number"==typeof n?this._sandwich(this.scale(t),e,n):this._sandwich(this.scale(t,e),n.x,n.y)}return this._sandwich(this.scale(t),e.x,e.y)},rotateAt:function(t,e,n){return arguments.length>2?this._sandwich(this.rotate(t),e,n):this._sandwich(this.rotate(t),e.x,e.y)},rotategAt:function(t,e,n){return arguments.length>2?this._sandwich(this.rotateg(t),e,n):this._sandwich(this.rotateg(t),e.x,e.y)},skewXAt:function(t,e,n){return arguments.length>2?this._sandwich(this.skewX(t),e,n):this._sandwich(this.skewX(t),e.x,e.y)},skewXgAt:function(t,e,n){return arguments.length>2?this._sandwich(this.skewXg(t),e,n):this._sandwich(this.skewXg(t),e.x,e.y)},skewYAt:function(t,e,n){return arguments.length>2?this._sandwich(this.skewY(t),e,n):this._sandwich(this.skewY(t),e.x,e.y)},skewYgAt:function(t,e,n){return arguments.length>2?this._sandwich(this.skewYg(t),e,n):this._sandwich(this.skewYg(t),e.x,e.y)}}),e.TransformMatrix=a}),define("skylark-langx-numerics/TranslateTransform",["./numerics","./Transform","./MatrixTransform"],function(t,e,n,r,i){var s=e.inherit({klassName:"TranslateTransform",value:{get:function(){return n.scaleAt(this.x,this.y)}},x:{get:function(){return this._.x}},y:{get:function(){return this._.y}},clone:function(){},transform:function(t){},transformBounds:function(t){},init:function(t,e){var n=this._;n.x=t||0,n.y=e||0}});return t.TranslateTransform=s}),define("skylark-langx-numerics/Vector4",["skylark-langx-klass","./numerics"],function(t,e){var n=t({klassName:"Vector4",set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*i,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*i,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*i,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,s=t.elements,a=s[0],o=s[4],l=s[8],u=s[1],c=s[5],h=s[9],f=s[2],d=s[6],p=s[10];if(Math.abs(o-u)<.01&&Math.abs(l-f)<.01&&Math.abs(h-d)<.01){if(Math.abs(o+u)<.1&&Math.abs(l+f)<.1&&Math.abs(h+d)<.1&&Math.abs(a+c+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(c+1)/2,y=(p+1)/2,v=(o+u)/4,x=(l+f)/4,k=(h+d)/4;return m>g&&m>y?m<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(m),r=v/n,i=x/n):g>y?g<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(g),n=v/r,i=k/r):y<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(y),n=x/i,r=k/i),this.set(n,r,i,e),this}var b=Math.sqrt((d-h)*(d-h)+(l-f)*(l-f)+(u-o)*(u-o));return Math.abs(b)<.001&&(b=1),this.x=(d-h)/b,this.y=(l-f)/b,this.z=(u-o)/b,this.w=Math.acos((a+c+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},_construct:function(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}});return e.Vector4=n}),define("skylark-langx-numerics/main",["./numerics","./Euler","./maths","./Matrix3","./Matrix4","./MatrixTransform","./Plane","./Quaternion","./RotateTransform","./ScaleTransform","./SkewTransform","./Transform","./TransformMatrix","./TranslateTransform","./Vector2","./Vector3","./Vector4"],function(t){return t}),define("skylark-langx-numerics",["skylark-langx-numerics/main"],function(t){return t}),define("skylark-langx/numerics",["skylark-langx-numerics"],function(t){return t}),define("skylark-langx/objects",["skylark-langx-objects"],function(t){return t}),define("skylark-langx-strings/strings",["skylark-langx-ns"],function(t){var e=Object.freeze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"});function n(t){return e[t]}var r=/[&<>"'`=]/g;var i=0;function s(t,e){var n,r,i,s,a,o,l,u=arguments.callee;return u.cache[t]||(u.cache[t]=(n=t,r=/^[\w\-]+$/.test(t)?u.get(t):(n="template(string)",t),i=1,s=("try { "+(u.variable?"var "+u.variable+" = this.stash;":"with (this.stash) { ")+"this.ret += '"+r.replace(/<%/g,"").replace(/%>/g,"").replace(/'(?![^\x11\x13]+?\x13)/g,"\\x27").replace(/^\s*|\s*$/g,"").replace(/\n|\r\n/g,function(){return"';\nthis.line = "+ ++i+"; this.ret += '\\n"}).replace(/\x11=raw(.+?)\x13/g,"' + ($1) + '").replace(/\x11=(.+?)\x13/g,"' + this.escapeHTML($1) + '").replace(/\x11(.+?)\x13/g,"'; $1; this.ret += '")+"'; "+(u.variable?"":"}")+"return this.ret;} catch (e) { throw 'TemplateError: ' + e + ' (on "+n+"' + ' line ' + this.line + ')'; } //@ sourceURL="+n+"\n").replace(/this\.ret \+= '';/g,""),a=new Function(s),o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#x22;","'":"&#x27;"},l=function(t){return(""+t).replace(/[&<>\'\"]/g,function(t){return o[t]})},function(t){return a.call(u.context={escapeHTML:l,line:1,ret:"",stash:t})})),e?u.cache[t](e):u.cache[t]}return s.cache={},s.get=function(t){return document.getElementById(t).innerHTML},t.attach("langx.strings",{camelCase:function(t){return t.replace(/-([\da-z])/g,function(t){return t.toUpperCase().replace("-","")})},dasherize:function(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},deserializeValue:function(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?JSON.parse(t):t):t}catch(e){return t}},escapeHTML:function(t){if(null==t)return"";if(!t)return String(t);return t.toString().replace(r,n)},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})},ltrim:function(t){return t.replace(/^\s+/,"")},lowerFirst:function(t){return t.charAt(0).toLowerCase()+t.slice(1)},rtrim:function(t){return t.replace(/\s+$/,"")},serializeValue:function(t){return JSON.stringify(t)},substitute:function(t,e,n,r){function i(t,e){if(t.match(/\./)){var n,r=function(t,e){var i=t.pop();return i?e[i]?r(t,n=e[i]):null:n};return r(t.split(".").reverse(),e)}return e[t]}return r=r||window,n=n?proxy(r,n):function(t){return t},t.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(t,s,a){var o=i(s,e);return a&&(o=i(a,r).call(r,o,s)),n(o,s).toString()})},slugify:function(t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var e="a/_,:;",n=0,r=e.length;n<r;n++)t=t.replace(new RegExp(e.charAt(n),"g"),"AAAAAACCCDEEEEEEEEIIIINNOOOOOORRSTUUUUUYYZaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbBDdBAa------".charAt(n));return t=t.replace(/\s+/g,"-").replace(/-+/g,"-")},trim:function(t){return null==t?"":String.prototype.trim.call(t)},uniqueId:function(t){var e=++i+"";return t?t+e:e},upperFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}})}),define("skylark-langx-strings/base64",["./strings"],function(t){return t.base64={decode:function(t,e){e=null!=e&&e;var n,r,i,s,a,o,l,u="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(;c<t.length;)s=this._keyStr.indexOf(t.charAt(c++)),a=this._keyStr.indexOf(t.charAt(c++)),o=this._keyStr.indexOf(t.charAt(c++)),l=this._keyStr.indexOf(t.charAt(c++)),n=s<<2|a>>4,r=(15&a)<<4|o>>2,i=(3&o)<<6|l,u+=String.fromCharCode(n),64!=o&&(u+=String.fromCharCode(r)),64!=l&&(u+=String.fromCharCode(i));e||(u=function(t){var e="",n=0,r=c1=c2=0;for(;n<t.length;)(r=t.charCodeAt(n))<128?(e+=String.fromCharCode(r),n++):r>191&&r<224?(c2=t.charCodeAt(n+1),e+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return e}(u));return u},encode:function(t,e){var n,r,i,s,a,o,l,u="",c=0;(e=null!=e&&e)||(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}(t));for(;c<t.length;)n=t.charCodeAt(c++),r=t.charCodeAt(c++),i=t.charCodeAt(c++),s=n>>2,a=(3&n)<<4|r>>4,o=(15&r)<<2|i>>6,l=63&i,isNaN(r)?o=l=64:isNaN(i)&&(l=64),u=u+this._keyStr.charAt(s)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(l);return u}}}),define("skylark-langx-strings/main",["./strings","./base64"],function(t){return t}),define("skylark-langx-strings",["skylark-langx-strings/main"],function(t){return t}),define("skylark-langx/strings",["skylark-langx-strings"],function(t){return t}),define("skylark-langx/Stateful",["./Evented","./strings","./objects"],function(t,e,n){var r=n.isEqual,i=n.mixin,s=n.result,a=n.isEmptyObject,o=n.clone,l=e.uniqueId,u=t.inherit({_construct:function(t,e){var n=t||{};e||(e={}),this.cid=l(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var r=s(this,"defaults");n=i({},r,n),this.set(n,e),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(t){return o(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return null!=this.get(t)},set:function(t,e,n){if(null==t)return this;var i;if("object"==typeof t?(i=t,n=e):(i={})[t]=e,n||(n={}),!this._validate(i,n))return!1;var s=n.unset,a=n.silent,l=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=o(this.attributes),this.changed={});var c=this.attributes,h=this.changed,f=this._previousAttributes;for(var d in i)e=i[d],r(c[d],e)||l.push(d),r(f[d],e)?delete h[d]:h[d]=e,s?delete c[d]:c[d]=e;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!a){l.length&&(this._pending=n);for(var p=0;p<l.length;p++)this.trigger("change:"+l[p],this,c[l[p]],n)}if(u)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i({},t,{unset:!0}))},hasChanged:function(t){return null==t?!a(this.changed):void 0!==this.changed[t]},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&o(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var i in t){var s=t[i];r(e[i],s)||(n[i]=s)}return!a(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i(e,{validationError:n})),!1)}});return u}),define("skylark-langx-topic/topic",["skylark-langx-ns","skylark-langx-events"],function(t,e){var n=new e.Emitter;return t.attach("langx.topic",{publish:function(t,e,r){var i=[].slice.call(arguments,1);return n.trigger({type:t,data:i})},subscribe:function(t,e,r){var i=function(t){e.apply(r,t.data)};return n.on(t,i),{remove:function(){n.off(t,i)}}}})}),define("skylark-langx-topic/main",["./topic"],function(t){return t}),define("skylark-langx-topic",["skylark-langx-topic/main"],function(t){return t}),define("skylark-langx/topic",["skylark-langx-topic"],function(t){return t}),define("skylark-langx/types",["skylark-langx-types"],function(t){return t}),define("skylark-langx/langx",["./skylark","./arrays","./ArrayStore","./aspect","./async","./binary","./datetimes","./Deferred","./Emitter","./Evented","./events","./funcs","./hoster","./klass","./maths","./numerics","./objects","./Stateful","./strings","./topic","./types"],function(t,e,n,r,i,s,a,o,l,u,c,h,f,d,p,m,g,y,v,x,k){"use strict";Array.prototype.concat,Array.prototype.indexOf,Array.prototype.slice,Array.prototype.filter;var b=g.mixin,_=(g.safeMixin,k.isFunction);var w=1;function C(){return C}return b(C,{createEvent:l.createEvent,funcArg:function(t,e,n,r){return _(e)?e.call(t,n,r):e},getQueryParams:function(t){var e=(t=t||window.location.href).split("?"),n={};e.length>1&&e[1].split("&").forEach(function(t){var e=t.split("=");n[e[0]]=e[1]});return n},toPixel:function(t){return parseFloat(t)||0},uid:function(t){return t._uid||(t._uid=w++)},URL:"undefined"!=typeof window?window.URL||window.webkitURL:null}),b(C,e,r,a,h,m,g,v,k,{ArrayStore:n,async:i,Deferred:o,Emitter:l,Evented:u,hoster:f,klass:d,Stateful:y,topic:x}),t.langx=C}),define("skylark-domx-browser/browser",["skylark-langx/skylark","skylark-langx/langx"],function(t,e){"use strict";var n,r,i=e.hoster.browser,s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},a=null,o="",l="",u={},c={},h=/^(Webkit|webkit|O|Moz|moz|ms)(.*)$/,f=window.document,d=f.createElement("div"),p=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.matchesSelector,m=d.requestFullscreen||d.webkitRequestFullscreen||d.mozRequestFullScreen||d.msRequestFullscreen,g=(f.exitFullscreen||f.webkitCancelFullScreen||f.mozCancelFullScreen||f.msExitFullscreen,d.style);for(var y in g){var v=y.match(r||h);if(v){r||(n=v[1],r=new RegExp("^("+n+")(.*)$"),n,o="-"+n.toLowerCase()+"-",l=n.toLowerCase()),u[e.lowerFirst(v[2])]=y;var x=e.dasherize(v[2]);c[x]=o+x,s[y]&&(a=s[y])}}return a||void 0!==g.transition&&(a=s.transition),e.mixin(i,{css3PropPrefix:o,isIE:!!/msie/i.exec(window.navigator.userAgent),normalizeStyleProperty:function(t){return u[t]||t},normalizeCssProperty:function(t){return c[t]||t},normalizeCssEvent:function(t){return l?l+t:t.toLowerCase()},matchesSelector:p,requestFullScreen:m,exitFullscreen:m,location:function(){return window.location},support:{}}),a&&(i.support.transition={end:a}),i.support.cssPointerEvents=(d.style.cssText="pointer-events:auto","auto"===d.style.pointerEvents),d=null,t.attach("domx.browser",i)}),define("skylark-domx-browser/main",["./browser"],function(t){return t}),define("skylark-domx-browser",["skylark-domx-browser/main"],function(t){return t}),define("skylark-domx-noder/noder",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser"],function(t,e,n){var r=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),i=/^\s*<(\w+|!)[^>]*>/,s=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,a=document.createElement("div"),o=document.createElement("table"),l=document.createElement("tbody"),u=document.createElement("tr"),c={tr:l,tbody:o,thead:o,tfoot:o,td:u,th:u,"*":a},h=/^(?:body|html)$/i,f=Array.prototype.map,d=Array.prototype.slice;function p(t,n){return e.isArrayLike(t)||(t=[t]),n&&(t=f.call(t,function(t){return t.cloneNode(!0)})),e.flatten(t)}function m(t,e){var n=t.nodeName&&t.nodeName.toLowerCase();return void 0!==e?n===e.toLowerCase():n}function g(t,n){if(e.isFunction(t))return t.apply(n,[]);if(e.isArrayLike(t)){for(var r,i=0;i<t.length;i++)e.isFunction(t[i])&&(t[i]=t[i].apply(n,[]),e.isArrayLike(t[i])&&(r=!0));r&&(t=e.flatten(t))}return t}function y(t,e,n){e=g(e,t);for(var r=t,i=p(e,n),s=0;s<i.length;s++)r.appendChild(i[s]);return this}function v(t,e,n){var r;if(r=/svg/i.test(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t),e)for(var i in e)r.setAttribute(i,e[i]);return n&&y(n,r),r}var x=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;function k(t,e,n){if(n)return t.parentNode===e;if(document.documentElement.contains)return e.contains(t);for(;t;){if(e===t)return!0;t=t.parentNode}return!1}function b(t){return t?9==t.nodeType?t:t.ownerDocument:document}function _(t){return!!t&&("false"!==t.contentEditable&&("true"===t.contentEditable||_(t.parentNode)))}function w(){return w}return e.mixin(w,{active:function(t){var e;t=t||document;try{e=t.activeElement}catch(n){e=t.body}e||(e=t.body);e.nodeName||(e=t.body);return e},after:function(t,e,n){e=g(e,t);var r=(s=t).parentNode;if(r)for(var i=p(e,n),s=s.nextSibling,a=0;a<i.length;a++)s?r.insertBefore(i[a],s):r.appendChild(i[a]);return this},append:y,before:function(t,e,n){e=g(e,t);var r=t,i=r.parentNode;if(i)for(var s=p(e,n),a=0;a<s.length;a++)i.insertBefore(s[a],r);return this},blur:function(t){t.blur()},body:function(){return document.body},clone:function(t,e){var n,i=this;if(!r||1!==t.nodeType||e)return t.cloneNode(e);if(!e)return n=document.createElement(t.nodeName),each(i.getAttribs(t),function(e){i.setAttrib(n,e.nodeName,i.getAttrib(t,e.nodeName))}),n},contains:function(t,e){return k(e,t)},contents:function(t){if(m(t,"iframe"))return t.contentDocument;return t.childNodes},createElement:v,createFragment:function(t){if(t=e.trim(t),s.test(t))return[v(RegExp.$1)];var n=i.test(t)&&RegExp.$1;n in c||(n="*");var r=c[n];return r.innerHTML=function(t){for(var e=t.split("/>"),n="",r=0;r<e.length-1;r++){var i=e[r].split("<");n+=e[r]+"></"+i[i.length-1].split(" ")[0]+">"}return n+e[e.length-1]}(""+t),dom=d.call(r.childNodes),dom.forEach(function(t){r.removeChild(t)}),dom},createTextNode:function(t){return document.createTextNode(t)},doc:function(){return document},empty:function(t){for(;t.hasChildNodes();){var e=t.firstChild;t.removeChild(e)}return this},generateId:function(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;for(;n--;)r+=e.charCodeAt(n);return r.toString(36)},fullScreen:function(t){if(!1===t)n.exitFullScreen.apply(document);else{if(!t)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n.requestFullScreen.apply(t),t}},focusable:function(t,e){var n,r,i,s,a,o=t.nodeName.toLowerCase();if("area"===o)return n=t.parentNode,r=n.name,!(!t.href||!r||"map"!==n.nodeName.toLowerCase())&&((i=$("img[usemap='#"+r+"']")).length>0&&i.is(":visible"));/^(input|select|textarea|button|object)$/.test(o)?(s=!t.disabled)&&(a=$(t).closest("fieldset")[0])&&(s=!a.disabled):s="a"===o&&t.href||e;return s&&$(t).is(":visible")&&visible($(t))},fromPoint:function(t,e){return document.elementFromPoint(t,e)},html:function(t,n){if(void 0===n)return t.innerHTML;if(this.empty(t),n=n||"",e.isString(n)&&(n=n.replace(x,"<$1></$2>")),e.isString(n)||e.isNumber(n))t.innerHTML=n;else if(e.isArrayLike(n))for(var r=0;r<n.length;r++)t.appendChild(n[r]);else t.appendChild(n);return this},isActive:function(t){return t===document.activeElement&&(t.type||t.href)},isChildOf:k,isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isEditable:_,isInDocument:function(t){return t===document.body||document.body.contains(t)},isInput:function(t){return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||_(t)},isWindow:e.isWindow,nodeName:m,offsetParent:function(t){var e=t.offsetParent||document.body;for(;e&&!h.test(e.nodeName)&&"static"==document.defaultView.getComputedStyle(e).position;)e=e.offsetParent;return e},ownerDoc:b,ownerWindow:function(t){var e=b(t);return e.defaultView||e.parentWindow},prepend:function(t,e,n){for(var r=t,i=r.firstChild,s=p(e,n),a=0;a<s.length;a++)i?r.insertBefore(s[a],i):r.appendChild(s[a]);return this},reflow:function(t){null==el&&(t=document);return t.offsetHeight,this},remove:function(t){if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch(t){console.warn("The node is already removed",t)}return this},removeChild:function(t,n){e.isArrayLike(n)||(n=[n]);for(var r=0;r<n.length;r++)t.removeChild(n[r]);return this},replace:function(t,e){return e.parentNode.replaceChild(t,e),this},selectable:function(t,e){if(void 0===t||void 0===t.style)return;t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off"},traverse:function t(e,n){n(e);for(var r=0,i=e.childNodes.length;r<i;r++)t(e.childNodes[r],n);return this},reverse:function(t){for(var e=t.firstChild,n=t.children.length-1;n>0;n--)if(n>0){var r=t.children[n];t.insertBefore(r,e)}},wrapper:function(t,n){e.isString(n)&&(n=this.createFragment(n).firstChild);t.parentNode.insertBefore(n,t),n.appendChild(t)},wrapperInner:function(t,e){var n=d.call(t.childNodes);t.appendChild(e);for(var r=0;r<n.length;r++)e.appendChild(n[r]);return this},unwrap:function(t){var e=t.parentNode;if(e){if(this.isDoc(e.parentNode))return;e.parentNode.insertBefore(t,e)}}}),t.attach("domx.noder",w)}),define("skylark-domx-noder/main",["./noder"],function(t){return t}),define("skylark-domx-noder",["skylark-domx-noder/main"],function(t){return t}),define("skylark-domx-styler/styler",["skylark-langx/skylark","skylark-langx/langx"],function(t,e){Array.prototype.every;var n=Array.prototype.forEach,r=e.camelCase,i=e.dasherize;function s(t,e){return"number"!=typeof e||a[i(t)]?e:e+"px"}var a={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},o={};function l(t){return t in o?o[t]:o[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function u(t,e){var n=t.className||"",r=n&&void 0!==n.baseVal;if(void 0===e)return r?n.baseVal:n;r?n.baseVal=e:t.className=e}var c={};function h(t,n){if(!n)return this;var r=u(t);return(e.isString(n)?n.split(/\s+/g):n).forEach(function(t){var e=l(t);r.match(e)||(r+=(r?" ":"")+t)}),u(t,r),this}function f(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=window),e.getComputedStyle(t)}function d(t,e){var n=l(e);return t.className&&t.className.match(n)}function p(t,n){if(n){var r=u(t);(e.isString(n)?n.split(/\s+/g):n).forEach(function(t){var e=l(t);r.match(e)&&(r=r.replace(e," "))}),u(t,r.trim())}else u(t,"");return this}var m=function(){return m};return e.mixin(m,{autocssfix:!1,cssHooks:{},addClass:h,className:u,css:function(t,a,o){if(void 0==o){var l=f(t);if(void 0==a)return l;if(e.isString(a))return t.style[r(a)]||l.getPropertyValue(i(a));if(e.isArrayLike(a)){var u={};return n.call(a,function(e){u[e]=t.style[r(e)]||l.getPropertyValue(i(e))}),u}}var c="";if("string"==typeof a)o||0===o?c=i(a)+":"+s(a,o):t.style.removeProperty(i(a));else for(key in a)void 0!==a[key]&&(a[key]||0===a[key]?c+=i(key)+":"+s(key,a[key])+";":t.style.removeProperty(i(key)));return t.style.cssText+=";"+c,this},disabled:function(t,e){if(arguments.length<2)return!!this.dom.disabled;return t.disabled=e,this},hasClass:d,hide:function(t){return m.css(t,"display","none"),this},isInvisible:function(t){return"none"==m.css(t,"display")||0==m.css(t,"opacity")},removeClass:p,show:function(t){m.css(t,"display",""),"none"==m.css(t,"display")&&m.css(t,"display",function(t){var e,n;c[t]||(e=document.createElement(t),document.body.appendChild(e),n=f(e).getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),c[t]=n);return c[t]}(t.nodeName));return this},toggleClass:function(t,e,n){return e.split(/\s+/g).forEach(function(e){void 0===n&&(n=!d(t,e)),n?h(t,e):p(t,e)}),this}}),t.attach("domx.styler",m)}),define("skylark-domx-styler/main",["./styler"],function(t,e,n){return t}),define("skylark-domx-styler",["skylark-domx-styler/main"],function(t){return t}),define("skylark-domx-finder/finder",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-styler"],function(t,e,n,r,s){var a={},o=Array.prototype.filter,l=Array.prototype.slice,u=n.matchesSelector;(function(){var t,e,n,r,i,s={},a={},o=/\\/g,l=function(n,i){if(null==n)return null;if(!0===n.Slick)return n;n=(""+n).replace(/^\s+|\s+$/g,"");var o=(r=!!i)?a:s;if(o[n])return o[n];for(t={Slick:!0,expressions:[],raw:n,reverse:function(){return l(this.raw,!0)}},e=-1;n!=(n=n.replace(f,d)););return t.length=t.expressions.length,o[t.raw]=r?c(t):t},u=function(t){return"!"===t?" ":" "===t?"!":/^!/.test(t)?t.replace(/^!/,""):"!"+t},c=function(t){for(var e=t.expressions,n=0;n<e.length;n++){for(var r=e[n],i={parts:[],tag:"*",combinator:u(r[0].combinator)},s=0;s<r.length;s++){var a=r[s];a.reverseCombinator||(a.reverseCombinator=" "),a.combinator=a.reverseCombinator,delete a.reverseCombinator}r.reverse().push(i)}return t},h=(i=/(?=[\-\[\]{}()*+?.\\\^$|,#\s])/g,function(t){return t.replace(i,"\\")}),f=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+h(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function d(i,s,a,l,c,f,d,p,m,g,y,v,x,k,b,_){if((s||-1===e)&&(t.expressions[++e]=[],n=-1,s))return"";if(a||l||-1===n){a=a||" ";var w=t.expressions[e];r&&w[n]&&(w[n].reverseCombinator=u(a)),w[++n]={combinator:a,tag:"*"}}var C=t.expressions[e][n];if(c)C.tag=c.replace(o,"");else if(f)C.id=f.replace(o,"");else if(d)d=d.replace(o,""),C.classList||(C.classList=[]),C.classes||(C.classes=[]),C.classList.push(d),C.classes.push({value:d,regexp:new RegExp("(^|\\s)"+h(d)+"(\\s|$)")});else if(x)_=(_=_||b)?_.replace(o,""):null,C.pseudos||(C.pseudos=[]),C.pseudos.push({key:x.replace(o,""),value:_,type:1==v.length?"class":"element"});else if(p){var S,M;switch(p=p.replace(o,""),y=(y||"").replace(o,""),m){case"^=":M=new RegExp("^"+h(y));break;case"$=":M=new RegExp(h(y)+"$");break;case"~=":M=new RegExp("(^|\\s)"+h(y)+"(\\s|$)");break;case"|=":M=new RegExp("^"+h(y)+"(-|$)");break;case"=":S=function(t){return y==t};break;case"*=":S=function(t){return t&&t.indexOf(y)>-1};break;case"!=":S=function(t){return y!=t};break;default:S=function(t){return!!t}}""==y&&/^[*$^]=$/.test(m)&&(S=function(){return!1}),S||(S=function(t){return t&&M.test(t)}),C.attributes||(C.attributes=[]),C.attributes.push({key:p,operator:m,value:y,test:S})}return""}var p=this.Slick||{};p.parse=function(t){return l(t)},p.escapeRegExp=h,this.Slick||(this.Slick=p)}).apply(a);var c=/^(?:input|select|textarea|button)$/i,h=/^h\d$/i,l=Array.prototype.slice;a.parseSelector=a.Slick.parse;var f=a.pseudos={button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},checked:function(t){return!!t.checked},contains:function(t,e,n,r){if($(this).text().indexOf(r)>-1)return this},disabled:function(t){return!!t.disabled},enabled:function(t){return!t.disabled},eq:function(t,e,n,r){return e==r},even:function(t,e,n,r){return e%2==0},focus:function(t){return document.activeElement===t&&(t.href||t.type||t.tabindex)},focusable:function(t){return r.focusable(t,null!=t.tabindex)},first:function(t,e){return 0===e},gt:function(t,e,n,r){return e>r},has:function(t,e,n,r){return k(t,r)},header:function(t){return h.test(t.nodeName)},hidden:function(t){return!a.pseudos.visible(t)},input:function(t){return c.test(t.nodeName)},last:function(t,e,n){return e===n.length-1},lt:function(t,e,n,r){return e<r},not:function(t,e,n,r){return!w(t,r)},odd:function(t,e,n,r){return e%2==1},parent:function(t){return!!t.parentElement},selected:function(t){return!!t.selected},tabbable:function(t){var e=t.tabindex,n=null!=e;return(!n||e>=0)&&r.focusable(element,n)},text:function(t){return"text"===t.type},visible:function(t){return t.offsetWidth&&t.offsetWidth},empty:function(t){return!t.hasChildNodes()}};function d(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function p(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}for(i in["first","eq","last"].forEach(function(t){f[t].isArrayFilter=!0}),f.nth=f.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})f[i]=d(i);for(i in{submit:!0,reset:!0})f[i]=p(i);function m(t,n,r){for(var i=[],s=r&&e.isString(r);(t=t.parentElement)&&9!==t.nodeType;){if(r)if(s){if(w(t,r))break}else if(e.isArrayLike(r)){if(e.inArray(t,r)>-1)break}else if(t==r)break;n&&!w(t,n)||i.push(t)}return i}function g(t,e){for(var n=t.childNodes,r=[],i=0;i<n.length;i++){var t=n[i];1==t.nodeType&&r.push(t)}return e&&(r=a.filter(r,e)),r}function y(t,e,n,r){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentElement===n&&w(t,e):w(t,e))||r&&t===n)return t;if(t===n)break}while(t=M(t))}return null}function v(t,e){try{return l.call(t.querySelectorAll(e))}catch(t){}return a.query(t,e)}function x(t,e){try{return t.querySelector(e)}catch(t){}var n=a.query(t,e);return n.length>0?n[0]:null}function k(t,e){return e||(e=t,t=document.body),w(t,e)?t:x(t,e)}function b(t,e,n){for(var r=t.childNodes,i=r[0];i;){if(1==i.nodeType){if(!e||w(i,e))return i;if(n)break}i=i.nextSibling}return null}function _(t,e,n){for(var r=t.childNodes,i=r[r.length-1];i;){if(1==i.nodeType){if(!e||w(i,e))return i;if(n)break}i=i.previousSibling}return null}function w(t,n){if(!n||!t||1!==t.nodeType)return!1;if(e.isString(n)){try{return u.call(t,n.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(t){}return a.match(t,n)}return e.isArrayLike(n)?e.inArray(t,n)>-1:e.isPlainObject(n)?a.check(t,n):t===n}function C(t,e,n){for(var r=t.nextSibling;r;){if(1==r.nodeType){if(!e||w(r,e))return r;if(n)break}r=r.nextSibling}return null}function S(t,e){for(var n=t.nextSibling,r=[];n;)1==n.nodeType&&(e&&!w(n,e)||r.push(n)),n=n.nextSibling;return r}function M(t,e){var n=t.host&&t!==document&&t.host.nodeType?t.host:t.parentElement;return!n||e&&!w(n,e)?null:n}function E(t,e,n){for(var r=t.previousSibling;r;){if(1==r.nodeType){if(!e||w(r,e))return r;if(n)break}r=r.previousSibling}return null}function A(t,e){for(var n=t.previousSibling,r=[];n;)1==n.nodeType&&(e&&!w(n,e)||r.push(n)),n=n.previousSibling;return r}function z(t,e){for(var n=t.parentElement.firstChild,r=[];n;)1==n.nodeType&&n!==t&&(e&&!w(n,e)||r.push(n)),n=n.nextSibling;return r}a.divide=function(t){var e,n,r,i,s,a="",o=[];if((n=t.id)&&(a+="#"+n),r=t.classes)for(var l=r.length;l--;)a+="."+r[l].value;if(i=t.attributes)for(var l=0;l<i.length;l++)i[l].operator?a+="["+i[l].key+i[l].operator+JSON.stringify(i[l].value)+"]":a+="["+i[l].key+"]";if(s=t.pseudos)for(l=s.length;l--;)part=s[l],this.pseudos[part.key]?o.push(part):void 0!==part.value&&(a+=":"+part.key+"("+JSON.stringify(part));return(e=t.tag)&&"*"!==e&&(a=e.toUpperCase()+a),a||(a="*"),{nativeSelector:a,customPseudos:o}},a.check=function(t,e,n,r,i){var s,a,o,l,c,h,f,d,p;if(!i){if(s=e.tag){var m=t.nodeName.toUpperCase();if("*"==s){if(m<"@")return!1}else if(m!=(s||"").toUpperCase())return!1}if((a=e.id)&&t.getAttribute("id")!=a)return!1;if(o=e.classes)for(h=o.length;h--;)if(!(d=t.getAttribute("class"))||!o[h].regexp.test(d))return!1;if(l=e.attributes)for(h=l.length;h--;)if((f=l[h]).operator?!f.test(t.getAttribute(f.key)):!t.hasAttribute(f.key))return!1}if(c=e.pseudos)for(h=c.length;h--;)if(f=c[h],p=this.pseudos[f.key]){if((i&&p.isArrayFilter||!i&&!p.isArrayFilter)&&!p(t,n,r,f.value))return!1}else if(!i&&!u.call(t,f.key))return!1;return!0},a.match=function(t,n){var r;if(!(r=e.isString(n)?a.Slick.parse(n):n))return!0;var i,s,o=r.expressions,l=0;for(i=0;s=o[i];i++)if(1==s.length){var u=s[0];if(this.check(t,u))return!0;l++}if(l==r.length)return!1;var c,h=this.query(document,r);for(i=0;c=h[i++];)if(c===t)return!0;return!1},a.filterSingle=function(t,e){var n=o.call(t,function(n,r){return a.check(n,e,r,t,!1)});return n=o.call(n,function(t,r){return a.check(t,e,r,n,!0)})},a.filter=function(t,n){if(!e.isString(n))return a.filterSingle(t,n);var r,i,s=a.Slick.parse(n).expressions,o=[];for(r=0;i=s[r];r++){if(1!=i.length)throw new Error("not supported selector:"+n);var l=i[0],u=a.filterSingle(t,l);o=e.uniq(o.concat(u))}return o},a.combine=function(t,e){var n,r=e.combinator,i=e,s=[];switch(r){case">":s=g(t,i);break;case"+":(n=C(t,i,!0))&&s.push(n);break;case"^":(n=b(t,i,!0))&&s.push(n);break;case"~":s=S(t,i);break;case"++":var u=E(t,i,!0),c=C(t,i,!0);u&&s.push(u),c&&s.push(c);break;case"~~":s=z(t,i);break;case"!":s=m(t,i);break;case"!>":(n=M(t,i))&&s.push(n);break;case"!+":s=E(t,i,!0);break;case"!^":(n=_(t,i,!0))&&s.push(n);break;case"!~":s=A(t,i);break;default:var h=this.divide(e);if(s=l.call(t.querySelectorAll(h.nativeSelector)),h.customPseudos)for(var f=h.customPseudos.length-1;f>=0;f--)s=o.call(s,function(t,e){return a.check(t,{pseudos:[h.customPseudos[f]]},e,s,!1)}),s=o.call(s,function(t,e){return a.check(t,{pseudos:[h.customPseudos[f]]},e,s,!0)})}return s},a.query=function(t,n,r){for(var i,s,o=this.Slick.parse(n),l=[],u=o.expressions,c=0;i=u[c];c++){for(var h,f=[t],d=0;s=i[d];d++)(h=e.map(f,function(t,e){return a.combine(t,s)}))&&(f=h);h&&(l=l.concat(h))}return l};var T=function(){return T};return e.mixin(T,{ancestor:function(t,n,r){var i=r&&e.isString(r);for(;t=t.parentElement;){if(w(t,n))return t;if(r)if(i){if(w(t,r))break}else if(t==r)break}return null},ancestors:m,byId:function(t,e){return(e=e||r.doc()).getElementById(t)},childAt:function(t,n,r){var i=0,a=t.children;r=e.mixin({ignoreHidden:!0,excluding:null,closesting:null},r);for(var o=0;o<a.length;o++){var l=a[o];if((!r.ignoreHidden||"none"!==s.css(l))&&((!r.excluding||!r.excluding.includes(l))&&(!r.closesting||y(l,r.closesting,t,!1)))){if(i===n)return l;i++}}return null},children:g,closest:y,descendant:x,descendants:v,find:k,findAll:function(t,e){e||(e=t,t=document.body);return v(t,e)},firstChild:b,index:function(t,n){var r=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)e.isString(n)?w(t,n)&&r++:e.isFunction(n)&&n(t)&&r++,r++;return r},lastChild:_,matches:w,nextSibling:C,nextSiblings:S,parent:M,previousSibling:E,previousSiblings:A,pseudos:a.pseudos,siblings:z}),t.attach("domx.finder",T)}),define("skylark-domx-finder/main",["./finder"],function(t){return t}),define("skylark-domx-finder",["skylark-domx-finder/main"],function(t){return t}),define("skylark-domx-data/data",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-finder","skylark-domx-noder"],function(t,e,n,r){var i=Array.prototype.map,s=(Array.prototype.filter,e.camelCase),a=e.deserializeValue,o=/([A-Z])/g,l={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};var u={option:{get:function(t){var e=t.getAttribute("value");return null!=e?e:(m(t).match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")}},select:{get:function(t){var e,n,i,s=t.options,a=t.selectedIndex,o="select-one"===t.type,l=o?null:[],u=o?a+1:s.length;for(i=a<0?u:o?a:0;i<u;i++)if((n=s[i]).selected&&!n.disabled&&(!n.parentNode.disabled||!r.nodeName(n.parentNode,"optgroup"))){if(e=g(n),o)return e;l.push(e)}return l},set:function(t,n){for(var r,i,s=t.options,a=e.makeArray(n),o=s.length;o--;)((i=s[o]).selected=e.inArray(u.option.get(i),a)>-1)&&(r=!0);return r||(t.selectedIndex=-1),a}}};function c(t,e,n){if(void 0===n){if("object"==typeof e){for(var r in e)c(t,r,e[r]);return this}return t.getAttribute?t.getAttribute(e):t[e]}return t.setAttribute?t.setAttribute(e,n):t[e]=n,this}function h(t,n){var r=t._$_store;return!r&&n&&(r=t._$_store=function(t){var n={};return e.each(t.attributes||[],function(t,e){0==e.name.indexOf("data-")&&(n[s(e.name.replace("data-",""))]=a(e.value))}),n}(t)),r}function f(t,e,n){var r=h(t,!0);r[s(e)]=n}function d(t,e,n){if(void 0===n){if("object"==typeof e){for(var r in e)f(t,r,e[r]);return this}return function(t,e){if(void 0===e)return h(t,!0);var n=h(t);if(n){if(e in n)return n[e];var r=s(e);if(r in n)return n[r]}var i="data-"+e.replace(o,"-$1").toLowerCase();return c(t,i)}(t,e)}return f(t,e,n),this}function p(t){t._$_store&&delete t._$_store}function m(t,e){return void 0===e?t.textContent:(t.textContent=null==e?"":""+e,this)}function g(t,n){var r=u[t.type]||u[t.nodeName.toLowerCase()];if(void 0===n)return r&&"get"in r&&void 0!==(ret=r.get(t,"value"))?ret:(ret=t.value,"string"==typeof ret?ret.replace(/\r/g,""):null==ret?"":ret);null==n?n="":"number"==typeof n?n+="":e.isArray(n)&&(n=e.map(n,function(t){return null==t?"":t+""})),r&&"set"in r&&void 0!==r.set(t,n,"value")||(t.value=n)}function y(){return y}return e.each(["radio","checkbox"],function(){u[this]={set:function(t,n){if(e.isArray(n))return t.checked=e.inArray(g(t),n)>-1}}}),n.pseudos.data=function(t,e,n,r){return!!d(t,r||n[3])},e.mixin(y,{aria:function(t,e,n){return this.attr(t,"aria-"+e,n)},attr:c,cleanData:p,data:d,pluck:function(t,e){return i.call(t,function(t){return t[e]})},prop:function(t,e,n){return e=l[e]||e,void 0===n?t[e]:(t[e]=n,this)},removeAttr:function(t,e){return e.split(" ").forEach(function(e){!function(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}(t,e)}),this},removeData:function(t,n){if(n){e.isString(n)&&(n=n.split(/\s+/));var r=h(t,!0);n.forEach(function(t){delete r[t]})}else p(t);return this},removeProp:function(t,e){return e.split(" ").forEach(function(e){delete t[e]}),this},text:m,val:g,valHooks:u}),t.attach("domx.data",y)}),define("skylark-domx-query/query",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder"],function(t,e,n,r){var i,s=Array.prototype.some,a=Array.prototype.push,o=(Array.prototype.every,Array.prototype.concat,Array.prototype.slice),l=(Array.prototype.map,Array.prototype.filter),u=Array.prototype.forEach,c=Array.prototype.indexOf,h=Array.prototype.sort,f=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,d=e.funcArg,p=e.isArrayLike,m=e.isString,g=e.uniq,y=e.isFunction,v=e.type,x=(e.isArray,e.isWindow,e.isDocument,e.isObject);e.isPlainObject,e.compact,e.flatten,e.camelCase,e.dasherize,r.children;function k(t,r,i){return function(i){var s,a=e.map(arguments,function(t){return"function"==(s=v(t))||"object"==s||"array"==s||null==t?t:n.createFragment(t)});return a.length<1?this:(this.each(function(e){t.apply(r,[this,a,e>0])}),this)}}function b(t,n){return function(){var r=o.call(arguments),i=e.map(this,function(e,i){return t.apply(n,[e].concat(r))});return A(g(i))}}function _(t,e,n){return function(r){o.call(arguments);var i=this.map(function(i,s){return s.querySelector?t.apply(e,n?[s]:[s,r]):[]});return n&&r?i.filter(r):i}}function w(t,e,n){return function(r,i){o.call(arguments);var s=this.map(function(s,a){return t.apply(e,n?[a,r]:[a,i,r])});return n&&i?s.filter(i):s}}function C(t,e){return function(){var n=o.call(arguments);return this.each(function(r,i){t.apply(e,[this].concat(n))}),this}}function S(t,n,r){return function(i){return e.isDefined(i)?(u.call(this,function(e,s){var a;a=r?d(e,i,s,r(e)):i,t.apply(n,[e,a])}),this):this[0]?t.apply(n,[this[0]]):void 0}}var M,E=e.klass({klassName:"SkNodeList",init:function(t,i){var s,o,l,u;if(t&&(this.context=i=i||n.doc(),m(t)?(this.selector=t,(s="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:f.exec(t))?s[1]?(o=n.createFragment(t),e.isPlainObject(i)&&(u=i)):(l=r.byId(s[2],n.ownerDoc(i)))&&(o=[l]):(e.isString(i)&&(i=r.find(i)),o=r.descendants(i,t))):o=!n.isWindow(t)&&p(t)?t:[t]),o&&(a.apply(this,o),u))for(var c in u)e.isFunction(this[c])?this[c](u[c]):this.attr(c,u[c]);return this}}),A=function(){i=function(t){return t instanceof E},init=function(t,e){return new E(t,e)};var t=function(e,n){return y(e)?(t.ready(function(){e(t)}),f):i(e)?e:n&&i(n)&&m(e)?n.find(e):init(e,n)},f=t(document);t.fn=E.prototype,e.mixin(t.fn,{length:0,map:function(n){return t(g(e.map(this,function(t,e){return n.call(t,e,t)})))},slice:function(){return t(o.apply(this,arguments))},forEach:function(){return u.apply(this,arguments)},get:function(t){return void 0===t?o.call(this):this[t>=0?t:t+this.length]},indexOf:function(){return c.apply(this,arguments)},sort:function(){return h.apply(this,arguments)},toArray:function(){return o.call(this)},size:function(){return this.length},remove:function(t){return t?this.find(t).remove():(this.each(function(t,e){n.remove(e)}),this)},each:function(t){return e.each(this,t),this},filter:function(e){return y(e)?this.not(this.not(e)):t(l.call(this,function(t){return r.matches(t,e)}))},add:function(e,n){return t(g(this.toArray().concat(t(e,n).toArray())))},is:function(t){if(this.length>0){if(e.isString(t))return s.call(this,function(e){return r.matches(e,t)});if(e.isArrayLike(t))return s.call(this,function(n){return e.inArray(n,t)>-1});if(e.isHtmlNode(t))return s.call(this,function(e){return e==t})}return!1},not:function(e){var n=[];if(y(e)&&void 0!==e.call)this.each(function(t,r){e.call(this,t,r)||n.push(this)});else{var r="string"==typeof e?this.filter(e):p(e)&&y(e.item)?o.call(e):t(e);this.forEach(function(t){r.indexOf(t)<0&&n.push(t)})}return t(n)},has:function(e){return this.filter(function(){return x(e)?n.contains(this,e):t(this).find(e).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:_(r.descendants,r),closest:_(r.closest,r),parents:_(r.ancestors,r),parentsUntil:w(r.ancestors,r),parent:_(r.parent,r),children:_(r.children,r),contents:b(n.contents,n),empty:C(n.empty,n),html:S(n.html,n),pluck:function(t){return e.map(this,function(e){return e[t]})},pushStack:function(e){var n=t(e);return n.prevObject=this,n},replaceWith:function(t){return this.before(t).remove()},wrap:function(e){var n="function"==typeof e;return this.each(function(r){t(this).wrapAll(n?e.call(this,r):e)})},wrapAll:function(e){var n;return this[0]&&("function"==typeof e&&(e=e.call(this[0])),n=t(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&n.insertBefore(this[0]),n.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(e){return"function"==typeof e?this.each(function(n){t(this).wrapInner(e.call(this,n))}):this.each(function(){var n=t(this),r=n.contents();r.length?r.wrapAll(e):n.append(e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){t(this).replaceWith(this.childNodes)}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},toggle:function(e){return this.each(function(){var n=t(this);(void 0===e?"none"==n.css("display"):e)?n.show():n.hide()})},prev:function(e){return t(this.pluck("previousElementSibling")).filter(e||"*")},prevAll:_(r.previousSiblings,r),next:function(e){return t(this.pluck("nextElementSibling")).filter(e||"*")},nextAll:_(r.nextSiblings,r),siblings:_(r.siblings,r),index:function(e){return e?this.indexOf(t(e)[0]):this.parent().children().indexOf(this[0])}}),t.fn.detach=t.fn.remove,t.fn.hover=function(t,e){return this.mouseenter(t).mouseleave(e||t)};n.traverse;return t.fn.after=k(n.after,n),t.fn.prepend=k(n.prepend,n),t.fn.before=k(n.before,n),t.fn.append=k(n.append,n),e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,n){t.fn[e]=function(e){for(var r,i=[],s=t(e),o=s.length-1,l=0;l<=o;l++)r=l===o?this:this.clone(!0),t(s[l])[n](r),a.apply(i,r.get());return this.pushStack(i)}}),t}();return(M=A).fn.scrollParent=function(t){var e=this.css("position"),n="absolute"===e,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,i=this.parents().filter(function(){var t=M(this);return(!n||"static"!==t.css("position"))&&r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&i.length?i:M(this[0].ownerDocument||document)},function(t){t.fn.end=function(){return this.prevObject||t()},t.fn.andSelf=function(){return this.add(this.prevObject||t())},t.fn.addBack=function(t){return this.prevObject?t?this.add(this.prevObject.filter(t)):this.add(this.prevObject):this},"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings,prev,prevAll,next,nextAll".split(",").forEach(function(e){var n=t.fn[e];t.fn[e]=function(){var t=n.apply(this,arguments);return t.prevObject=this,t}})}(A),function(t){var s;t.fn.query=t.fn.find,t.fn.place=function(t,s){return e.isString(t)?t=r.descendant(t):i(t)&&(t=t[0]),this.each(function(e,r){switch(s){case"before":n.before(t,r);break;case"after":n.after(t,r);break;case"replace":n.replace(t,r);break;case"only":n.empty(t),n.append(t,r);break;case"first":n.prepend(t,r);break;default:n.append(t,r)}})},t.fn.addContent=function(t,n){return t.template&&(t=e.substitute(t.template,t)),this.append(t)},t.fn.disableSelection=(s="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(s+".ui-disableSelection",function(t){t.preventDefault()})}),t.fn.enableSelection=function(){return this.off(".ui-disableSelection")},t.fn.reflow=function(){return n.flow(this[0])},t.fn.isBlockNode=function(){return n.isBlockNode(this[0])}}(A),A.fn.plugin=function(t,e){var n=o.call(arguments,1),r=this,i=this;return this.each(function(){i=plugins.instantiate.apply(r,[this,t].concat(n))}),i},A.wraps={wrapper_node_operation:k,wrapper_map:b,wrapper_value:S,wrapper_selector:_,wrapper_some_chk:function(t,e){return function(){var n=o.call(arguments);return s.call(this,function(r){return t.apply(e,[r].concat(n))})}},wrapper_selector_until:w,wrapper_every_act_firstArgFunc:function(t,e,n){return function(r){var i=o.call(arguments);return u.call(this,function(s,a){var o=d(s,r,a,n(s));t.apply(e,[s,o].concat(i.slice(1)))}),this}},wrapper_every_act:C,wrapper_name_value:function(t,n,r){return function(i,s){return e.isPlainObject(i)||e.isDefined(s)?(u.call(this,function(e,a){var o;o=r?d(e,s,a,r(e,i)):s,t.apply(n,[e,i,o])}),this):this[0]?t.apply(n,[this[0],i]):void 0}}},t.attach("domx.query",A)}),define("skylark-domx-query/main",["./query","skylark-domx-styler"],function(t,e){return t.fn.style=t.wraps.wrapper_name_value(e.css,e),t.fn.css=t.wraps.wrapper_name_value(e.css,e),t.fn.hasClass=t.wraps.wrapper_some_chk(e.hasClass,e),t.fn.addClass=t.wraps.wrapper_every_act_firstArgFunc(e.addClass,e,e.className),t.fn.removeClass=t.wraps.wrapper_every_act_firstArgFunc(e.removeClass,e,e.className),t.fn.toggleClass=t.wraps.wrapper_every_act_firstArgFunc(e.toggleClass,e,e.className),t.fn.replaceClass=function(t,e){return this.removeClass(e),this.addClass(t),this},t.fn.replaceClass=function(t,e){return this.removeClass(e),this.addClass(t),this},t}),define("skylark-domx-query",["skylark-domx-query/main"],function(t){return t}),define("skylark-domx-velm/velm",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder","skylark-domx-query"],function(t,e,n,r,i){var s=Array.prototype.map,a=Array.prototype.slice,o=e.klass({klassName:"VisualElement",_construct:function(t){e.isString(t)&&(t="<"===t.charAt(0)?n.createFragment(t)[0]:document.getElementById(t)),this._elm=t}});o.prototype.$=o.prototype.query=function(t){return i(t,this._elm)},o.prototype.elm=function(){return this._elm};var l=new o(document.body),u=function(t){return t?new o(t):l};return e.mixin(u,{batch:function(t,e,n){return t.forEach(function(t){var r=t instanceof o?t:u(t);r[e].apply(r,n)}),this},root:new o(document.body),VisualElement:o,partial:function(t,e){var n={};n[t]=e,o.partial(n)},delegate:function(t,n){var r={};t.forEach(function(t){r[t]=function(t,n){return function(){var r=this._elm,i=t.apply(n,[r].concat(a.call(arguments)));if(i){if(i===n)return this;i instanceof HTMLElement?i=new o(i):e.isArrayLike(i)&&(i=s.call(i,function(t){return t instanceof HTMLElement?new o(t):t}))}return i}}(n[t],n)}),o.partial(r)}}),u.delegate(["ancestor","ancestors","children","descendant","find","findAll","firstChild","lastChild","matches","nextSibling","nextSiblings","parent","previousSibling","previousSiblings","siblings"],r),u.find=function(t){return"body"===t?this.root:this.root.descendant(t)},u.delegate(["after","append","before","clone","contains","contents","empty","html","isChildOf","isDocument","isInDocument","isWindow","ownerDoc","prepend","remove","removeChild","replace","reverse","throb","traverse","wrapper","wrapperInner","unwrap"],n),t.attach("domx.velm",u)}),define("skylark-domx-velm/main",["./velm","skylark-domx-styler"],function(t,e){t.delegate(["addClass","className","css","hasClass","hide","isInvisible","removeClass","show","toggleClass"],e);return["position","left","top","right","bottom","width","height","border","borderLeft","borderTop","borderRight","borderBottom","borderColor","display","overflow","margin","marginLeft","marginTop","marginRight","marginBottom","padding","paddingLeft","paddingTop","paddingRight","paddingBottom","color","background","backgroundColor","opacity","fontSize","fontWeight","textAlign","textDecoration","textTransform","cursor","zIndex"].forEach(function(e){var n=e;t.VisualElement.prototype[n]=function(t){return this.css(e,t),this}}),t}),define("skylark-domx-velm",["skylark-domx-velm/main"],function(t){return t}),define("skylark-domx-data/main",["./data","skylark-domx-velm","skylark-domx-query"],function(t,e,n){return e.delegate(["attr","data","prop","removeAttr","removeData","text","val"],t),n.fn.text=n.wraps.wrapper_value(t.text,t,t.text),n.fn.attr=n.wraps.wrapper_name_value(t.attr,t,t.attr),n.fn.removeAttr=n.wraps.wrapper_every_act(t.removeAttr,t),n.fn.prop=n.wraps.wrapper_name_value(t.prop,t,t.prop),n.fn.removeProp=n.wraps.wrapper_every_act(t.removeProp,t),n.fn.data=n.wraps.wrapper_name_value(t.data,t),n.fn.removeData=n.wraps.wrapper_every_act(t.removeData),n.fn.val=n.wraps.wrapper_value(t.val,t,t.val),t}),define("skylark-domx-data",["skylark-domx-data/main"],function(t){return t}),define("skylark-domx-eventer/eventer",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-finder","skylark-domx-noder","skylark-domx-data"],function(t,e,n,r,i,s){e.mixin;var a=e.each,o=(Array.prototype.slice,e.uid),l=/^([A-Z]|returnValue$|layer[XY]$)/,u={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},c=/complete|loaded|interactive/;function h(t,n){return!n&&t.isDefaultPrevented||(n||(n=t),e.each(u,function(r,i){var s=n[r];t[r]=function(){return this[i]=e.returnTrue,s&&s.apply(n,arguments)},t[i]=e.returnFalse})),t}function f(t){var e=(""+t).split(".");return{type:e[0],ns:e.slice(1).sort().join(" ")}}function d(t){return t&&(e.isFunction(t)||e.isFunction(t.handleEvent))}var p=[window.CustomEvent,window.CompositionEvent,window.DragEvent,window.Event,window.FocusEvent,window.KeyboardEvent,window.MessageEvent,window.MouseEvent,window.MouseScrollEvent,window.MouseWheelEvent,window.MutationEvent,window.ProgressEvent,window.TextEvent,window.TouchEvent,window.UIEvent,window.WheelEvent,window.ClipboardEvent],m={compositionstart:1,compositionend:1,compositionupdate:1,beforecopy:16,beforecut:16,beforepaste:16,copy:16,cut:16,paste:16,drag:2,dragend:2,dragenter:2,dragexit:2,dragleave:2,dragover:2,dragstart:2,drop:2,abort:3,change:3,error:3,selectionchange:3,submit:3,reset:3,focus:4,blur:4,focusin:4,focusout:4,keydown:5,keypress:5,keyup:5,message:6,click:7,contextmenu:7,dblclick:7,mousedown:7,mouseup:7,mousemove:7,mouseover:7,mouseout:7,mouseenter:7,mouseleave:7,textInput:12,touchstart:13,touchmove:13,touchend:13,load:14,resize:14,select:14,scroll:14,unload:14,wheel:15},g=function(){return function(t,n){e.isString(t)?n=n||{}:t=(n=t||{}).type||"";var r=f(t);t=r.type,n=e.mixin({bubbles:!0,cancelable:!0},n),r.ns&&(n.namespace=r.ns);var i=function(t){var e=m[t];e||(e=0);return p[e]}(t),s=new i(t,n);return e.safeMixin(s,n),h(s)}}();function y(t,n){var r,i={originalEvent:t};for(r in t)"keyIdentifier"===r||l.test(r)||void 0===t[r]||(i[r]=t[r]);return n&&e.mixin(i,n),h(i,t)}var v={},x="onfocusin"in window,k={focus:"focusin",blur:"focusout"},b={mouseenter:"mouseover",mouseleave:"mouseout"},_=function(t){return b[t]||x&&k[t]||t},w={},C=e.klass({init:function(t,e){this._target=t,this._event=e,this._bindings=[]},add:function(t,n){var s=this._bindings,a={fn:t,options:e.mixin({},n)};s.push(a);var o=this;if(!o._listener){o._listener=function(t){var n=this,s=y(t),a=t._args,l=o._bindings,u=s.namespace;a=e.isDefined(a)?[s].concat(a):[s],e.each(l,function(t,l){var c=n;if(s.isImmediatePropagationStopped&&s.isImmediatePropagationStopped())return!1;var h=l.fn,f=l.options||{},d=f.selector,p=f.one,m=f.data;if(!u||u==f.ns||-1!==f.ns.indexOf(u)){if(d){if(!(c=r.closest(s.target,d))||c===n)return;e.mixin(s,{currentTarget:c,liveFired:n})}var g=o._event;if(g in b){var y=s.relatedTarget;if(y&&(y===c||i.contains(c,y)))return}e.isDefined(m)&&(s.data=m),p&&o.remove(h,f),!1===(h.handleEvent?h.handleEvent.apply(h,a):h.apply(c,a))&&(s.preventDefault(),s.stopPropagation())}})};var l=o._event;o._target.addEventListener?o._target.addEventListener(_(l),o._listener,!1):console.warn("invalid eventer object",o._target)}},remove:function(t,n){var r,i;(n=e.mixin({},n)).ns&&(i=n.ns,r=new RegExp("(?:^| )"+i.replace(" "," .* ?")+"(?: |$)")),this._bindings=this._bindings.filter(function(e){var i=(!t||t===e.fn)&&(!r||r.test(e.options.ns))&&(!n.selector||n.selector==e.options.selector);return!i}),0==this._bindings.length&&(this._target.removeEventListener&&this._target.removeEventListener(_(this._event),this._listener,!1),this._listener=null)}}),S=e.klass({init:function(t){this._target=t,this._handler={}},register:function(t,n,r){var i=f(t),t=i.type,s=v[t],a=s&&(s.bindType||s.bindEventName),o=this._handler;void 0===o[t]&&(o[t]=new C(this._target,a||t)),o[t].add(n,e.mixin({ns:i.ns},r))},unregister:function(t,n,r){var i=this._handler,s=f(t);if(t=s.type){var a=i[t];a&&a.remove(n,e.mixin({ns:s.ns},r))}else for(t in i){var a=i[t];a.remove(n,e.mixin({ns:s.ns},r))}}}),M=function(t){var e=o(t),n=w[e];return n||(n=w[e]=new S(t)),n};function E(t,n,r,i,s,a){if(e.isPlainObject(n))return e.each(n,function(e,n){E(t,e,r,i,n,a)}),this;e.isString(r)||d(s)||(s=i,i=r,r=void 0),d(i)&&(s=i,i=void 0),!1===s&&(s=e.returnFalse),"string"==typeof n&&(n=n.indexOf(",")>-1?n.split(","):n.split(/\s/));var o=M(t);return n.forEach(function(t){if("ready"==t)return A(s);o.register(t,s,{data:i,selector:r,one:!!a})}),this}function A(t){return c.test(document.readyState)&&document.body?e.defer(t):document.addEventListener("DOMContentLoaded",t,!1),this}var z={backspace:8,comma:188,delete:46,down:40,end:35,enter:13,escape:27,home:36,left:37,page_down:34,page_up:33,period:190,right:39,space:32,tab:9,up:38};function T(){return T}return n.support.transition&&(v.transitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end}),e.mixin(T,{NativeEvents:m,create:g,keys:z,off:function t(n,r,i,s){if(e.isPlainObject(r))return e.each(r,function(e,r){t(n,e,i,r)}),this;e.isString(i)||d(s)||!1===s||(s=i,i=void 0);!1===s&&(s=e.returnFalse);"string"==typeof r&&(r=r.indexOf(",")>-1?r.split(","):r.split(/\s/));var a=M(n);r&&r.forEach(function(t){a.unregister(t,s,{selector:i})});return this},on:E,one:function(t,e,n,r,i){return E(t,e,n,r,i,1),this},proxy:y,ready:A,shortcuts:function(t){var e=s.data(t,"shortcuts");if(!e){e={},s.data(t,"shortcuts",e);var n=function(t,e){var n=e.metaKey||e.ctrlKey;if(t.ctrl==n&&t.alt==e.altKey&&t.shift==e.shiftKey&&(e.keyCode==t.keyCode||e.charCode&&e.charCode==t.charCode))return e.preventDefault(),"keydown"==e.type&&t.fn(e),!0};E(t,"keyup keypress keydown",function(t){if(!/INPUT|TEXTAREA/.test(t.target.nodeName))for(var r in e)n(e[r],t)})}return{add:function(t,n){(t.indexOf(",")>-1?t.toLowerCase().split(","):t.toLowerCase().split(" ")).forEach(function(t){var r={fn:n,alt:!1,ctrl:!1,shift:!1};t.split("+").forEach(function(t){switch(t){case"alt":case"ctrl":case"shift":r[t]=!0;break;default:r.charCode=t.charCodeAt(0),r.keyCode=z[t]||t.toUpperCase().charCodeAt(0)}});var i=(r.ctrl?"ctrl":"")+","+(r.alt?"alt":"")+","+(r.shift?"shift":"")+","+r.keyCode;e[i]=r})}}},special:v,stop:function(t){window.document.all&&(t.keyCode=0);t.preventDefault&&(t.preventDefault(),t.stopPropagation());return this},trigger:function(t,e,n){var r;r=e instanceof Event?e:g(e,n);r._args=n;var i=t.dispatchEvent||t.trigger;i?i.call(t,r):console.warn("The evented parameter is not a eventable object");return this}}),a(m,function(t){T[t]=function(e,n,r,i){return arguments.length>1?this.on(e,t,n,r,i):("focus"==t?e.focus&&e.focus():"blur"==t?e.blur&&e.blur():"click"==t?e.click&&e.click():this.trigger(e,t),this)}}),t.attach("domx.eventer",T)}),define("skylark-domx-eventer/main",["skylark-langx/langx","./eventer","skylark-domx-velm","skylark-domx-query"],function(t,e,n,r){var i=["off","on","one","trigger"];return t.each(e.NativeEvents,function(t){i.push(t)}),n.delegate(i,e),t.each(i,function(t,n){r.fn[n]=r.wraps.wrapper_every_act(e[n],e)}),r.ready=e.ready,e}),define("skylark-domx-eventer",["skylark-domx-eventer/main"],function(t){return t}),define("skylark-slax-runtime/slax",["skylark-langx-ns","skylark-langx-objects","skylark-langx-hoster","skylark-langx-async","skylark-net-http/Xhr","skylark-domx-eventer"],function(skylark,objects,hoster,async,Xhr,eventer){var _config={},_rootUrl="",_baseUrl="",slax={prepare:function(config){var p,slaxRoot,slaxApp;if(config||(config=hoster.global.slaxConfig),!config)for(var scripts=document.getElementsByTagName("script"),i=0,script,slaxDir,src,match;i<scripts.length;)if(script=scripts[i++],(src=script.getAttribute("src"))&&(match=src.match(/(((.*)\/)|^)skylark-slax-runtime([0-9A-Za-z\-]*)\.js(\W|$)/i))){slaxDir=match[3]||"",(src=script.getAttribute("data-slax-config"))?config=eval("({ "+src+" })"):(slaxRoot=script.getAttribute("data-slax-root"),void 0==slaxRoot&&(slaxRoot=slaxDir),slaxApp=script.getAttribute("data-slax-app"));break}if(config)objects.mixin(_config,config),p=async.Deferred.resolve();else{var d=new async.Deferred,p=d.promise;Xhr.get(slaxRoot+"/slax-config.json").then(function(t){if(slaxApp){for(var e,n=0;n<t.apps.length;n++)t.apps[n].name==slaxApp&&(e=slaxRoot+t.apps[n].dir);Xhr.get(e+"/spa.json").then(function(t){objects.mixin(_config,t),d.resolve()})}else objects.mixin(_config,t),d.resolve()})}return p},start:function(){var t=_config;require.config(t.runtime);var e=function(e,n){var r=e(n=n||t);hoster.global.go=function(t,e){r.go(t,e)},r.prepare().then(function(){r.run()})};t.spaModule?require([t.spaModule],function(t){t._start?t._start().then(function(n){e(t,n)}):e(t)}):e(skylark.spa)}};return define("slax",[],function(){return slax}),skylark.attach("slax",slax)}),define("skylark-io-caches/cache",["skylark-langx/skylark"],function(t){return t.attach("storages.cache",{})}),define("skylark-io-caches/cookie",["skylark-langx/langx","./cache"],function(t,e){function n(){return n}return t.mixin(n,{get:function(t){return sKey&&this.has(t)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},has:function(t){return new RegExp("(?:^|;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},list:function(){for(var t=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),e=0;e<t.length;e++)t[e]=unescape(t[e]);return t},remove:function(t,e){t&&this.has(t)&&(document.cookie=escape(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(e?"; path="+e:""))},set:function(e,n,r,i,s,a){if(e&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(e)){var o=t.type(r);if("number"===o){var l=Date.now();l.setTime(l.getTime()+24*expire*60*60*1e3),r=l}else"string"===o&&(r=new Date(Date.now()+t.parseMilliSeconds(r)));document.cookie=escape(e)+"="+escape(n)+(r?"; domain="+r.toGMTString():"")+(s?"; domain="+s:"")+(i?"; path="+i:"")+(a?"; secure":"")}}}),e.cookie=n}),define("skylark-io-caches/LocalFileSystem",["skylark-langx/langx","./cache"],function(t,e){var n=t.Deferred,r=window.requestFileSystem||window.webkitRequestFileSystem;window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL,window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;function i(t){var e="";switch(t.code){case FileError.QUOTA_EXCEEDED_ERR:e="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:e="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:e="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:e="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:e="INVALID_STATE_ERR";break;default:e="Unknown Error"}return e}var s=t.Evented.inherit({_fs:null,_isPersisted:!0,_cwd:null,init:function(t){this._fs=t,this._cwd=t.root},readfileAsArrayBuffer:function(t,e,n){this._cwd.getFile(t,{},function(t){t.file(function(t){var n=new FileReader;n.onloadend=function(){e(null,this.result)},n.readAsArrayBuffer(t)},n)},n)},readfileAsDataURL:function(t,e,n){this._cwd.getFile(t,{},function(t){t.file(function(t){var n=new FileReader;n.onloadend=function(){e(null,this.result)},n.readAsDataURL(t)},n)},n)},readfileAsText:function(t,e,n){this._cwd.getFile(t,{},function(t){t.file(function(t){var n=new FileReader;n.onloadend=function(){e(null,this.result)},n.readAsText(t)},n)},n)},writefile:function(t,e,n,r){var i=this,s=t.split("/");s=s.slice(0,s.length-1),this.mkdir(s.join("/"),function(){i._cwd.getFile(t,{create:!0},function(t){t.createWriter(function(t){var i=!1;t.onwriteend=function(){if(!i)return i=!0,void this.truncate(this.position);n&&n()},t.onerror=r;var s=e;!s instanceof Blob&&(s=new Blob([e],{type:"text/plain"})),t.write(s)},r)},r)})},rmfile:function(t,e,n){this._cwd.getFile(t,{},function(t){t.remove(function(){e()},n)},n)},readdir:function(t,e,n){this._cwd.getDirectory(t,{},function(t){var r=t.createReader(),i=[];!function t(){r.readEntries(function(n){n.length?(i=i.concat(Array.prototype.slice.call(n).map(function(t){return t.name+(t.isDirectory?"/":"")})),t()):e(null,i)},n)}()},n)},mkdir:function(t,e,n){var r=t.split("/"),i=function(s,a){"."!=a[0]&&""!=a[0]||(a=a.slice(1)),0!=a.length?s.getDirectory(a[0],{create:!0,exclusive:!1},function(s){if(s.isDirectory)a.length&&1!=r.length?i(s,a.slice(1)):e&&e(s);else{var o=new Error(t+" is not a directory");if(!n)throw o;n(o)}},function(t){if(!n)throw t;n(t)}):e(s)};i(this._cwd,r)},rmdir:function(t,e,n){this._cwd.getDirectory(t,{},function(t){t.removeRecursively(function(){e()},n)},n)},copy:function(t,e,n){this._cwd.getFile(t,{},function(t){cwd.getDirectory(e,{},function(e){t.copyTo(e,function(){n()},n)},n)},n)},move:function(t,e,n){this._cwd.getFile(t,{},function(t){cwd.getDirectory(e,{},function(e){t.moveTo(e,function(){n()},n)},n)},n)},chdir:function(t,e){this._cwd.getDirectory(t,{},function(t){cwd=t,fs.onchdir&&fs.onchdir(cwd.fullPath),e()},e)},importFromHost:function(t){for(var e,r=new n,s=0;e=t[s];++s)!function(t){cwd.getFile(e.name,{create:!0,exclusive:!0},function(e){e.createWriter(function(e){e.write(t)},i)},i)}(e);return r.promise},exportToHost:function(){}});return t.mixin(s,{isSupported:function(){return!!r},request:function(t,e){t=t||10485760;var i=e?PERSISTENT:TEMPORARY,a=new n;return r(i,t,function(t){var n=new s(t,!!e);a.resolve(n)},function(t){a.reject(t)}),a.promise}}),e.requestLocalFileSystem=s.request,e.LocalFileSystem=s}),define("skylark-io-caches/localStorage",["skylark-langx/langx","./cache"],function(t,e){var n=null;try{n=window.localStorage}catch(t){}function r(){return r}return t.mixin(r,{isSupported:function(){return!!n},set:function(e,r){return void 0===r?this.remove(e):(n.setItem(e,t.serializeValue(r)),r)},get:function(e,r){var i=t.deserializeValue(n.getItem(e));return void 0===i?r:i},remove:function(t){n.removeItem(t)},clear:function(){n.clear()},list:function(){for(var t={},e=0;e<n.length;e++)t[key]=n.key(e);return values}}),e.localStorage=r}),define("skylark-io-caches/sessionStorage",["skylark-langx/langx","./cache"],function(t,e){var n=null;try{n=window.sessiionStorage}catch(t){}return t.mixin(function t(){return t},{isSupported:function(){return!!n},set:function(e,r){return void 0===r?this.remove(e):(n.setItem(e,t.serializeValue(r)),r)},get:function(e,r){var i=t.deserializeValue(n.getItem(e));return void 0===i?r:i},remove:function(t){n.removeItem(t)},clear:function(){n.clear()},list:function(){for(var t={},e=0;e<n.length;e++)t[key]=n.key(e);return values}}),e.sessionStorage=sessionStorage}),define("skylark-io-caches/main",["./cache","./cookie","./LocalFileSystem","./localStorage","./sessionStorage"],function(t){return t}),define("skylark-io-caches",["skylark-io-caches/main"],function(t){return t}),define("skylark-slax-runtime/caches",["./slax","skylark-io-caches"],function(t,e){return t.caches=e}),define("skylark-langx/main",["./skylark","./langx"],function(t){return t}),define("skylark-langx",["skylark-langx/main"],function(t){return t}),define("skylark-domx/browser",["skylark-domx-browser"],function(t){"use strict";return t}),define("skylark-domx-css/css",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder"],function(t,e,n){"use strict";var r,i=document.getElementsByTagName("head")[0],s=0,a={},o={},l=d(),u=o[l],c="cssRules"in u?"cssRules":"rules",h=u.deleteRule||u.removeRule;if(u.insertRule){var f=u.insertRule;r=function(t,e,n){f.call(this,t+"{"+e+"}",n)}}else r=u.addRule;function d(t,r){var a,l={type:"text/css"},u=s++;return(r=r||{}).media&&(l.media=r.media),a=t?n.create("link",e.mixin(l,{rel:"stylesheet",async:!1})):n.createElement("style",l),n.append(i,a),o[u]={id:u,node:a},u}function p(t,n){var r=o[t];return e.isNumber(n)?h.call(r,n):e.each(r[c],function(t,e){if(n===e)return h.call(r,t),!1}),this}function m(t,r){var i,s=o[t];return i=e.isString(r)?r:y(r),n.append(s.node,n.createTextNode(i)),this}function g(t){return t.startsWith("@")}function y(t){var n=function(t,e,n){return t&&(g(t)?n+=1:e=t+" "+e),{name:e,depth:n}},r=function(t,i,s){var a="",o=g(t);if(g(t))e.isString(i)?a=v.SPACE.repeat(s)+t.trim()+' "'+i.trim()+' ";\n':(a+=v.SPACE.repeat(s)+t.trim()+" {\n",a+=r("",i,s+1),a+=v.SPACE.repeat(s)+" }\n");else if(e.isString(i))a=v.SPACE.repeat(s)+t.trim(),a=o?a+' "'+i.trim()+' ";\n':a+": "+i.trim()+";\n";else if(e.isArray(i))for(var l=0;l<i.length;l++)a+=r(t,i[l],s);else{if(t){for(var l in a+=v.SPACE.repeat(s)+t.trim()+" {\n",i){var u=i[l];e.isString(u)&&(a+=r(l,u,s+1))}a+=v.SPACE.repeat(s)+"}\n"}for(var l in i){var u=i[l];if(!e.isString(u)){var c=n(t,l,s);a+=r(c.name,u,c.depth)}}}return a};return r("",t,0)}function v(){return v}return e.mixin(v,{SPACE:"\t",addRules:function(t){return this.addRules(l,t)},addSheetRules:m,createStyleSheet:function(t,e){e||(e={});var n=d(!1,e);t&&m(n,t);return n},deleteSheetRule:p,deleteRule:function(t){return p(l,t),this},insertRule:function(t,e,n){return this.insertSheetRule(l,t,e,n)},insertSheetRule:function(t,e,n,i){if(!e||!n)return-1;var s=o[t];return i=i||s[c].length,r.call(s,e,n,i)},loadStyleSheet:function(t,n,r,i){e.isFunction(n)&&(i=r,r=n,n={});var s=a[t];if(!s){var l=d(!0,n);s=a[t]=o[l],e.mixin(s,{state:0,url:t,deferred:new e.Deferred});var u=s.node;startTime=(new Date).getTime(),u.onload=function(){s.state=1,s.deferred.resolve(s.id)},u.onerror=function(t){s.state=-1,s.deferred.reject(t)},u.href=s.url}(r||i)&&s.deferred.promise.then(r,i);return s.id},removeStyleSheet:function(t){if(t===l)throw new Error("The default stylesheet can not be deleted");var e=o[t];return delete o[t],n.remove(e.node),this},toString:y}),t.attach("domx.css",v)}),define("skylark-domx-css/main",["./css"],function(t){return t}),define("skylark-domx-css",["skylark-domx-css/main"],function(t){return t}),define("skylark-domx/css",["skylark-domx-css"],function(t){"use strict";return t}),define("skylark-domx/data",["skylark-domx-data"],function(t){return t}),define("skylark-domx/eventer",["skylark-domx-eventer"],function(t){return t}),define("skylark-domx/finder",["skylark-domx-finder"],function(t){return t}),define("skylark-domx-geom/geom",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-styler"],function(t,e,n,r){var i,s=/^(?:body|html)$/i,a=e.toPixel,o=n.offsetParent;function l(){if(void 0!==i)return i;var t,e,s=n.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],a=s.childNodes[0];return n.append(document.body,s),t=a.offsetWidth,r.css(s,"overflow","scroll"),e=a.offsetWidth,t===e&&(e=s[0].clientWidth),n.remove(s),i=t-e}function u(t){if(n.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:a(e.borderLeftWidth,t),top:a(e.borderTopWidth,t),right:a(e.borderRightWidth,t),bottom:a(e.borderBottomWidth,t)}}function c(t,e){if(void 0===e)return s.test(t.nodeName)?{top:0,left:0}:t.getBoundingClientRect();var n=o(t),r=c(n),i=p(t),a=u(n);return v(t,{top:e.top-r.top-i.top-a.top,left:e.left-r.left-i.left-a.left}),this}function h(t,e){return void 0!==e?(c(t,e),_(t,e),this):t==window||t==document.documentElement||t==document.body?{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth,height:window.innerHeight,width:window.innerWidth}:t.getBoundingClientRect?t.getBoundingClientRect():void 0}function f(t,e){if(void 0==e)return{width:t.clientWidth,height:t.clientHeight};var n="border-box"===r.css(t,"box-sizing"),i={width:e.width,height:e.height};if(n){var s=u(t);void 0!==i.width&&(i.width=i.width+s.left+s.right),void 0!==i.height&&(i.height=i.height+s.top+s.bottom)}else{var a=g(t);void 0!==i.width&&(i.width=i.width-a.left-a.right),void 0!==i.height&&(i.height=i.height-a.top-a.bottom)}return r.css(t,i),this}function d(t){var e=t.documentElement,n=t.body,r=Math.max,i=r(e.scrollWidth,n.scrollWidth),s=r(e.clientWidth,n.clientWidth),a=r(e.offsetWidth,n.offsetWidth),o=r(e.scrollHeight,n.scrollHeight),l=r(e.clientHeight,n.clientHeight),u=r(e.offsetHeight,n.offsetHeight);return{width:i<a?s:i,height:o<u?l:o}}function p(t){if(n.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:a(e.marginLeft),top:a(e.marginTop),right:a(e.marginRight),bottom:a(e.marginBottom)}}function m(t){var e=_(t),n=p(t);return{width:e.width+n.left+n.right,height:e.height+n.top+n.bottom}}function g(t){if(n.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:a(e.paddingLeft),top:a(e.paddingTop),right:a(e.paddingRight),bottom:a(e.paddingBottom)}}function y(t,e){if(void 0===e){var n=t.getBoundingClientRect(),r=t.ownerDocument.defaultView;return{left:n.left+r.pageXOffset,top:n.top+r.pageYOffset}}var i=o(t),s=y(i),a=p(t),l=u(i);return v(t,{top:e.top-s.top-a.top-l.top,left:e.left-s.left-a.left-l.left}),this}function v(t,e){if(void 0==e){var n=o(t),i=c(t),s=c(n),a=(p(t),u(n));return{top:i.top-s.top-a.top,left:i.left-s.left-a.left}}var l={top:e.top,left:e.left};return"static"==r.css(t,"position")&&(l.position="relative"),r.css(t,l),this}function x(t,e){if(void 0===e){var n=o(t),r=h(t),i=c(n),s=(p(t),u(n));return{top:r.top-i.top-s.top,left:r.left-i.left-s.left,width:r.width,height:r.height}}return v(t,e),_(t,e),this}function k(t,e){9===t.nodeType&&(t=t.defaultView);var n="scrollLeft"in t;return void 0===e?n?t.scrollLeft:t.pageXOffset:(n?t.scrollLeft=e:t.scrollTo(e,t.scrollY),this)}function b(t,e){9===t.nodeType&&(t=t.defaultView);var n="scrollTop"in t;return void 0===e?n?t.scrollTop:t.pageYOffset:(n?t.scrollTop=e:t.scrollTo(t.scrollX,e),this)}function _(t,n){if(void 0==n)return e.isWindow(t)?{width:t.innerWidth,height:t.innerHeight}:e.isDocument(t)?d(document):{width:t.offsetWidth,height:t.offsetHeight};var i="border-box"===r.css(t,"box-sizing"),s={width:n.width,height:n.height};if(!i){var a=g(t),o=u(t);void 0!==s.width&&""!==s.width&&null!==s.width&&(s.width=s.width-a.left-a.right-o.left-o.right),void 0!==s.height&&""!==s.height&&null!==s.height&&(s.height=s.height-a.top-a.bottom-o.top-o.bottom)}return r.css(t,s),this}function w(){return w}return e.mixin(w,{borderExtents:u,boundingPosition:c,boundingRect:h,clientHeight:function(t,e){return void 0==e?f(t).height:f(t,{height:e})},clientSize:f,clientWidth:function(t,e){return void 0==e?f(t).width:(f(t,{width:e}),this)},contentRect:function(t){var e=f(t),n=g(t);return{left:n.left,top:n.top,width:e.width-n.left-n.right,height:e.height-n.top-n.bottom}},getDocumentSize:d,height:function(t,e){return void 0==e?_(t).height:(_(t,{height:e}),this)},marginExtents:p,marginRect:function(t){var e=x(t),n=p(t);return{left:e.left,top:e.top,width:e.width+n.left+n.right,height:e.height+n.top+n.bottom}},marginSize:m,offsetParent:o,paddingExtents:g,pagePosition:y,pageRect:function(t,e){if(void 0===e){var n=t.getBoundingClientRect(),r=t.ownerDocument.defaultView;return{left:n.left+r.pageXOffset,top:n.top+r.pageYOffset,width:Math.round(n.width),height:Math.round(n.height)}}return y(t,e),_(t,e),this},relativePosition:v,relativeRect:x,scrollbarWidth:l,scrollIntoView:function(t,e){var n,r,i,s,a,o,l=t.parentNode,u=function(t,e){var n,r,i=t;n=r=0;for(;i&&i!=e&&i.nodeType;)n+=i.offsetLeft||0,r+=i.offsetTop||0,i=i.offsetParent;return{x:n,y:r}}(t,l);n=u.x,r=u.y,i=t.offsetWidth,s=t.offsetHeight,a=l.clientWidth,o=l.clientHeight,"end"==e?(n-=a-i,r-=o-s):"center"==e&&(n-=a/2-i/2,r-=o/2-s/2);return l.scrollLeft=n,l.scrollTop=r,this},scrollLeft:k,scrollTop:b,scrollBy:function(t,e,n){t.scrollLeft+=e,t.scrollTop+=n},size:_,testAxis:function(t){var e=t.offsetTop,n=t.offsetLeft,r=t.offsetWidth,i=t.offsetHeight;for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;var s={x:0,y:0};e<window.pageYOffset?s.y=e-window.pageYOffset:e+i>window.pageYOffset+window.innerHeight&&(s.y=e+i-(window.pageYOffset+window.innerHeight));n<window.pageXOffset?s.x=n-window.pageXOffset:n+r>window.pageXOffset+window.innerWidth&&(s.x=n+r-(window.pageXOffset+window.innerWidth));return s},width:function(t,e){return void 0==e?_(t).width:(_(t,{width:e}),this)}}),function(){var t=Math.max,i=Math.abs,s=/left|center|right/,a=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,c=/%$/;function h(t,e,n){return[parseFloat(t[0])*(c.test(t[0])?e/100:1),parseFloat(t[1])*(c.test(t[1])?n/100:1)]}function f(t,e){return parseInt(r.css(t,e),10)||0}var d={fit:{left:function(e,n){var r,i=n.within,s=i.isWindow?i.scrollLeft:i.offset.left,a=i.width,o=e.left-n.collisionPosition.marginLeft,l=s-o,u=o+n.collisionWidth-a-s;n.collisionWidth>a?l>0&&u<=0?(r=e.left+l+n.collisionWidth-a-s,e.left+=l-r):e.left=u>0&&l<=0?s:l>u?s+a-n.collisionWidth:s:l>0?e.left+=l:u>0?e.left-=u:e.left=t(e.left-o,e.left)},top:function(e,n){var r,i=n.within,s=i.isWindow?i.scrollTop:i.offset.top,a=n.within.height,o=e.top-n.collisionPosition.marginTop,l=s-o,u=o+n.collisionHeight-a-s;n.collisionHeight>a?l>0&&u<=0?(r=e.top+l+n.collisionHeight-a-s,e.top+=l-r):e.top=u>0&&l<=0?s:l>u?s+a-n.collisionHeight:s:l>0?e.top+=l:u>0?e.top-=u:e.top=t(e.top-o,e.top)}},flip:{left:function(t,e){var n,r,s=e.within,a=s.offset.left+s.scrollLeft,o=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,u=t.left-e.collisionPosition.marginLeft,c=u-l,h=u+e.collisionWidth-o-l,f="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,d="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,p=-2*e.offset[0];c<0?((n=t.left+f+d+p+e.collisionWidth-o-a)<0||n<i(c))&&(t.left+=f+d+p):h>0&&((r=t.left-e.collisionPosition.marginLeft+f+d+p-l)>0||i(r)<h)&&(t.left+=f+d+p)},top:function(t,e){var n,r,s=e.within,a=s.offset.top+s.scrollTop,o=s.height,l=s.isWindow?s.scrollTop:s.offset.top,u=t.top-e.collisionPosition.marginTop,c=u-l,h=u+e.collisionHeight-o-l,f="top"===e.my[1],d=f?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];c<0?((r=t.top+d+p+m+e.collisionHeight-o-a)<0||r<i(c))&&(t.top+=d+p+m):h>0&&((n=t.top-e.collisionPosition.marginTop+d+p+m-l)>0||i(n)<h)&&(t.top+=d+p+m)}},flipfit:{left:function(){d.flip.left.apply(this,arguments),d.fit.left.apply(this,arguments)},top:function(){d.flip.top.apply(this,arguments),d.fit.top.apply(this,arguments)}}};w.posit=function(c,p){var g,v,x,w,C,S,M=(p=e.extend({},p)).of,E=(O=p.within,P=O||window,I=n.isWindow(P),N=!!P&&9===P.nodeType,F=!I&&!N,j=m(P),{element:P,isWindow:I,isDocument:N,offset:F?y(O):{left:0,top:0},scrollLeft:k(P),scrollTop:b(P),width:j.width,height:j.height}),A=function(t){var e=t.isWindow||t.isDocument?"":r.css(t.element,"overflow-x"),n=t.isWindow||t.isDocument?"":r.css(t.element,"overflow-y"),i="scroll"===e||"auto"===e&&t.width<scrollWidth(t.element);return{width:"scroll"===n||"auto"===n&&t.height<scrollHeight(t.element)?l():0,height:i?l():0}}(E),z=(p.collision||"flip").split(" "),T={};var O,P,I,N,F,j;L=M,S=9===L.nodeType?{size:_(L),offset:{top:0,left:0}}:n.isWindow(L)?{size:_(L),offset:{top:b(L),left:k(L)}}:L.preventDefault?{size:{width:0,height:0},offset:{top:L.pageY,left:L.pageX}}:{size:_(L),offset:y(L)},M.preventDefault&&(p.at="left top");var L;v=S.size.width,x=S.size.height,w=S.offset,C=e.extend({},w),e.each(["my","at"],function(){var t,e,n=(p[this]||"").split(" ");1===n.length&&(n=s.test(n[0])?n.concat(["center"]):a.test(n[0])?["center"].concat(n):["center","center"]),n[0]=s.test(n[0])?n[0]:"center",n[1]=a.test(n[1])?n[1]:"center",t=o.exec(n[0]),e=o.exec(n[1]),T[this]=[t?t[0]:0,e?e[0]:0],p[this]=[u.exec(n[0])[0],u.exec(n[1])[0]]}),1===z.length&&(z[1]=z[0]);"right"===p.at[0]?C.left+=v:"center"===p.at[0]&&(C.left+=v/2);"bottom"===p.at[1]?C.top+=x:"center"===p.at[1]&&(C.top+=x/2);return g=h(T.at,v,x),C.left+=g[0],C.top+=g[1],function(n){var r,s,a=m(n),o=a.width,l=a.height,u=f(n,"marginLeft"),c=f(n,"marginTop"),k=o+u+f(n,"marginRight")+A.width,b=l+c+f(n,"marginBottom")+A.height,_=e.extend({},C),S=h(T.my,a.width,a.height);"right"===p.my[0]?_.left-=o:"center"===p.my[0]&&(_.left-=o/2),"bottom"===p.my[1]?_.top-=l:"center"===p.my[1]&&(_.top-=l/2),_.left+=S[0],_.top+=S[1],r={marginLeft:u,marginTop:c},e.each(["left","top"],function(t,e){d[z[t]]&&d[z[t]][e](_,{targetWidth:v,targetHeight:x,elemWidth:o,elemHeight:l,collisionPosition:r,collisionWidth:k,collisionHeight:b,offset:[g[0]+S[0],g[1]+S[1]],my:p.my,at:p.at,within:E,elem:n})}),p.using&&(s=function(e){var r=w.left-_.left,s=r+v-o,a=w.top-_.top,u=a+x-l,c={target:{element:M,left:w.left,top:w.top,width:v,height:x},element:{element:n,left:_.left,top:_.top,width:o,height:l},horizontal:s<0?"left":r>0?"right":"center",vertical:u<0?"top":a>0?"bottom":"middle"};v<o&&i(r+s)<v&&(c.horizontal="center"),x<l&&i(a+u)<x&&(c.vertical="middle"),t(i(r),i(s))>t(i(a),i(u))?c.important="horizontal":c.important="vertical",p.using.call(this,e,c)}),y(n,e.extend(_,{using:s}))}(c)}}(),t.attach("domx.geom",w)}),define("skylark-domx-geom/main",["skylark-langx/langx","./geom","skylark-domx-velm","skylark-domx-query"],function(t,e,n,r){return n.delegate(["borderExtents","boundingPosition","boundingRect","clientHeight","clientSize","clientWidth","contentRect","height","marginExtents","offsetParent","paddingExtents","pagePosition","pageRect","relativePosition","relativeRect","scrollIntoView","scrollLeft","scrollTop","size","width"],e),r.fn.offset=r.wraps.wrapper_value(e.pagePosition,e,e.pagePosition),r.fn.scrollTop=r.wraps.wrapper_value(e.scrollTop,e),r.fn.scrollLeft=r.wraps.wrapper_value(e.scrollLeft,e),r.fn.position=function(n){if(!this.length)return this;if(n)return n.of&&n.of.length&&((n=t.clone(n)).of=n.of[0]),this.each(function(){e.posit(this,n)});var r=this[0];return e.relativePosition(r)},r.fn.offsetParent=r.wraps.wrapper_map(e.offsetParent,e),r.fn.size=r.wraps.wrapper_value(e.size,e),r.fn.width=r.wraps.wrapper_value(e.width,e,e.width),r.fn.height=r.wraps.wrapper_value(e.height,e,e.height),r.fn.clientSize=r.wraps.wrapper_value(e.clientSize,e.clientSize),["width","height"].forEach(function(t){var n=t.replace(/./,function(t){return t[0].toUpperCase()});r.fn["outer"+n]=function(n,r){if(arguments.length?"boolean"!=typeof n&&(r=n,n=!1):(n=!1,r=void 0),void 0===r){var i=this[0];if(!i)return;var s=e.size(i);if(n){var a=e.marginExtents(i);s.width=s.width+a.left+a.right,s.height=s.height+a.top+a.bottom}return"width"===t?s.width:s.height}return this.each(function(i,s){var a={},o=e.marginExtents(s);"width"===t?(a.width=r,n&&(a.width=a.width-o.left-o.right)):(a.height=r,n&&(a.height=a.height-o.top-o.bottom)),e.size(s,a)})}}),r.fn.innerWidth=r.wraps.wrapper_value(e.clientWidth,e,e.clientWidth),r.fn.innerHeight=r.wraps.wrapper_value(e.clientHeight,e,e.clientHeight),e}),define("skylark-domx-geom",["skylark-domx-geom/main"],function(t){return t}),define("skylark-domx-fx/fx",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-geom","skylark-domx-styler","skylark-domx-eventer"],function(t,e,n,r,i,s,a){var o,l,u,c,h,f,d,p=n.normalizeCssEvent("AnimationEnd"),m=n.normalizeCssEvent("TransitionEnd"),g=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,y=n.css3PropPrefix+"transform",v={};function x(t,n,r,x,k,b){var w,C,S,M={},E=[],z="",T=this,O=!1,P=!1;if(e.isPlainObject(r)&&(x=r.easing,k=r.complete,b=r.delay,r=r.duration),e.isString(r)&&(r=A.speeds[r]),void 0===r&&(r=A.speeds.normal),r/=1e3,A.off&&(r=0),e.isFunction(x)?(k=x,eace="swing"):x=x||"swing",b?b/=1e3:b=0,e.isString(n))M[o]=n,M[l]=r+"s",M[u]=x,C=p;else{for(w in n){var I=n[w];if(g.test(w))z+=w+"("+I+") ";else{if("scrollTop"===w&&(P=!0),"clip"==w&&e.isPlainObject(I)){if(M[w]="rect("+I.top+"px,"+I.right+"px,"+I.bottom+"px,"+I.left+"px)","auto"==s.css(t,"clip")){var N=i.size(t);s.css(t,"clip","rect(0px,"+N.width+"px,"+N.height+"px,0px)"),!0}}else M[w]=I;E.push(e.dasherize(w))}}C=m}return z&&(M[y]=z,E.push(y)),r>0&&e.isPlainObject(n)&&(M[c]=E.join(", "),M[h]=r+"s",M[d]=b+"s",M[f]=x),S=function(e){if(O=!0,e){if(e.target!==e.currentTarget)return;a.off(e.target,C,S)}else a.off(t,p,S);s.css(t,v),k&&k.call(this)},r>0&&(a.on(t,C,S),e.debounce(function(){O||S.call(T)},1e3*(r+b)+25)()),t.clientLeft,s.css(t,M),r<=0&&e.debounce(function(){O||S.call(T)},0)(),P&&_(t,n.scrollTop,r,k),this}function k(t,n,r){return s.show(t),n&&(!r&&e.isFunction(n)&&(r=n,n="normal"),s.css(t,"opacity",0),x(t,{opacity:1,scale:"1,1"},n,r)),this}function b(t,n,r){return n?(!r&&e.isFunction(n)&&(r=n,n="normal"),x(t,{opacity:0,scale:"0,0"},n,function(){s.hide(t),r&&r.call(t)})):s.hide(t),this}function _(t,n,r,i){var s=parseInt(t.scrollTop),a=0,o=1e3*r/5,l=parseInt(n),u=setInterval(function(){++a<=o&&(t.scrollTop=(l-s)/o*a+s),a>=o+1&&(clearInterval(u),i&&e.debounce(i,1e3)())},5)}function w(t,e,n,r,i){return x(t,{opacity:n},e,r,i),this}function C(t,e,n,r){var i=s.css(t,"opacity");return i>0?s.css(t,"opacity",0):i=1,s.show(t),w(t,e,i,n,r),this}function S(t,n,r,i){var a,o=s.css(t,"opacity"),l={};return e.isPlainObject(n)?(l.easing=n.easing,l.duration=n.duration,a=n.complete):(l.duration=n,i?(a=i,l.easing=r):a=r),l.complete=function(){s.css(t,"opacity",o),s.hide(t),a&&a.call(t)},w(t,l,0),this}function M(t,e,n){var r=s.css(t,"position");k(t),s.css(t,{position:"absolute",visibility:"hidden"});var i=s.css(t,"margin-top"),a=s.css(t,"margin-bottom"),o=s.css(t,"padding-top"),l=s.css(t,"padding-bottom"),u=s.css(t,"height");return s.css(t,{position:r,visibility:"visible",overflow:"hidden",height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0}),x(t,{height:u,marginTop:i,marginBottom:a,paddingTop:o,paddingBottom:l},{duration:e,complete:function(){n&&n.apply(t)}}),this}function E(t,e,n){if(i.height(t)>0){s.css(t,"position");var r=s.css(t,"height"),a=s.css(t,"margin-top"),o=s.css(t,"margin-bottom"),l=s.css(t,"padding-top"),u=s.css(t,"padding-bottom");s.css(t,{visibility:"visible",overflow:"hidden",height:r,marginTop:a,marginBottom:o,paddingTop:l,paddingBottom:u}),x(t,{height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},{duration:e,queue:!1,complete:function(){b(t),s.css(t,{visibility:"visible",overflow:"hidden",height:r,marginTop:a,marginBottom:o,paddingTop:l,paddingBottom:u}),n&&n.apply(t)}})}return this}function A(){return A}return v[o=n.normalizeCssProperty("animation-name")]=v[l=n.normalizeCssProperty("animation-duration")]=v[n.normalizeCssProperty("animation-delay")]=v[u=n.normalizeCssProperty("animation-timing-function")]="",v[c=n.normalizeCssProperty("transition-property")]=v[h=n.normalizeCssProperty("transition-duration")]=v[d=n.normalizeCssProperty("transition-delay")]=v[f=n.normalizeCssProperty("transition-timing-function")]="",e.mixin(A,{off:!1,speeds:{normal:400,fast:200,slow:600},animate:x,emulateTransitionEnd:function(t,e){var r=!1;a.one(t,"transitionEnd",function(){r=!0});return setTimeout(function(){r||a.trigger(t,n.support.transition.end)},e),this},fadeIn:C,fadeOut:S,fadeTo:w,fadeToggle:function(t,e,n,r){s.isInvisible(t)?C(t,e,easing,callback):S(t,e,easing,callback);return this},hide:b,scrollToTop:_,slideDown:M,slideToggle:function(t,e,n){0==i.height(t)?M(t,e,n):E(t,e,n);return this},slideUp:E,show:k,throb:function(t,e){var n,i=(e=e||{}).text,a=(e.style,e.time),o=e.callback,l=r.createElement("div",{class:e.className||"throbber"}),u=(function(t,e){var n=r.createElement("div",e);s.css(n,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2147483647,opacity:.7}),t.appendChild(n)}(l,{class:"overlay fade"}),r.createElement("div",{class:"throb"})),c=r.createTextNode(i||""),h=function(){n&&(clearTimeout(n),n=null),l&&(r.remove(l),l=null)};e.style&&s.css(l,e.style);u.appendChild(c),l.appendChild(u),t.appendChild(l),a&&(n=setTimeout(function(){h(),o&&o()},a));return{remove:h,update:function(t){t&&t.text&&l&&(c.nodeValue=t.text)}}},toggle:function(t,e,n){s.isInvisible(t)?k(t,e,n):b(t,e,n);return this}}),t.attach("domx.fx",A)}),define("skylark-domx-fx/main",["./fx","skylark-domx-velm","skylark-domx-query"],function(t,e,n){return e.delegate(["animate","emulateTransitionEnd","fadeIn","fadeOut","fadeTo","fadeToggle","hide","scrollToTop","slideDown","slideToggle","slideUp","show","toggle"],t),n.fn.hide=n.wraps.wrapper_every_act(t.hide,t),n.fn.animate=n.wraps.wrapper_every_act(t.animate,t),n.fn.emulateTransitionEnd=n.wraps.wrapper_every_act(t.emulateTransitionEnd,t),n.fn.show=n.wraps.wrapper_every_act(t.show,t),n.fn.hide=n.wraps.wrapper_every_act(t.hide,t),n.fn.toogle=n.wraps.wrapper_every_act(t.toogle,t),n.fn.fadeTo=n.wraps.wrapper_every_act(t.fadeTo,t),n.fn.fadeIn=n.wraps.wrapper_every_act(t.fadeIn,t),n.fn.fadeOut=n.wraps.wrapper_every_act(t.fadeOut,t),n.fn.fadeToggle=n.wraps.wrapper_every_act(t.fadeToggle,t),n.fn.slideDown=n.wraps.wrapper_every_act(t.slideDown,t),n.fn.slideToggle=n.wraps.wrapper_every_act(t.slideToggle,t),n.fn.slideUp=n.wraps.wrapper_every_act(t.slideUp,t),t}),define("skylark-domx-fx",["skylark-domx-fx/main"],function(t){return t}),define("skylark-domx/fx",["skylark-domx-fx"],function(t){return t}),define("skylark-domx/geom",["skylark-domx-geom"],function(t){return t}),define("skylark-domx/noder",["skylark-domx-noder"],function(t){return t}),define("skylark-domx-plugins/plugins",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects","skylark-langx-funcs","skylark-langx-events/Emitter","skylark-domx-noder","skylark-domx-data","skylark-domx-eventer","skylark-domx-finder","skylark-domx-geom","skylark-domx-styler","skylark-domx-fx","skylark-domx-query","skylark-domx-velm"],function(t,e,n,r,i,s,a,o,l,u,c,h,f,d){"use strict";var p=Array.prototype.slice,m=(Array.prototype.concat,{}),g={};function y(t,e,n){var r=e.split(":"),i=r[1];e=r[0],i||(i=e);var s=a.data(t,i);if("instance"===n)return s;if("destroy"===n){if(!s)throw new Error("The plugin instance is not existed");s.destroy(),s=void 0}else if(s)n&&s.reset(n);else{if(void 0!==n&&"object"!=typeof n)throw new Error("The options must be a plain object");var o=m[e];s=new o(t,n),a.data(t,i,s)}return s}var v=i.inherit({klassName:"Plugin",_construct:function(t,e){this._elm=t,this._initOptions(e)},_initOptions:function(t){var e=this.constructor,r=e.cache=e.cache||{},i=r.defaults;if(!i){var s=[];do{if(s.unshift(e),e===v)break;e=e.superclass}while(e);i=r.defaults={};for(var a=0;a<s.length;a++)(e=s[a]).prototype.hasOwnProperty("options")&&n.mixin(i,e.prototype.options,!0),e.hasOwnProperty("options")&&n.mixin(i,e.options,!0)}return Object.defineProperty(this,"options",{value:n.mixin({},i,t,!0)}),this.options},destroy:function(){this._destroy(),this.unlistenTo(),a.removeData(this._elm,this.pluginName)},_destroy:r.noop,_delay:function(t,e){var n=this;return setTimeout(function(){return("string"==typeof t?n[t]:t).apply(n,arguments)},e||0)},elmx:function(t){return t=t||this._elm,d(t)},$:function(t){return t=t||this._elm,f(t)},option:function(t,e){var r,i,s,a=t;if(0===arguments.length)return n.mixin({},this.options);if("string"==typeof t)if(a={},r=t.split("."),t=r.shift(),r.length){for(i=a[t]=n.mixin({},this.options[t]),s=0;s<r.length-1;s++)i[r[s]]=i[r[s]]||{},i=i[r[s]];if(t=r.pop(),1===arguments.length)return void 0===i[t]?null:i[t];i[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=e}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,this},getUID:function(t){t=t||"plugin";do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},elm:function(){return this._elm}});function x(){return x}return v.instantiate=function(t,e){return y(t,this.prototype.pluginName,e)},f.fn.plugin=function(t,e){var n,r=p.call(arguments,1),i=this;return this.each(function(){n=y.apply(i,[this,t].concat(r))}),n},d.partial("plugin",function(t,e){var n=p.call(arguments,1);return y.apply(this,[this._elm,t].concat(n))}),n.mixin(x,{instantiate:y,Plugin:v,register:function(t,n,r,i){var s=t.prototype.pluginName;if(m[s]=t,n){r&&e.isFunction(r)&&(i=r,r=null),r&&(s=s+":"+r);var a=g[n]=function(t,n){return function(r,i){var s=y(r,t,"instance");if("instance"===i)return s||null;if(!s&&(s=y(r,t,"object"==typeof i&&i||{}),"string"!=typeof i))return this;if(i){var a=p.call(arguments,1);if(n)return n.apply(s,a);if("string"==typeof i){var o=i;if(!s)throw new Error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'");if(!e.isFunction(s[o])||"_"===o.charAt(0))throw new Error("no such method '"+o+"' for "+t+" plugin instance");a=p.call(a,1);var l=s[o].apply(s,a);return l==s&&(l=void 0),l}}}}(s,i);f.fn[n]=function(t){var e=this;if(this.length||"instance"!==t){var n=p.call(arguments);this.each(function(){var t=p.call(n);t.unshift(this);var r=a.apply(void 0,t);void 0!==r&&(e=r)})}else e=void 0;return e},d.partial(n,function(t){var e=a(this._elm,t);return void 0===e&&(e=this),e})}},shortcuts:g}),t.attach("domx.plugins",x)}),define("skylark-domx-plugins/main",["./plugins"],function(t){return t}),define("skylark-domx-plugins",["skylark-domx-plugins/main"],function(t){return t}),define("skylark-domx/plugins",["skylark-domx-plugins"],function(t){"use strict";return t}),define("skylark-domx/styler",["skylark-domx-styler"],function(t){return t}),define("skylark-domx/query",["skylark-domx-query","./data","./eventer","./fx","./geom","./styler"],function(t){return t}),define("skylark-domx-scripter/scripter",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder"],function(t,e,n,r){var i=document.getElementsByTagName("head")[0],s={},a={},o=0,l=/^$|^module$|\/(?:java|ecma)script/i;function u(){return u}var c={type:!0,src:!0,nonce:!0,noModule:!0};function h(t,e,n){var r,i,s=(n=n||document).createElement("script");if(s.text=t,e)for(r in c)(i=e[r]||e.getAttribute&&e.getAttribute(r))&&s.setAttribute(r,i);return n.head.appendChild(s).parentNode.removeChild(s),this}return e.mixin(u,{loadJavaScript:function(t,e,n){var r=s[t];if(r||(r=s[t]={state:0,loadedCallbacks:[],errorCallbacks:[]}),r.loadedCallbacks.push(e),r.errorCallbacks.push(n),1===r.state)r.node.onload();else if(-1===r.state)r.node.onerror();else{var l=r.node=document.createElement("script"),u=r.id=o++;l.type="text/javascript",l.async=!1,l.defer=!1,startTime=(new Date).getTime(),i.appendChild(l),l.onload=function(){r.state=1;for(var t=r.loadedCallbacks,e=t.length;e--;)t[e]();r.loadedCallbacks=[],r.errorCallbacks=[]},l.onerror=function(){r.state=-1;for(var t=r.errorCallbacks,e=t.length;e--;)t[e]();r.loadedCallbacks=[],r.errorCallbacks=[]},l.src=t,a[u]=l}return r.id},deleteJavaScript:function(t){var e=a[t];if(e){var r=e.src;n.remove(e),delete a[t],delete s[r]}},evaluate:h,html:function(t,e){var r=n.html(t,e);if(void 0!==e){for(var i=t.querySelectorAll("script"),s=0;s<i.length;s++){var a=i[s];l.test(a.type||"")&&h(a.textContent,a)}return this}return r}}),t.attach("domx.scripter",u)}),define("skylark-domx-scripter/main",["./scripter","skylark-domx-query"],function(t,e){return e.fn.html=e.wraps.wrapper_value(t.html,t,t.html),t}),define("skylark-domx-scripter",["skylark-domx-scripter/main"],function(t){return t}),define("skylark-domx/scripter",["skylark-domx-scripter"],function(t){return t}),define("skylark-domx-transforms/transforms",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-data","skylark-domx-styler"],function(t,e,n,r,i){var s=n.normalizeCssProperty("transform");function a(t,e){return t>0&&t>-e?e:t<0&&t<e?-e:0}function o(t,e){var n,r,a,o,l,u=(n=e.radian,r=e.y,a=e.x,o=Math.cos(n),l=Math.sin(n),{M11:o*r,M12:-l*a,M21:l*r,M22:o*a});i.css(t,s,"matrix("+u.M11.toFixed(16)+","+u.M21.toFixed(16)+","+u.M12.toFixed(16)+","+u.M22.toFixed(16)+", 0, 0)")}function l(t,e){if(!e)return(e=r.data(t,"transform")||{}).radian=e.radian||0,e.x=e.x||1,e.y=e.y||1,e.zoom=e.zoom||1,e;r.data(t,"transform",e)}var u={vertical:function(t){t.radian=Math.PI-t.radian,t.y*=-1},horizontal:function(t){t.radian=Math.PI-t.radian,t.x*=-1},rotate:function(t,e){t.radian=e*Math.PI/180},left:function(t){t.radian-=Math.PI/2},right:function(t){t.radian+=Math.PI/2},scale:function(t,e){var n=a(t.y,e),r=a(t.x,e);n&&r&&(t.y+=n,t.x+=r)},zoomin:function(t){u.scale(t,.1)},zoomout:function(t){u.scale(t,-.1)}};function c(){return c}return["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout"].forEach(function(t){var n;c[t]=(n=u[t],function(){var t=e.makeArray(arguments),r=t.shift(),i=l(r);t.unshift(i),n.apply(this,t),o(r,i),l(r,i)})}),e.mixin(c,{reset:function(t){var e={x:1,y:1,radian:0};o(t,e),l(t,e)},matrix:function(t){var e="";do{var n=i.css(t,"transform");n&&"none"!==n&&(e=n+" "+e)}while(t=t.parentElement);if(window.DOMMatrix)return new DOMMatrix(e);if(window.WebKitCSSMatrix)return new WebKitCSSMatrix(e);if(window.CSSMatrix)return new CSSMatrix(e)}}),t.attach("domx.transforms",c)}),define("skylark-domx-transforms/main",["./transforms"],function(t){return t}),define("skylark-domx-transforms",["skylark-domx-transforms/main"],function(t){return t}),define("skylark-domx/transforms",["skylark-domx-transforms"],function(t){return t}),define("skylark-domx/velm",["skylark-domx-velm","./data","./eventer","./fx","./geom","./styler"],function(t){return t}),define("skylark-domx/main",["./browser","./css","./data","./eventer","./finder","./fx","./geom","./noder","./plugins","./query","./scripter","./styler","./transforms","./velm"],function(t,e,n,r,i,s,a,o,l,u,c,h,f,d){return{browser:t,css:e,data:n,eventer:r,finder:i,geom:a,noder:o,plugins:l,query:u,scripter:c,styler:h,transforms:f,velm:d}}),define("skylark-domx",["skylark-domx/main"],function(t){return t}),define("skylark-domx-files/files",["skylark-langx/skylark"],function(t){var e=function(){return e};return t.attach("domx.files",e)}),define("skylark-io-diskfs/diskfs",["skylark-langx/skylark"],function(t){var e=function(){return e};return t.attach("storages.diskfs",e)}),define("skylark-io-diskfs/webentry",["skylark-langx/arrays","skylark-langx/Deferred","./diskfs"],function(t,e,n){var r=Array.prototype.concat,i=function(){function n(t,n){var r=new e,s=function(t){r.reject(t)};if(n=n||"",t.isFile)t.file(function(t){t.relativePath=n,r.resolve(t)},s);else if(t.isDirectory){var a=t.createReader();a.readEntries(function(e){i(e,n+t.name+"/").then(function(t){r.resolve(t)}).catch(s)},s)}else r.resolve([]);return r.promise}function i(i,s){return e.all(t.map(i,function(t){return n(t,s)})).then(function(){return r.apply([],arguments)})}return{one:n,all:i}}();return n.webentry=i}),define("skylark-domx-files/dropzone",["skylark-langx/arrays","skylark-langx/Deferred","skylark-domx-styler","skylark-domx-eventer","skylark-domx-velm","skylark-domx-query","skylark-io-diskfs/webentry","./files"],function(t,e,n,r,i,s,a,o){function l(e,i){var s=(i=i||{}).hoverClass||"dropzone",o=i.dropped,l=0;return r.on(e,"dragenter",function(t){t.dataTransfer&&t.dataTransfer.types.indexOf("Files")>-1&&(r.stop(t),l++,n.addClass(e,s))}),r.on(e,"dragover",function(t){t.dataTransfer&&t.dataTransfer.types.indexOf("Files")>-1&&r.stop(t)}),r.on(e,"dragleave",function(t){t.dataTransfer&&t.dataTransfer.types.indexOf("Files")>-1&&0==--l&&n.removeClass(e,s)}),r.on(e,"drop",function(i){if(i.dataTransfer&&i.dataTransfer.types.indexOf("Files")>-1&&(n.removeClass(e,s),r.stop(i),o)){var l=i.dataTransfer.items;l&&l.length&&(l[0].webkitGetAsEntry||l[0].getAsEntry)?a.all(t.map(l,function(t){return t.webkitGetAsEntry?t.webkitGetAsEntry():t.getAsEntry()})).then(o):o(i.dataTransfer.files)}}),this}return o.dropzone=l,i.delegate(["dropzone"],o),s.fn.dropzone=s.wraps.wrapper_every_act(o.dropzone,o),l}),define("skylark-domx-files/pastezone",["skylark-langx/objects","skylark-domx-eventer","skylark-domx-velm","skylark-domx-query","./files"],function(t,e,n,r,i){function s(n,r){(r=r||{}).hoverClass;var i=r.pasted;return e.on(n,"paste",function(e){var n=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,r=[];n&&n.length&&t.each(n,function(t,e){var n=e.getAsFile&&e.getAsFile();n&&r.push(n)}),i&&r.length&&i(r)}),this}return i.pastezone=s,n.delegate(["pastezone"],i),r.fn.pastezone=r.wraps.wrapper_every_act(i.pastezone,i),s}),define("skylark-io-diskfs/select",["./diskfs"],function(t){var e,n=1/0;return t.select=function(t){var r=(t=t||{}).directory||!1,i=t.multiple||!1,s=t.accept||"",a=t.title||"",o=t.picked;if(!e){var l=e=document.createElement("input");function u(t){for(var e=t.length;e--;)t[e].size>n&&t.splice(e,1);o(t)}l.type="file",l.style.position="fixed",l.style.left=0,l.style.top=0,l.style.opacity=.001,document.body.appendChild(l),l.onchange=function(t){var e=t.target.webkitEntries||t.target.entries;e&&e.length?webentry.all(e).then(function(t){u(t)}):u(Array.prototype.slice.call(t.target.files)),l.value=""}}e.multiple=i,e.accept=s,e.title=a,e.webkitdirectory=r,e.click()}}),define("skylark-domx-files/picker",["skylark-langx/objects","skylark-domx-eventer","skylark-domx-velm","skylark-domx-query","skylark-io-diskfs/select","./files"],function(t,e,n,r,i,s){function a(t,n){return e.on(t,"click",function(t){t.preventDefault(),i(n)}),this}return s.picker=a,n.delegate(["picker"],s),r.fn.picker=r.wraps.wrapper_every_act(s.picker,s),a}),define("skylark-langx-emitter/main",["./Emitter","./Evented"],function(t){return t}),define("skylark-langx-emitter",["skylark-langx-emitter/main"],function(t){return t}),define("skylark-domx-files/SingleUploader",["skylark-langx-emitter","skylark-langx-async/Deferred","skylark-domx-velm","skylark-domx-plugins","./files","./dropzone","./pastezone","./picker"],function(t,e,n,r,i){return i.SingleUploader=class extends r.Plugin{get klassName(){return"SingleUploader"}get pluginName(){return"lark.singleuploader"}get options(){return{selectors:{picker:".file-picker",dropzone:".file-dropzone",pastezone:".file-pastezone",startUploads:".start-uploads",cancelUploads:".cancel-uploads"}}}constructor(t,e){super(t,e),this._velm=n(this._elm),this._initFileHandlers()}_initFileHandlers(){var t=this,e=this.options.selectors,n=e.dropzone,r=e.pastezone,i=e.picker;n&&this._velm.$(n).dropzone({dropped:function(e){t._addFile(e[0])}}),r&&this._velm.$(r).pastezone({pasted:function(e){t._addFile(e[0])}}),i&&this._velm.$(i).picker({multiple:!0,picked:function(e){t._addFile(e[0])}})}_addFile(t){this.emit("added",t)}destroy(){}}}),define("skylark-net-http/Upload",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-async/Deferred","skylark-langx-emitter/Evented","./Xhr","./http"],function(t,e,n,r,i,s,a){var o=Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice,l=i.inherit({klassName:"Upload",_construct:function(t){this._options=e.mixin({debug:!1,url:"/upload",maxConnections:999,maxChunkSize:void 0,onProgress:function(t,e,n,r){},onComplete:function(t,e){},onCancel:function(t,e){},onFailure:function(t,e,n){}},t),this._queue=[],this._params=[],this._files=[],this._xhrs=[],this._loaded=[]},add:function(t){return this._files.push(t)-1},send:function(t,n){if(this._files[t]&&!(this._queue.indexOf(t)>-1)){var r=this._queue.push(t),i=e.clone(n);this._params[t]=i,r<=this._options.maxConnections&&this._send(t,this._params[t])}},sendAll:function(t){for(var e=0;e<this._files.length;e++)this.send(e,t)},cancel:function(t){this._cancel(t),this._dequeue(t)},cancelAll:function(){for(var t=0;t<this._queue.length;t++)this._cancel(this._queue[t]);this._queue=[]},getName:function(t){var e=this._files[t];return null!=e.fileName?e.fileName:e.name},getSize:function(t){var e=this._files[t];return null!=e.fileSize?e.fileSize:e.size},getLoaded:function(t){return this._loaded[t]||0},_send:function(t,e){var n,r=this._options,i=this.getName(t),a=this.getSize(t),l=r.maxChunkSize||0,u=0,c=this._files[t],h={headers:{}};this._loaded[t]=this._loaded[t]||0;var f=this._xhrs[t]=new s({url:r.url});if(l)h.data=o.call(c,this._loaded[t],this._loaded[t]+l,c.type),n=h.data.size,h.headers["content-range"]="bytes "+this._loaded[t]+"-"+(this._loaded[t]+n-1)+"/"+a,h.headers["Content-Type"]="application/octet-stream";else{n=a;var d=e.formParamName,p=e.formData;d?(p||(p=new FormData),p.append(d,c),h.data=p):(h.headers["Content-Type"]=c.type||"application/octet-stream",h.data=c)}var m=this;f.post(h).progress(function(e){e.lengthComputable&&(u+=e.loaded,m._loaded[t]=m._loaded[t]+e.loaded,m._options.onProgress(t,i,m._loaded[t],a))}).then(function(){m._files[t]&&(u<n&&(m._loaded[t]=m._loaded[t]+n-u,m._options.onProgress(t,i,m._loaded[t],a)),m._loaded[t]<a?m._send(t,e):(m._options.onComplete(t,i),m._files[t]=null,m._xhrs[t]=null,m._dequeue(t)))}).catch(function(e){m._options.onFailure(t,i,e),m._files[t]=null,m._xhrs[t]=null,m._dequeue(t)})},_cancel:function(t){this._options.onCancel(t,this.getName(t)),this._files[t]=null,this._xhrs[t]&&(this._xhrs[t].abort(),this._xhrs[t]=null)},getQueue:function(){return this._queue},_dequeue:function(t){var e=n.inArray(t,this._queue);this._queue.splice(e,1);var r=this._options.maxConnections;if(this._queue.length>=r&&e<r){var i=this._queue[r-1];this._send(i,this._params[i])}}});return a.Upload=l}),define("skylark-domx-files/MultiUploader",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-query","skylark-domx-velm","skylark-net-http/Upload","skylark-domx-plugins","./files"],function(t,e,n,r,i,s,a){var o=s.Plugin.inherit({klassName:"Uploader",pluginName:"lark.multiuploader",options:{uploadUrl:"/upload",params:{formParamName:"file"},maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,autoUpload:!1,selectors:{fileList:".file-list",fileItem:".file-item",nodata:".file-list .no-data",picker:".file-picker",dropzone:".file-dropzone",pastezone:".file-pastezone",startUploads:".start-uploads",cancelUploads:".cancel-uploads"},template:'<div class="lark-multiuploader">    <h3 class="popover-title">Upload files</h3>    <div class="popover-content container-fluid" class="file-list file-dropzone file-pastezone">        <div class="no-data"><em>Add files.</em></div>    </div>    <footer>        <button class="btn btn-warning pull-right btn-sm" id="cancel-uploads-button"><i class="icon-cancel"></i>Cancel uploads</button>        <span class="btn btn-success fileinput-button btn-sm" id="fileinput-button">            <i class="icon-plus"></i>            <span>Add files...</span>            <input id="fileupload" type="file" name="files[]" multiple="multiple">        </span>        <button class="btn btn-primary btn-sm" id="start-uploads-button"><i class="icon-start"></i>Start uploads</button>    </footer></div>',dataType:"json",fileItem:{selectors:{name:".name",size:".size",cancel:".cancel",clear:".clear",progress:".progress",message:".message"},template:'<div class="file-item row">   <div class="col-md-6"><span class="name"></span></div>   <div class="col-md-3">    <span class="size"></span>    <div class="progress hidden">        <div class="progress-label"></div>        <div class="bar"></div>    </div>    <span class="message hidden"></span>   </div>   <div class="col-md-3">    <button class="btn btn-warning btn-xs cancel"><i class="icon-remove"></i>Cancel</button>    <button class="btn btn-xs clear hidden">Clear</button>   </div></div>'}},_construct:function(t,e){this.overrided(t,e),this._velm=r(this._elm),this._initEventHandler(),this._initFileHandlers(),this._initUpoadHandler(),this._updateFileList()},_initFileHandlers:function(){var t=this,e=this.options.selectors,n=e.dropzone,r=e.pastezone,i=e.picker;n&&this._velm.$(n).dropzone({dropped:function(e){t._addFiles(e)}}),r&&this._velm.$(r).pastezone({pasted:function(e){t._addFiles(e)}}),i&&this._velm.$(i).picker({multiple:!0,picked:function(e){t._addFiles(e)}})},_initUpoadHandler:function(){var t=this;this._handler=new i({url:this.options.uploadUrl,maxConnections:this.options.maxConnections,onProgress:function(e,n,r,i){t._onProgress(e,n,r,i)},onComplete:function(e,n,r){t._onComplete(e,n,r)},onCancel:function(e,n){t._onCancel(e,n)},onFailure:function(e,n,r){t._onFailure(e,n,r)}})},_initEventHandler:function(){var t=this,e=this.options.selectors,r=this.options.fileItem.selectors;this._listElement;this._velm.$(e.fileList).on("click",r.cancel,function(r){var i=n(this).closest(e.fileItem),s=i.data("fileId");t._handler.cancel(s),i.remove(),t._updateFileList()}),this._velm.$(e.fileList).on("click",r.clear,function(r){var i=n(this).closest(e.fileItem);i.data("fileId");i.remove(),t._updateFileList()}),this._velm.$(e.cancelUploads).click(function(){var r=t._velm.$(e.fileList).find(e.fileItem);r.forEach(function(e){var r=n(e),i=r.data("fileId");t._handler.cancel(i),r.remove()}),t._updateFileList()}),this._velm.$(e.startUploads).click(function(){var r=t._velm.$(e.fileList).find(e.fileItem);r.forEach(function(e){var r=n(e),i=r.data("fileId");r.data("status")||t._handler.send(i,t.options.params)})})},_onProgress:function(t,e,n,r){var i=this._getItemByFileId(t),s=parseInt(n/r*100,10),a=this._formatSize(n)+" of "+this._formatSize(r);i.data("status","running"),i.find(".progress").find(".bar").css("width",s+"%").parent().find(".progress-label").html(a),this._updateFile(i)},_onComplete:function(t,e,n){this._filesInProgress--;var r=this._getItemByFileId(t);r.data("status","done"),r.find(".message").html('<i class="icon-success"></i> '+(this.doneMsg||"Uploaded")),this._updateFile(r)},_onFailure:function(t,e,n){this._filesInProgress--;var r=this._getItemByFileId(t);r.data("status","error"),r.find(".message").html('<i class="icon-error"></i> '),this._updateFile(r)},_onCancel:function(t,e){this._filesInProgress--;var n=this._getItemByFileId(t);n.data("status","cancel"),this._updateFile(n)},_addToList:function(t,e){var e=this._handler.getName(t),r=this._handler.getSize(t),i=n(this.options.fileItem.template);i.data("fileId",t),i.find(this.options.fileItem.selectors.name).html(this._formatFileName(e)),i.find(this.options.fileItem.selectors.size).html(this._formatSize(r)),this._velm.$(this.options.selectors.fileList).append(i),this._updateFileList()},_updateFileList:function(){var t=this.options.selectors,e=(this.options.fileItem.selectors,this._velm.$(t.fileList).find(t.fileItem)),n=this._velm.$(t.cancelUploads+","+t.startUploads),r=this._velm.$(t.nodata);e.length>0?(n.removeClass("hidden"),r.addClass("hidden")):(n.addClass("hidden"),r.removeClass("hidden"))},_updateFile:function(t){var e=this.options.fileItem.selectors,n=t.find(e.size+","+e.cancel),r=t.find(e.progress+","+e.cancel),i=t.find(e.message+","+e.clear),s=t.data("status");"pending"==s?(r.add(i).addClass("hidden"),n.removeClass("hidden")):"running"==s?(n.add(i).addClass("hidden"),r.removeClass("hidden")):"done"!=s&&"error"!=s||(n.add(r).addClass("hidden"),i.removeClass("hidden"))},_getItemByFileId:function(t){for(var e,r=this.options.selectors,i=this._velm.$(r.fileList).find(r.fileItem),s=0;s<i.length;s++){var a=i[s];if(n(a).data("fileId")==t){e=a;break}}if(e)return n(e)},_addFiles:function(t){for(var e=0;e<t.length;e++)if(!this._validateFile(t[e]))return;for(var e=0;e<t.length;e++)this._addFile(t[e])},_addFile:function(t){var e=this._handler.add(t);this._filesInProgress++,this._addToList(e)},_validateFile:function(t){var e,n;return t.value?e=t.value.replace(/.*(\/|\\)/,""):(e=null!=t.fileName?t.fileName:t.name,n=null!=t.fileSize?t.fileSize:t.size),this._isAllowedExtension(e)?0===n?(this._error("emptyError",e),!1):n&&this.options.sizeLimit&&n>this.options.sizeLimit?(this._error("sizeError",e),!1):!(n&&n<this.options.minSizeLimit)||(this._error("minSizeError",e),!1):(this._error("typeError",e),!1)},_error:function(t,e){var n=this.options.messages[t];function r(t,e){n=n.replace(t,e)}r("{file}",this._formatFileName(e)),r("{extensions}",this.options.allowedExtensions.join(", ")),r("{sizeLimit}",this._formatSize(this.options.sizeLimit)),r("{minSizeLimit}",this._formatSize(this.options.minSizeLimit)),this.options.showMessage(n)},_formatFileName:function(t){return t.length>33&&(t=t.slice(0,19)+"..."+t.slice(-13)),t},_isAllowedExtension:function(t){var e=-1!==t.indexOf(".")?t.replace(/.*[.]/,"").toLowerCase():"",n=this.options.allowedExtensions;if(!n.length)return!0;for(var r=0;r<n.length;r++)if(n[r].toLowerCase()==e)return!0;return!1},_formatSize:function(t){var e=-1;do{t/=1024,e++}while(t>99);return Math.max(t,.1).toFixed(1)+["KB","MB","GB","TB","PB","EB"][e]}});return s.register(o),a.MultiUploader=o}),define("skylark-domx-files/main",["./files","./dropzone","./pastezone","./picker","./SingleUploader","./MultiUploader"],function(t){return t}),define("skylark-domx-files",["skylark-domx-files/main"],function(t){return t}),define("skylark-domx-images/images",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-eventer","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-styler","skylark-domx-data","skylark-domx-transforms","skylark-domx-query"],function(t,e,n,r,i,s,a,o,l,u){function c(t){e.isArray(t)||(t=[t]);var r=t.length,i=0,s=0,a=0,o=new e.Deferred;function l(){o.resolve({total:r,successed:s,failered:a,imgs:t})}function u(e,n){i++,n?s++:a++,o.progress({img:e,isLoaded:n,progressed:i,total:r,imgs:t}),i==r&&l()}return e.defer(function(){if(!t.length)return void l();t.forEach(function(t){h(t)?u(t,f(t)):n.on(t,{load:function(){u(t,!0)},error:function(){u(t,!1)}})})}),o.promise.totalCount=r,o.promise}function h(t){return t.complete&&void 0!==t.naturalWidth}function f(t){return t.complete&&0!==t.naturalWidth}function d(t,e){var n=[];function r(t){var e=/url\((['"])?(.*?)\1\)/gi.exec(a.css(t,"background-image")),r=e&&e[2];if(r){var i=new Image;i.src=r,n.push(i)}}if(e=e||{},"IMG"==t.nodeName)n.push(t);else{for(var s=i.findAll(t,"img"),o=0;o<s.length;o++)n.push(s[o]);if(!0===e.background)r(t);else if("string"==typeof e.background){var l=i.findAll(t,e.background);for(o=0;o<l.length;o++)r(l[o])}}return c(n)}function p(t,n){var i,o={},u=s.clientSize(t),c=n.loaded;n.failered;function h(){a.css(i,{top:(u.height-i.offsetHeight)/2+"px",left:(u.width-i.offsetWidth)/2+"px"}),l.reset(i),a.css(i,{visibility:"visible"}),c&&c()}function f(){}function d(t){i.style.visibility="hidden",i.src=t}!function(){"relative"!=(o=a.css(t,["position","overflow"])).position&&"absolute"!=o.position&&a.css(t,"position","relative");a.css(t,"overflow","hidden"),i=new Image,a.css(i,{position:"absolute",border:0,padding:0,margin:0,width:"auto",height:"auto",visibility:"hidden"}),i.onload=h,i.onerror=f,r.append(t,i),n.url&&d(n.url)}();var p={load:d,dispose:function(){r.remove(i),a.css(t,o),i=i.onload=i.onerror=null}};return["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout","reset"].forEach(function(t){p[t]=function(){var n=e.makeArray(arguments);n.unshift(i),l[t].apply(null,n)}}),p}function m(){return m}return u.fn.imagesLoaded=function(t){return d(this,t)},u.fn.imagesViewer=function(t){return p(this,t)},m.transform=function(t,e){},["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout","reset"].forEach(function(t){m.transform[t]=l[t]}),e.mixin(m,{isCompleted:h,isLoaded:f,loaded:d,preload:function(t,n){e.isString(t)&&(t=[t]);var r=[];return t.forEach(function(t){var e=new Image;e.src=t,r.push(e)}),c(r)},viewer:p}),t.attach("domx.images",m)}),define("skylark-domx-images/main",["./images"],function(t){return t}),define("skylark-domx-images",["skylark-domx-images/main"],function(t){return t}),define("skylark-domx-colors/colors",["skylark-langx/skylark"],function(t){return t.attach("domx.colores",{})}),define("skylark-domx-popups/popups",["skylark-langx-ns"],function(t){var e=[];return t.attach("domx.popups",{around:function(t){var e=geom.size(popup),n=e.width,r=e.height,i=geom.height(t),s=t.ownerDocument,a=s.documentElement,o=a.clientWidth+geom.scrollLeft(s),l=a.clientHeight+geom.scrollTop(s),u=geom.pagePosition(t),c=u.left,h=u.top;return h+=i,c-=Math.min(c,c+n>o&&o>n?Math.abs(c+n-o):0),{top:h-=Math.min(h,h+r>l&&l>r?Math.abs(r+i-0):0),bottom:u.bottom,left:c,right:u.right,width:u.width,height:u.height}},open:function(t,e){e.around},close:function(t){var n=0;if(t){for(var r=e.length-1;r>=0;r--)if(e[r].popup==t){n=e.length-r;break}}else n=e.length;for(var r=0;r<n;r++){var i=e.pop(),s=i.popup;s.hide&&s.hide()}}})}),define("skylark-domx-popups/calcOffset",["skylark-domx-geom","./popups"],function(t,e){return e.calcOffset=function(e,n){var r=t.size(e),i=r.width,s=r.height,a=t.height(n),o=e.ownerDocument,l=o.documentElement,u=l.clientWidth+t.scrollLeft(o),c=l.clientHeight+t.scrollTop(o),h=t.pagePosition(n),f=h.left,d=h.top;return d+=a,f-=Math.min(f,f+i>u&&u>i?Math.abs(f+i-u):0),{top:d-=Math.min(d,d+s>c&&c>s?Math.abs(s+a-0):0),bottom:h.bottom,left:f,right:h.right,width:h.width,height:h.height}}}),define("skylark-domx-popups/Dropdown",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./popups"],function(t,e,n,r,i,s,a,o){"use strict";var l=".dropdown-backdrop",u='[data-toggle="dropdown"]',c=a.Plugin.inherit({klassName:"Dropdown",pluginName:"domx.dropdown",options:{selectors:{toggler:'[data-toggle="dropdown"],.dropdown-menu'}},_construct:function(t,e){this.overrided(t,e);var n=this.$element=s(this._elm);n.on("click.dropdown",this.toggle),n.on("keydown.dropdown",this.options.selectors.toggler,this.keydown)},toggle:function(t){var e=s(this);if(!e.is(".disabled, :disabled")){var r=h(e),i=r.hasClass("open");if(f(),!i){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&s(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(s(this)).on("click",f);var a={relatedTarget:this};if(r.trigger(t=n.create("show.dropdown",a)),t.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger(n.create("shown.dropdown",a))}return!1}},keydown:function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var e=s(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var n=h(e),r=n.hasClass("open");if(!r&&27!=t.which||r&&27==t.which)return 27==t.which&&n.find(u).trigger("focus"),e.trigger("click");var i=n.find(".dropdown-menu li:not(.disabled):visible a");if(i.length){var a=i.index(t.target);38==t.which&&a>0&&a--,40==t.which&&a<i.length-1&&a++,~a||(a=0),i.eq(a).trigger("focus")}}}}});function h(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var n=e&&s(e);return n&&n.length?n:t.parent()}function f(t){t&&3===t.which||(s(l).remove(),s(u).each(function(){var e=s(this),i=h(e),a={relatedTarget:this};i.hasClass("open")&&(t&&"click"==t.type&&/input|textarea/i.test(t.target.tagName)&&r.contains(i[0],t.target)||(i.trigger(t=n.create("hide.dropdown",a)),t.isDefaultPrevented()||(e.attr("aria-expanded","false"),i.removeClass("open").trigger(n.create("hidden.dropdown",a)))))}))}return s(document).on("click.dropdown.data-api",f).on("click.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}),a.register(c),o.Dropdown=c}),define("skylark-domx-popups/ComboBox",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./popups","./Dropdown"],function(t,e,n,r,i,s,a,o,l){var u=a.Plugin.inherit({klassName:"ComboBox",pluginName:"domx.combobox",options:{autoResizeMenu:!0,filterOnKeypress:!1,showOptionsOnKeypress:!1,filter:function(t,e,n){var r=0;n.$dropMenu.find(".empty-indicator").remove(),t.each(function(t){var n=s(this),i=s(this).text().trim();n.removeClass(),i===e?(n.addClass("text-success"),r++):i.substr(0,e.length)===e?(n.addClass("text-info"),r++):n.addClass("hidden")}),0===r&&n.$dropMenu.append('<li class="empty-indicator text-muted"><em>No Matches</em></li>')}},_construct:function(e,n){this.overrided(e,n),this.$element=this.$(),this.$dropMenu=this.$element.find(".dropdown-menu"),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.$button.plugin("domx.dropdown"),this.$inputGroupBtn=this.$element.find(".input-group-btn"),this.$element.on("click.lark","a",t.proxy(this.itemclicked,this)),this.$element.on("change.lark","input",t.proxy(this.inputchanged,this)),this.$element.on("shown.bs.dropdown",t.proxy(this.menuShown,this)),this.$input.on("keyup.lark",t.proxy(this.keypress,this)),this.setDefaultSelection();var r=this.$dropMenu.children("li");0===r.length&&this.$button.addClass("disabled"),this.options.filterOnKeypress&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this)},_destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){s(this).attr("value",s(this).val())}),this.$element[0].outerHTML},doSelect:function(t){void 0!==t[0]?(this.$element.find("li.selected:first").removeClass("selected"),this.$selectedItem=t,this.$selectedItem.addClass("selected"),this.$input.val(this.$selectedItem.text().trim())):(this.$selectedItem=null,this.$element.find("li.selected:first").removeClass("selected"))},clearSelection:function(){this.$selectedItem=null,this.$input.val(""),this.$dropMenu.find("li").removeClass("selected")},menuShown:function(){this.options.autoResizeMenu&&this.resizeMenu()},resizeMenu:function(){var t=this.$element.outerWidth();this.$dropMenu.outerWidth(t)},selectedItem:function(){var e=this.$selectedItem,n={};if(e){var r=this.$selectedItem.text().trim();n=t.mixin({text:r},this.$selectedItem.data())}else n={text:this.$input.val().trim(),notFound:!0};return n},selectByText:function(t){var e=s([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||s(this).text()||"").trim().toLowerCase()===(t||"").trim().toLowerCase())return e=s(this),!1}),this.doSelect(e)},selectByValue:function(t){var e='li[data-value="'+t+'"]';this.selectBySelector(e)},selectByIndex:function(t){var e="li:eq("+t+")";this.selectBySelector(e)},selectBySelector:function(t){var e=this.$element.find(t);this.doSelect(e)},setDefaultSelection:function(){var t="li[data-selected=true]:first",e=this.$element.find(t);e.length>0&&(this.selectBySelector(t),e.removeData("selected"),e.removeAttr("data-selected"))},enable:function(){this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(t){this.$selectedItem=s(t.target).parent(),this.$input.val(this.$selectedItem.text().trim()).trigger("change",{synthetic:!0});var e=this.selectedItem();this.$element.trigger("changed.lark",e),t.preventDefault(),this.$element.find(".dropdown-toggle").focus()},keypress:function(t){var e=38===t.which||40===t.which||37===t.which||39===t.which;if(this.options.showOptionsOnKeypress&&!this.$inputGroupBtn.hasClass("open")&&(this.$button.plugin("domx.dropdown").toggle(),this.$input.focus()),13===t.which){t.preventDefault();var n=this.$dropMenu.find("li.selected").text().trim();n.length>0?this.selectByText(n):this.selectByText(this.$input.val()),this.$inputGroupBtn.removeClass("open")}else if(27===t.which)t.preventDefault(),this.clearSelection(),this.$inputGroupBtn.removeClass("open");else if(this.options.showOptionsOnKeypress&&(40===t.which||38===t.which)){t.preventDefault();var r=this.$dropMenu.find("li.selected");r.length>0&&(r=40===t.which?r.next(":not(.hidden)"):r.prev(":not(.hidden)")),0===r.length&&(r=40===t.which?this.$dropMenu.find("li:not(.hidden):first"):this.$dropMenu.find("li:not(.hidden):last")),this.doSelect(r)}this.options.filterOnKeypress&&!e&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this),this.previousKeyPress=t.which},inputchanged:function(t,e){var n=s(t.target).val();if(e&&e.synthetic)this.selectByText(n);else{this.selectByText(n);var r=this.selectedItem();0===r.text.length&&(r={text:n}),this.$element.trigger("changed.lark",r)}}});return u.prototype.getValue=u.prototype.selectedItem,a.register(u),o.ComboBox=u}),define("skylark-domx-popups/SelectList",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./popups","./Dropdown"],function(t,e,n,r,i,s,a,o,l){var u=a.Plugin.inherit({klassName:"SelectList",pluginName:"domx.selectlist",options:{emptyLabelHTML:'<li data-value=""><a href="#">No items</a></li>'},_construct:function(e,n){this.overrided(e,n),this.$element=this.$(),this.$button=this.$element.find(".btn.dropdown-toggle"),this.$hiddenField=this.$element.find(".hidden-field"),this.$label=this.$element.find(".selected-label"),this.$dropdownMenu=this.$element.find(".dropdown-menu"),this.$button.plugin("domx.dropdown"),this.$element.on("click.selectlist",".dropdown-menu a",t.proxy(this.itemClicked,this)),this.setDefaultSelection(),"auto"!==this.options.resize&&"auto"!==this.$element.attr("data-resize")||this.resize();var r=this.$dropdownMenu.children("li");0===r.length&&(this.disable(),this.doSelect(s(this.options.emptyLabelHTML))),this.$element.on("shown.dropdown",function(){var t=s(this);s(document).on("keypress.selectlist",function(e){var n=String.fromCharCode(e.which);t.find("li").each(function(t,e){if(s(e).text().charAt(0).toLowerCase()===n)return s(e).children("a").focus(),!1})})}),this.$element.on("hide.dropdown",function(){s(document).off("keypress.selectlist")})},_destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},doSelect:function(t){var e;this.$selectedItem=e=t,this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.html(s(this.$selectedItem.children()[0]).html()),this.$element.find("li").each(function(){e.is(s(this))?s(this).attr("data-selected",!0):s(this).removeData("selected").removeAttr("data-selected")})},itemClicked:function(t){this.$element.trigger("clicked.selectlist",this.$selectedItem),t.preventDefault(),s(t.currentTarget).parent("li").is(".disabled, :disabled")||(s(t.target).parent().is(this.$selectedItem)||this.itemChanged(t),this.$element.find(".dropdown-toggle").focus())},itemChanged:function(t){this.doSelect(s(t.target).closest("li"));var e=this.selectedItem();this.$element.trigger("changed.selectlist",e)},resize:function(){var t=0,e=0,n=s("<div/>").addClass("selectlist-sizer");Boolean(s(document).find("html").hasClass("fuelux"))?s(document.body).append(n):s(".fuelux:first").append(n),n.append(this.$element.clone()),this.$element.find("a").each(function(){n.find(".selected-label").text(s(this).text()),e=n.find(".selectlist").outerWidth(),(e+=n.find(".sr-only").outerWidth())>t&&(t=e)}),t<=1||(this.$button.css("width",t),this.$dropdownMenu.css("width",t),n.remove())},selectedItem:function(){var e=this.$selectedItem.text();return t.mixin({text:e},this.$selectedItem.data())},selectByText:function(t){var e=s([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||s(this).text()||"").toLowerCase()===(t||"").toLowerCase())return e=s(this),!1}),this.doSelect(e)},selectByValue:function(t){var e='li[data-value="'+t+'"]';this.selectBySelector(e)},selectByIndex:function(t){var e="li:eq("+t+")";this.selectBySelector(e)},selectBySelector:function(t){var e=this.$element.find(t);this.doSelect(e)},setDefaultSelection:function(){var t=this.$element.find("li[data-selected=true]").eq(0);0===t.length&&(t=this.$element.find("li").has("a").eq(0)),this.doSelect(t)},enable:function(){this.$element.removeClass("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$button.addClass("disabled")}});return u.prototype.getValue=u.prototype.selectedItem,a.register(u),o.SelectList=u}),define("skylark-domx-popups/main",["./popups","./calcOffset","./Dropdown","./ComboBox","./SelectList"],function(t){return t}),define("skylark-domx-popups",["skylark-domx-popups/main"],function(t){return t}),define("skylark-graphics-colors/colors",["skylark-langx-ns"],function(t){return t.attach("graphics.colors",{})}),define("skylark-graphics-colors/_names",[],function(){return{aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"}}),define("skylark-graphics-colors/_hexNames",["./_names"],function(t){return function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(t)}),define("skylark-graphics-colors/_conversion",["skylark-langx-strings","./_names"],function(t,e){var n=Math,r=n.round,i=n.min,s=n.max;n.random;function a(t){return 1==t.length?"0"+t:""+t}function o(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var r=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=i(e,s(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),n.abs(t-e)<1e-6?1:t%e/parseFloat(e)}var l,u,c,h=(u="[\\s|\\(]+("+(l="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+l+")[,|\\s]+("+l+")\\s*\\)?",c="[\\s|\\(]+("+l+")[,|\\s]+("+l+")[,|\\s]+("+l+")[,|\\s]+("+l+")\\s*\\)?",{rgb:new RegExp("rgb"+u),rgba:new RegExp("rgba"+c),hsl:new RegExp("hsl"+u),hsla:new RegExp("hsla"+c),hsv:new RegExp("hsv"+u),hsva:new RegExp("hsva"+c),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex3s:/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6s:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8s:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function f(t){return parseInt(t,16)}return{bound01:o,rgbToRgb:function(t,e,n){return{r:255*o(t,255),g:255*o(e,255),b:255*o(n,255)}},rgbToHsl:function(t,e,n){t=o(t,255),e=o(e,255),n=o(n,255);var r,a,l=s(t,e,n),u=i(t,e,n),c=(l+u)/2;if(l==u)r=a=0;else{var h=l-u;switch(a=c>.5?h/(2-l-u):h/(l+u),l){case t:r=(e-n)/h+(e<n?6:0);break;case e:r=(n-t)/h+2;break;case n:r=(t-e)/h+4}r/=6}return{h:r,s:a,l:c}},hslToRgb:function(t,e,n){var r,i,s;function a(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(t=o(t,360),e=o(e,100),n=o(n,100),0===e)r=i=s=n;else{var l=n<.5?n*(1+e):n+e-n*e,u=2*n-l;r=a(u,l,t+1/3),i=a(u,l,t),s=a(u,l,t-1/3)}return{r:255*r,g:255*i,b:255*s}},rgbToHsv:function(t,e,n){t=o(t,255),e=o(e,255),n=o(n,255);var r,a,l=s(t,e,n),u=i(t,e,n),c=l,h=l-u;if(a=0===l?0:h/l,l==u)r=0;else{switch(l){case t:r=(e-n)/h+(e<n?6:0);break;case e:r=(n-t)/h+2;break;case n:r=(t-e)/h+4}r/=6}return{h:r,s:a,v:c}},hsvToRgb:function(t,e,r){t=6*o(t,360),e=o(e,100),r=o(r,100);var i=n.floor(t),s=t-i,a=r*(1-e),l=r*(1-s*e),u=r*(1-(1-s)*e),c=i%6;return{r:255*[r,l,a,a,u,r][c],g:255*[u,r,r,l,a,a][c],b:255*[a,a,u,r,r,l][c]}},rgbToHex:function(t,e,n,i){var s=[a(r(t).toString(16)),a(r(e).toString(16)),a(r(n).toString(16))];if(i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1))return s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0);return s.join("")},rgbaToHex:function(t,e,n,i){return[a((s=i,Math.round(255*parseFloat(s)).toString(16))),a(r(t).toString(16)),a(r(e).toString(16)),a(r(n).toString(16))].join("");var s},hexToRgb:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},strToRgb:function(n){n=t.trim(n).toLowerCase();var r,i=!1;if(e[n])n=e[n],i=!0;else if("transparent"==n)return{r:0,g:0,b:0,a:0,format:"name"};if(r=h.rgb.exec(n))return{r:r[1],g:r[2],b:r[3]};if(r=h.rgba.exec(n))return{r:r[1],g:r[2],b:r[3],a:r[4]};if(r=h.hsl.exec(n))return{h:r[1],s:r[2],l:r[3]};if(r=h.hsla.exec(n))return{h:r[1],s:r[2],l:r[3],a:r[4]};if(r=h.hsv.exec(n))return{h:r[1],s:r[2],v:r[3]};if(r=h.hsva.exec(n))return{h:r[1],s:r[2],v:r[3],a:r[4]};if((r=h.hex8.exec(n))||(r=h.hex8s.exec(n)))return{a:(s=r[1],f(s)/255),r:f(r[2]),g:f(r[3]),b:f(r[4]),format:i?"name":"hex8"};var s;if((r=h.hex6.exec(n))||(r=h.hex6s.exec(n)))return{r:f(r[1]),g:f(r[2]),b:f(r[3]),format:i?"name":"hex"};if((r=h.hex3.exec(n))||(r=h.hex3s.exec(n)))return{r:f(r[1]+""+r[1]),g:f(r[2]+""+r[2]),b:f(r[3]+""+r[3]),format:i?"name":"hex"};return!1}}}),define("skylark-graphics-colors/Color",["skylark-langx-types","skylark-langx-klass","./colors","./_names","./_hexNames","./_conversion"],function(t,e,n,r,i,s){var a=Math,o=a.round,l=a.min,u=a.max,c=a.random;function h(t){return l(1,u(0,t))}var f=e({init:function(e,n){n=n||{},t.isString(e)&&(e=s.hexToRgb(e)),this._r=e.r,this._g=e.g,this._b=e.b,this._a=t.isDefined(e.a)?e.a:1,this._roundA=o(1e3*this._a)/1e3,this._format=n.format||e.format,this._gradientType=n.gradientType,this._r<1&&(this._r=o(this._r)),this._g<1&&(this._g=o(this._g)),this._b<1&&(this._b=o(this._b))},isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=function(t){t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1);return t}(t),this._roundA=o(1e3*this._a)/1e3,this},toHsv:function(){var t=s.rgbToHsv(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=s.rgbToHsv(this._r,this._g,this._b),e=o(360*t.h),n=o(100*t.s),r=o(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+r+"%)":"hsva("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=s.rgbToHsl(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=s.rgbToHsl(this._r,this._g,this._b),e=o(360*t.h),n=o(100*t.s),r=o(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+r+"%)":"hsla("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return s.rgbToHex(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return s.rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(100*s.bound01(this._r,255))+"%",g:o(100*s.bound01(this._g,255))+"%",b:o(100*s.bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+o(100*s.bound01(this._r,255))+"%, "+o(100*s.bound01(this._g,255))+"%, "+o(100*s.bound01(this._b,255))+"%)":"rgba("+o(100*s.bound01(this._r,255))+"%, "+o(100*s.bound01(this._g,255))+"%, "+o(100*s.bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(i[s.rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+s.rgbaToHex(this._r,this._g,this._b,this._a),n=e,r=this._gradientType?"GradientType = 1, ":"";if(t){var i=f(t);n=i.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+n+")"},toNumber:function(){return this._r<<16^this._g<<8^this._b<<0},toString:function(t){var e=!!t;t=t||this._format;var n=!1,r=this._a<1&&this._a>=0,i=!e&&r&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return i?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString())},lighten:function(t){t=0===t?0:t||10;var e=this.toHsl();return e.l+=t/100,e.l=h(e.l),f.fromHsl(e)},brighten:function(t){t=0===t?0:t||10;var e=this.toRgb();return e.r=u(0,l(255,e.r-o(-t/100*255))),e.g=u(0,l(255,e.g-o(-t/100*255))),e.b=u(0,l(255,e.b-o(-t/100*255))),new f(e)},darken:function(t){t=0===t?0:t||10;var e=this.toHsl();return e.l-=t/100,e.l=h(e.l),f.fromHsl(e)},desaturate:function(t){t=0===t?0:t||10;var e=this.toHsl();return e.s-=t/100,e.s=h(e.s),f.fromHsl(e)},saturate:function(t){t=0===t?0:t||10;var e=this.toHsl();return e.s+=t/100,e.s=h(e.s),f.fromHsl(e)},greyscale:function(){return this.desaturate(100)},spin:function(t){var e=this.toHsl(),n=(o(e.h)+t)%360;return e.h=n<0?360+n:n,f.fromHsl(e)},analogous:function(t,e){t=t||6,e=e||30;var n=this.toHsl(),r=360/e,i=[this];for(n.h=(n.h-(r*t>>1)+720)%360;--t;)n.h=(n.h+r)%360,i.push(f.fromHsl(n));return i},complement:function(){var t=this.toHsl();return t.h=(t.h+180)%360,f.fromHsl(t)},monochromatic:function(t){t=t||6;for(var e=this.toHsv(),n=e.h,r=e.s,i=e.v,s=[],a=1/t;t--;)s.push(f.fromHsv({h:n,s:r,v:i})),i=(i+a)%1;return s},splitcomplement:function(){var t=this.toHsl(),e=t.h;return[this,f.fromHsl({h:(e+72)%360,s:t.s,l:t.l}),f.fromHsl({h:(e+216)%360,s:t.s,l:t.l})]},triad:function(){var t=this.toHsl(),e=t.h;return[this,f.fromHsl({h:(e+120)%360,s:t.s,l:t.l}),f.fromHsl({h:(e+240)%360,s:t.s,l:t.l})]},tetrad:function(){var t=this.toHsl(),e=t.h;return[this,f.fromHsl({h:(e+90)%360,s:t.s,l:t.l}),f.fromHsl({h:(e+180)%360,s:t.s,l:t.l}),f.fromHsl({h:(e+270)%360,s:t.s,l:t.l})]},mix:function(t,e){e=0===e?0:e||50;var n,r=this.toRgb(),i=t.toRgb(),s=e/100,a=2*s-1,o=i.a-r.a,l=1-(n=((n=a*o==-1?a:(a+o)/(1+a*o))+1)/2),u={r:i.r*n+r.r*l,g:i.g*n+r.g*l,b:i.b*n+r.b*l,a:i.a*s+r.a*(1-s)};return new f(u)},isValid:function(){return!0}});function d(t){return t<=1&&(t=100*t+"%"),t}return f.equals=function(t,e){return!(!t||!e)&&(t=f.parse(t),e=f.parse(e),t.toRgbString()==e.toRgbString())},f.random=function(){return f.fromRatio({r:c(),g:c(),b:c()})},f.fromRgba=function(t,e,n,r){return new f({r:t,g:e,b:n,a:r})},f.fromRgb=function(t,e,n){return new f({r:t,g:e,b:n})},f.fromHsl=function(t,e,n,r){var i=s.hslToRgb(t,e,n);return new f(i)},f.fromHsv=function(t,e,n,r){var i=s.hsvToRgb(t,e,n);return new f(i)},f.parse=function(t){if(t instanceof f)return t;var e={r:0,g:0,b:0},n=1,r=!1,i=!1;return"string"==typeof t&&(t=s.strToRgb(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=s.rgbToRgb(t.r,t.g,t.b),r=!0,i="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=d(t.s),t.v=d(t.v),e=s.hsvToRgb(t.h,t.s,t.v),r=!0,i="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=d(t.s),t.l=d(t.l),e=s.hslToRgb(t.h,t.s,t.l),r=!0,i="hsl"),t.hasOwnProperty("a")&&(n=t.a)),new f({ok:r,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n},{format:t.format||i})},n.Color=f}),define("skylark-domx-colors/helper",["skylark-domx-browser","skylark-domx-query","skylark-graphics-colors/Color"],function(t,e,n){t.isIE;return{paletteTemplate:function(t,r,i,s){for(var a=[],o=0;o<t.length;o++){var l=t[o];if(l){var u=n.parse(l),c=u.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=n.equals(r,l)?" sp-thumb-active":"";var h=u.toString(s.preferredFormat||"rgb"),f="background-color:"+u.toRgbString();a.push('<span title="'+h+'" data-color="'+u.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+f+';" /></span>')}else{a.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",s.texts.noColorSelectedText)).html())}}return"<div class='sp-cf "+i+"'>"+a.join("")+"</div>"}}}),define("skylark-domx-colors/Indicator",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins"],function(t,e,n,r,i,s,a,o){var l=o.Plugin.inherit({klassName:"Indicator",pluginName:"domx.indicator",options:{},_construct:function(t,e){o.Plugin.prototype._construct.call(this,t,e),this.listenTo(this.elmx(),"mousedown",t=>{this._start(t)})},_move:function(t){if(this._dragging){var e=this._offset,n=t.pageX,r=t.pageY,i=this._maxWidth,s=this._maxHeight,a=Math.max(0,Math.min(n-e.left,i)),o=Math.max(0,Math.min(r-e.top,s)),l=this.options.onmove;l&&l.apply(this._elm,[a,o,t])}},_start:function(t){var e=t.which?3==t.which:2==t.button;if(!e&&!this._dragging){var n=this.options.onstart;if(!n||!1!==n.apply(this._elm,arguments)){this._dragging=!0;var r=this.$();this._maxHeight=r.height(),this._maxWidth=r.width(),this._offset=r.offset();var s=this.$(document);this.listenTo(s,{mousemove:t=>{this._move(t)},mouseup:t=>{this._stop(t)}}),s.find("body").addClass("sp-dragging"),this._move(t),i.stop(t)}}},_stop:function(t){var e=this.$(document);this._dragging&&(this.unlistenTo(e),e.find("body").removeClass("sp-dragging"),onstop=this.options.onstop,onstop&&this._delay(function(){onstop.apply(this._elm,arguments)})),this._dragging=!1}});return o.register(l),l}),define("skylark-domx-colors/ColorPicker",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins","skylark-graphics-colors/Color","./colors","./helper","./Indicator"],function(t,e,n,r,i,s,a,o,l,u,c,h){"use strict";var f=o.Plugin.inherit({klassName:"ColorPicker",pluginName:"domx.colors.picker",options:{selectors:{dragger:".sp-color",dragHelper:".sp-dragger",slider:".sp-hue",slideHelper:".sp-slider",alphaSliderInner:".sp-alpha-inner",alphaSlider:".sp-alpha",alphaSlideHelper:".sp-alpha-handle",textInput:".sp-input",initialColorContainer:".sp-initial",cancelButton:".sp-cancel",clearButton:".sp-clear",chooseButton:".sp-choose"},draggingClass:"sp-dragging",texts:{cancelText:"cancel",chooseText:"choose",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected"},states:{showInput:!1,allowEmpty:!1,showButtons:!0,showInitial:!1,showAlpha:!1},preferredFormat:"hex",color:!1},_drawInitial:function(){var t=this.options;if(this.stating("showInitial")){var e=this._initialColor,n=this.current();this.$initialColorContainer.html(c.paletteTemplate([e,n],n,"sp-palette-row-initial",t))}},_updateHelperLocations:function(){var t=this._currentSaturation,e=this._currentValue;if(this.stating("allowEmpty")&&this._isEmpty)this.$alphaSlideHelper.hide(),this.$slideHelper.hide(),this.$dragHelper.hide();else{this.$alphaSlideHelper.show(),this.$slideHelper.show(),this.$dragHelper.show();var n=t*this._dragWidth,r=this._dragHeight-e*this._dragHeight;n=Math.max(-this._dragHelperHeight,Math.min(this._dragWidth-this._dragHelperHeight,n-this._dragHelperHeight)),r=Math.max(-this._dragHelperHeight,Math.min(this._dragHeight-this._dragHelperHeight,r-this._dragHelperHeight)),this.$dragHelper.css({top:r+"px",left:n+"px"});var i=this._currentAlpha*this._alphaWidth;this.$alphaSlideHelper.css({left:i-this._alphaSlideHelperWidth/2+"px"});var s=this._currentHue*this._slideHeight;this.$slideHelper.css({top:s-this._slideHelperHeight+"px"})}},_updateOriginalInput:function(t){var e=this.current();l.equals(e,this._colorOnShow);e&&(e.toString(this._currentPreferredFormat),this.emit("picked",e))},_updateUI:function(){this.options;this._dragWidth=this.$dragger.width(),this._dragHeight=this.$dragger.height(),this._dragHelperHeight=this.$dragHelper.height(),this._slideWidth=this.$slider.width(),this._slideHeight=this.$slider.height(),this._slideHelperHeight=this.$slideHelper.height(),this._alphaWidth=this.$alphaSlider.width(),this._alphaSlideHelperWidth=this.$alphaSlideHelper.width(),this.$textInput.removeClass("sp-validation-error"),this._updateHelperLocations();var t=l.parse({h:360*this._currentHue,s:1,v:1});this.$dragger.css("background-color",t.toHexString());var n=this._currentPreferredFormat;this._currentAlpha<1&&(0!==this._currentAlpha||"name"!==n)&&("hex"!==n&&"hex3"!==n&&"hex6"!==n&&"name"!==n||(n="rgb"));var r=this.current(),i="";if(!r&&this.stating("allowEmpty"));else{var s=r.toHexString();r.toRgbString();if(this.stating("showAlpha")){var a=r.toRgb();a.a=0;var o=l.parse(a).toRgbString(),u="linear-gradient(left, "+o+", "+s+")";e.isIE?this.$alphaSliderInner.css("filter",l.parse(o).toFilter({gradientType:1},s)):(this.$alphaSliderInner.css("background","-webkit-"+u),this.$alphaSliderInner.css("background","-moz-"+u),this.$alphaSliderInner.css("background","-ms-"+u),this.$alphaSliderInner.css("background","linear-gradient(to right, "+o+", "+s+")"))}i=r.toString(n)}this.stating("showInput")&&this.$textInput.val(i),this.stating("showPalette")&&this._drawPalette(),this._drawInitial()},_applyOptions:function(){var t=this.options;this._states={allowEmpty:t.states.allowEmpty,showInput:t.states.showInput,showAlpha:t.states.showAlpha,showButtons:t.states.showButtons,showInitial:t.states.showInitial},this._applyStates(),this.reflow()},_construct:function(t,e){o.Plugin.prototype._construct.call(this,t,e);var n=this.$el=this.$(),r=this.options,i=(r.theme,this.$dragger=n.find(r.selectors.dragger),this.$dragHelper=n.find(r.selectors.dragHelper),this.$slider=n.find(r.selectors.slider),this.$slideHelper=n.find(r.selectors.slideHelper),this.$alphaSliderInner=n.find(r.selectors.alphaSliderInner),this.$alphaSlider=n.find(r.selectors.alphaSlider),this.$alphaSlideHelper=n.find(r.selectors.alphaSlideHelper),this.$textInput=n.find(r.selectors.textInput),this.$initialColorContainer=n.find(r.selectors.initialColorContainer),this.$cancelButton=n.find(r.selectors.cancelButton),this.$clearButton=n.find(r.selectors.clearButton),this.$chooseButton=n.find(r.selectors.chooseButton),this._initialColor=r.color);this._currentPreferredFormat=r.preferredFormat,this._isEmpty=!i;this._init()},_init:function(){var t=this,n=this.options;function r(){(t._dragHeight<=0||t._dragWidth<=0||t._slideHeight<=0)&&t.reflow(),t._isDragging=!0,t.$el.addClass(t.options.draggingClass),t._shiftMovementDirection=null}function a(){t._isDragging=!1,t.$el.removeClass(t.options.draggingClass)}function o(){t._updateOriginalInput(),t._updateUI()}function u(){var e=t.$textInput.val();if(null!==e&&""!==e||!t._allowEmpty){var n=l.parse(e);n.isValid()?(t.current(n),o()):t.$textInput.addClass("sp-validation-error")}else t.current(null),o()}this._applyOptions(),this.$textInput.change(u),this.$textInput.on("paste",function(){setTimeout(u,1)}),this.$textInput.keydown(function(t){13==t.keyCode&&u()}),this.$cancelButton.text(n.texts.cancelText),this.listenTo(this.$cancelButton,"click",function(e){s.stop(e),t.revert(),t.emit("canceled")}),this.$clearButton.attr("title",n.texts.clearText),this.listenTo(this.$clearButton,"click",function(e){s.stop(e),t._isEmpty=!0,o()}),this.$chooseButton.text(n.texts.chooseText),this.listenTo(this.$chooseButton,"click",function(e){s.stop(e),t._updateOriginalInput(!0),t.emit("choosed")}),this.$alphaSlider.plugin("domx.indicator",{onmove:function(e,n,r){t._currentAlpha=e/t._alphaWidth,t._isEmpty=!1,r.shiftKey&&(t._currentAlpha=Math.round(10*t._currentAlpha)/10),o()},onstart:r,onstop:a}),this.$slider.plugin("domx.indicator",{onmove:function(e,n,r){t._currentHue=parseFloat(n/t._slideHeight),t._isEmpty=!1,t.stating("showAlpha")||(t._currentAlpha=1),o()},onstart:r,onstop:a}),this.$dragger.plugin("domx.indicator",{onmove:function(e,n,r){if(r.shiftKey){if(!t._shiftMovementDirection){var i=t._currentSaturation*t._dragWidth,s=t._dragHeight-t._currentValue*t._dragHeight,a=Math.abs(e-i)>Math.abs(n-s);t._shiftMovementDirection=a?"x":"y"}}else t._shiftMovementDirection=null;var l=!t._shiftMovementDirection||"x"===t._shiftMovementDirection,u=!t._shiftMovementDirection||"y"===t._shiftMovementDirection;l&&(t._currentSaturation=parseFloat(e/t._dragWidth)),u&&(t._currentValue=parseFloat((t._dragHeight-n)/t._dragHeight)),t._isEmpty=!1,t.stating("showAlpha")||(t._currentAlpha=1),o()},onstart:r,onstop:a}),this.current(this._initialColor),t._updateUI();var c=e.isIE?"mousedown.ColorPicker":"click.ColorPicker touchstart.ColorPicker";this.$initialColorContainer.on(c,".sp-thumb-el:nth-child(1)",{ignore:!0},function(e){e.data&&e.data.ignore,t.current(i(e.target).closest(".sp-thumb-el").data("color")),o();return!1})},revert:function(){this.current(this._initialColor,!0),this._updateOriginalInput(!0)},current:function(t){if(void 0===t)return this._allowEmpty&&this._isEmpty?null:l.parse({h:360*this._currentHue,s:this._currentSaturation,v:this._currentValue,a:Math.round(1e3*this._currentAlpha)/1e3});var e,n;l.equals(t,this.current())?this._updateUI():(!t&&this.stating("allowEmpty")?this._isEmpty=!0:(this._isEmpty=!1,e=l.parse(t),n=e.toHsv(),this._currentHue=n.h%360/360,this._currentSaturation=n.s,this._currentValue=n.v,this._currentAlpha=n.a),this._updateUI())},_applyStates:function(){var t=this._states;this.$el.toggleClass("sp-input-disabled",!t.showInput).toggleClass("sp-clear-enabled",!!t.allowEmpty).toggleClass("sp-alpha-enabled",t.showAlpha).toggleClass("sp-buttons-disabled",!t.showButtons).toggleClass("sp-initial-disabled",!t.showInitial),t.allowEmpty||this.$clearButton.hide(),this._dragWidth=this.$dragger.width(),this._dragHeight=this.$dragger.height(),this._dragHelperHeight=this.$dragHelper.height(),this._slideWidth=this.$slider.width(),this._slideHeight=this.$slider.height(),this._slideHelperHeight=this.$slideHelper.height(),this._alphaWidth=this.$alphaSlider.width(),this._alphaSlideHelperWidth=this.$alphaSlideHelper.width()},stating:function(t,e){if(void 0===e)return this._states[t];this._states[t]=e,this._applyStates()},reflow:function(){this._updateHelperLocations()}});return o.register(f),u.ColorPicker=f}),define("skylark-domx-colors/ColorPalette",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-fx","skylark-domx-plugins","skylark-graphics-colors/Color","./colors","./helper"],function(t,e,n,r,i,s,a,o,l,u,c,h,f){"use strict";e.noop;var d=u.Plugin.inherit({klassName:"ColorPalette",pluginName:"domx.colors.palette",options:{selectors:{},texts:{},states:{showSelectionPalette:!0},palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[]},_addColorToSelectionPalette:function(t){if(this.stating("showSelectionPalette")){var n=c.parse(t).toRgbString();if(!this._paletteLookup[n]&&-1===e.inArray(n,this._selectionPalette))for(this._selectionPalette.push(n);this._selectionPalette.length>this._maxSelectionSize;)this._selectionPalette.shift()}},getUniqueSelectionPalette:function(){var t=[],e=this.options;if(this.stating("showPalette"))for(var n=0;n<this._selectionPalette.length;n++){var r=c.parse(this._selectionPalette[n]).toRgbString();this._paletteLookup[r]||t.push(this._selectionPalette[n])}return t.reverse().slice(0,e.maxSelectionSize)},_drawPalette:function(){var t=this.options,n=this.current(),r=e.map(this._paletteArray,function(e,r){return f.paletteTemplate(e,n,"sp-palette-row sp-palette-row-"+r,t)});this._selectionPalette&&r.push(f.paletteTemplate(this.getUniqueSelectionPalette(),n,"sp-palette-row sp-palette-row-selection",t)),this.$el.html(r.join(""))},_updateUI:function(){this._drawPalette()},_applyOptions:function(){var t=this.options;if(this._states={showSelectionPalette:t.showSelectionPalette},t.palette)for(var n=this._palette=t.palette.slice(0),r=this._paletteArray=e.isArray(n[0])?n:[n],i=this._paletteLookup={},s=0;s<r.length;s++)for(var a=0;a<r[s].length;a++){var o=c.parse(r[s][a]).toRgbString();i[o]=!0}this._applyStates()},_construct:function(t,e){u.Plugin.prototype._construct.call(this,t,e),this.$el=this.$(),this._init()},_init:function(){var t=this,e=this.options;this._initialColor=e.color,this._selectionPalette=e.selectionPalette.slice(0);this._applyOptions(),this._initialColor?(this.current(this._initialColor),t._addColorToSelectionPalette(this._initialColor)):this._updateUI();var r=n.isIE?"mousedown.palette":"click.palette touchstart.palette";this.$el.on(r,".sp-thumb-el",function(e){return t.current(s(e.target).closest(".sp-thumb-el").data("color")),t.emit("selected",t.current()),!1})},_applyStates:function(){},stating:function(t,e){if(void 0===e)return this._states[t];this._states[t]=e,this._applyStates()},reflow:function(){this._drawPalette()},current:function(t){if(void 0===t)return this._current;this._current=t,this._updateUI()}});return u.register(d),h.ColorPalette=d}),define("skylark-domx-colors/ColorPane",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-fx","skylark-domx-plugins","skylark-domx-popups","skylark-graphics-colors/Color","./colors","./ColorPicker","./ColorPalette"],function(t,e,n,r,i,s,a,o,l,u,c,h,f,d){"use strict";var p=l.Plugin.inherit({klassName:"ColorPane",pluginName:"domx.colors.pane",options:{selectors:{pickerContainer:".sp-picker-container",toggleButton:".sp-palette-toggle",paletteContainer:".sp-palette"},draggingClass:"sp-dragging",texts:{togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected"},states:{showPalette:!1,showPaletteOnly:!1,togglePaletteOnly:!1,showSelectionPalette:!0,showInput:!1,allowEmpty:!1,showButtons:!0,showInitial:!1,showAlpha:!1},color:!1,maxSelectionSize:7},_updateUI:function(){this.stating("showPalette")&&this.palette._updateUI(),this.picker._updateUI()},_applyOptions:function(){var t=this.options;this._states={allowEmpty:t.states.allowEmpty,showInput:t.states.showInput,showAlpha:t.states.showAlpha,showButtons:t.states.showButtons,togglePaletteOnly:t.states.togglePaletteOnly,showPalette:t.states.showPalette,showPaletteOnly:t.states.showPaletteOnly,showSelectionPalette:t.showSelectionPalette,showInitial:t.states.showInitial},this._applyStates(),this.reflow()},_construct:function(t,e){l.Plugin.prototype._construct.call(this,t,e);var n=this.$el=this.$(),r=this.options,i=(r.theme,this.$pickerContainer=n.find(r.selectors.pickerContainer)),s=this.$paletteContainer=n.find(r.selectors.paletteContainer),a=(this.$toggleButton=n.find(r.selectors.toggleButton),this._initialColor=r.color);this._isEmpty=!a;s[0]&&(this.palette=d.instantiate(s[0],{selectionPalette:r.selectionPalette,color:r.color,palette:r.palette,selectionPalette:r.selectionPalette})),i[0]&&(this.picker=f.instantiate(i[0],{color:r.color,states:{showInput:r.states.showInput,allowEmpty:r.states.allowEmpty,showButtons:r.states.showButtons,showInitial:r.states.showInitial,showAlpha:r.states.showAlpha}}),this.listenTo(this.picker,"canceled",t=>{this.emit("canceled")}),this.listenTo(this.picker,"choosed",t=>{this.emit("choosed")}),this.listenTo(this.picker,"picked",(t,e)=>{this.emit("picked",e)})),this._init()},_init:function(){var t=this;this.options;e.isIE&&this.$container.find("*:not(input)").attr("unselectable","on"),this._applyOptions(),this.listenTo(this.$toggleButton,"click",function(e){s.stop(e),t.stating("showPaletteOnly",!t.stating("showPaletteOnly"))}),this.listenTo(this.palette,"selected",function(e,n){t.picker.current(n)})},revert:function(){this.set(this._colorOnShow,!0),this._updateOriginalInput(!0)},get:function(){return this.picker.current()},set:function(t){this.picker.current(t),this.palette.current(t)},_applyStates:function(){var t=this._states;t.showPaletteOnly&&(t.showPalette=!0),this.$toggleButton.text(t.showPaletteOnly?this.option("texts.togglePaletteMoreText"):this.option("texts.togglePaletteLessText")),this.$el.toggleClass("sp-input-disabled",!t.showInput).toggleClass("sp-clear-enabled",!!t.allowEmpty).toggleClass("sp-alpha-enabled",t.showAlpha).toggleClass("sp-buttons-disabled",!t.showButtons).toggleClass("sp-palette-buttons-disabled",!t.togglePaletteOnly).toggleClass("sp-palette-disabled",!t.showPalette).toggleClass("sp-palette-only",t.showPaletteOnly).toggleClass("sp-initial-disabled",!t.showInitial),t.showPaletteOnly&&this.$el.css("left","-="+(this.$pickerContainer.outerWidth(!0)+5))},stating:function(t,e){if(void 0===e)return this._states[t];this._states[t]=e,this._applyStates()},reflow:function(){this.stating("showPalette")&&this.palette.reflow(),this.picker.reflow()}});return l.register(p),h.ColorPane=p}),define("skylark-domx-colors/ColorBox",["skylark-langx/langx","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins","skylark-domx-popups","skylark-graphics-colors/Color","./colors","./ColorPane"],function(t,e,n,r,i,s,a,o,l,u,c){"use strict";var h=a.Plugin.inherit({klassName:"ColorBox",pluginName:"domx.colors.box",options:{pane:{states:{showPalette:!1,showPaletteOnly:!1,togglePaletteOnly:!1,showSelectionPalette:!0,showInput:!1,allowEmpty:!1,showButtons:!0,showInitial:!1,showAlpha:!1},maxSelectionSize:7,palette:void 0,selectionPalette:void 0},color:!1},_updateUI:function(){var t=this.get();if(this.$previewElement.removeClass("sp-clear-display"),this.$previewElement.css("background-color","transparent"),!t&&this.stating("allowEmpty"))this.$previewElement.addClass("sp-clear-display");else{t.toHexString();var e=t.toRgbString();this.$previewElement.css("background-color",e),t.toString()}this.pane._updateUI()},_applyOptions:function(){this.reflow()},_construct:function(e,n){a.Plugin.prototype._construct.call(this,e,n),this.$el=this.$();var i=this.options,s=this.$pane=r(i.pane.template);this.$previewElement=this.$el.find(".sp-preview-inner");s[0]&&(this.pane=c.instantiate(s[0],t.mixin({color:i.color},i.pane))),this._init()},_init:function(){var t=this;this.options;this._applyOptions();var e=!1;function n(){e&&(e=!1,t.$pane.hide())}this.$pane.hide(),this.listenTo(this.$el,"click touchstart",function(r){e?n():function(){if(e)return;e=!0,t.$pane.show(),t.reflow(),t._updateUI()}(),i.stop(r)}),this.listenTo(this.pane,"picked",(t,e)=>{this.$previewElement.css("background-color",e.toRgbString())}),this.listenTo(this.pane,"canceled choosed",t=>{n()})},revert:function(){this.pane.revert()},get:function(){return this.pane.get()},set:function(t){this.pane.set(t)},reflow:function(){this.$pane.css("position","absolute"),this.$pane.offset(o.calcOffset(this.$pane[0],this.$el[0])),this.pane.reflow()}});return a.register(h),u.ColorBox=h}),define("skylark-domx-colors/colorer",["skylark-langx/langx","skylark-domx-data","skylark-domx-query","./colors","./ColorBox","./ColorPane"],function(t,e,n,r,i,s){var a=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),o=["<div class='sp-container'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>","</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("");function l(e,r){var l=(r=t.mixin({color:!1,flat:!1,appendTo:"body",maxSelectionSize:7,preferredFormat:!1,containerClassName:"",replacerClassName:"",theme:"sp-light",offset:null,pane:{}},r)).theme,u=r.flat,c=r.appendTo,h=n(e),f=n(o,e.ownerDocument).addClass(l),d=h.is("input"),p=(d&&h.attr("type"),this._shouldReplace=d&&!u),m=p?n(a).addClass(l).addClass(r.className).addClass(r.replacerClassName):n([]);if(delete r.flat,delete r.appendTo,r.color=r.color||d&&h.val(),p&&h.after(m).hide(),f.toggleClass("sp-flat",u).addClass(r.containerClassName),u){h.after(f).hide();var g=new s(f[0],r);return r.picked&&g.on("picked",r.picked),r.choosed&&g.on("choosed",r.choosed),r.canceled&&g.on("canceled",r.canceled),f.show(),g}var y="parent"===c?h.parent():n(c);return 1!==y.length&&(y=n("body")),y.append(f),r.pane.template=f,new i(m[0],r)}return n.fn.colorer=function(t){var n=this[0];if(n){var r=e.data(n,"domx.colorer");return r||(r=l(n,t),e.data(n,"domx.colorer",r)),r}},r.colorer=l}),define("skylark-domx-colors/Drag",[],function(){var t={obj:null,gradx:null,init:function(e,n,r,i,s,a,o,l,u,c){e.onmousedown=t.start,e.hmode=!o,e.vmode=!l,e.root=n&&null!=n?n:e,e.hmode&&isNaN(parseInt(e.root.style.left))&&(e.root.style.left="0px"),!e.hmode&&isNaN(parseInt(e.root.style.right))&&(e.root.style.right="0px"),e.minX=void 0!==r?r:null,e.minY=void 0!==s?s:null,e.maxX=void 0!==i?i:null,e.maxY=void 0!==a?a:null,e.xMapper=u||null,e.yMapper=c||null,e.root.onDragStart=new Function,e.root.onDragEnd=new Function,e.root.onDrag=new Function},start:function(e){t.gradx.current_slider_id="#"+this.id;var n=t.obj=this;e=t.fixE(e);var r=parseInt(n.vmode?n.root.style.top:n.root.style.bottom),i=parseInt(n.hmode?n.root.style.left:n.root.style.right);return n.root.onDragStart(i,r),n.lastMouseX=e.clientX,n.lastMouseY=e.clientY,n.hmode?(null!=n.minX&&(n.minMouseX=e.clientX-i+n.minX),null!=n.maxX&&(n.maxMouseX=n.minMouseX+n.maxX-n.minX)):(null!=n.minX&&(n.maxMouseX=-n.minX+e.clientX+i),null!=n.maxX&&(n.minMouseX=-n.maxX+e.clientX+i)),n.vmode?(null!=n.minY&&(n.minMouseY=e.clientY-r+n.minY),null!=n.maxY&&(n.maxMouseY=n.minMouseY+n.maxY-n.minY)):(null!=n.minY&&(n.maxMouseY=-n.minY+e.clientY+r),null!=n.maxY&&(n.minMouseY=-n.maxY+e.clientY+r)),document.onmousemove=t.drag,document.onmouseup=t.end,!1},drag:function(e){e=t.fixE(e);var n=t.obj;t.gradx.update_style_array(),t.gradx.apply_style(t.gradx.panel,t.gradx.get_style_value());var r=t.gradx.gx("#"+n.id).css("left");parseInt(r)>60&&parseInt(r)<390&&t.gradx.gx("#gradx_slider_info").css("left",r).show();var i=t.gradx.gx("#"+n.id).css("backgroundColor"),s=t.gradx.get_rgb_obj(i);t.gradx.cp.colorer().set(s);var a,o,l=e.clientY,u=e.clientX,c=parseInt(n.vmode?n.root.style.top:n.root.style.bottom),h=parseInt(n.hmode?n.root.style.left:n.root.style.right);return null!=n.minX&&(u=n.hmode?Math.max(u,n.minMouseX):Math.min(u,n.maxMouseX)),null!=n.maxX&&(u=n.hmode?Math.min(u,n.maxMouseX):Math.max(u,n.minMouseX)),null!=n.minY&&(l=n.vmode?Math.max(l,n.minMouseY):Math.min(l,n.maxMouseY)),null!=n.maxY&&(l=n.vmode?Math.min(l,n.maxMouseY):Math.max(l,n.minMouseY)),a=h+(u-n.lastMouseX)*(n.hmode?1:-1),o=c+(l-n.lastMouseY)*(n.vmode?1:-1),n.xMapper?a=n.xMapper(c):n.yMapper&&(o=n.yMapper(h)),t.obj.root.style[n.hmode?"left":"right"]=a+"px",t.obj.lastMouseX=u,t.obj.lastMouseY=l,t.obj.root.onDrag(a,o),!1},end:function(){document.onmousemove=null,document.onmouseup=null,t.obj.root.onDragEnd(parseInt(t.obj.root.style[t.obj.hmode?"left":"right"]),parseInt(t.obj.root.style[t.obj.vmode?"top":"bottom"])),t.obj=null},fixE:function(t){return void 0===t&&(t=window.event),void 0===t.layerX&&(t.layerX=t.offsetX),void 0===t.layerY&&(t.layerY=t.offsetY),t}};return t}),define("skylark-domx-colors/Gradienter",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins","skylark-graphics-colors/Color","./colors","./colorer","./Drag"],function(t,e,n,r,i,s,a,o,l,u,c){"use strict";void 0===s.fn.draggable&&(s.fn.draggable=function(){var t=document.getElementById(this.attr("id"));return t.style.top="121px",c.init(t,null,26,426,86,86),this});return l.Gradienter=function(e,n){var r={targets:[],sliders:[],direction:"left",type:"linear",code_shown:!1,change:function(t,e){}},i=c.gradx={rand_RGB:[],rand_pos:[],id:null,slider_ids:[],slider_index:0,sliders:[],direction:"left",type:"linear",shape:"cover",slider_hovered:[],jQ_present:!0,code_shown:!1,load_jQ:function(){this.gx=s},add_event:function(t,e,n){var r,i,s;i=e,s=n,(r=t).attachEvent?r.attachEvent("on"+i,function(){s.call(r)}):r.addEventListener&&r.addEventListener(i,s,!1)},get_random_position:function(){var t;do{t=parseInt(100*Math.random())}while(this.rand_pos.indexOf(t)>-1);return this.rand_pos.push(t),t},get_random_rgb:function(){var t,e,n,r;do{t=parseInt(255*Math.random()),e=parseInt(255*Math.random()),n=parseInt(255*Math.random()),r="rgb("+t+", "+e+", "+n+")"}while(this.rand_RGB.indexOf(r)>-1);return this.rand_RGB.push(r),r},update_target:function(t){if(this.targets.length>0){var e,n,r,s=this.targets.length,a=t.length;for(e=0;e<s;e++)for(r=i.gx(this.targets[e]),n=0;n<a;n++)r.css("background-image",t[n])}},apply_style:function(t,e){var n="linear";if("linear"!=i.type&&(n="radial"),e.indexOf(this.direction)>-1)var r=["-webkit-"+n+"-gradient("+e+")","-moz-"+n+"-gradient("+e+")","-ms-"+n+"-gradient("+e+")","-o-"+n+"-gradient("+e+")",n+"-gradient("+e+")"];else r=[e];for(var s=r.length,a="";s>0;)s--,t.css("background",r[s]),a+="background: "+r[s]+";\n";this.change(this.sliders,r),this.update_target(r),i.gx("#gradx_code").html(a)},apply_default_styles:function(){this.update_style_array();var t=this.get_style_value();this.apply_style(this.panel,t)},update_style_array:function(){this.sliders=[];var t,e,n,r,s=i.slider_ids.length;for(t=0;t<s;t++)r="#"+i.slider_ids[t],e=parseInt(i.gx(r).css("left")),n=parseInt(e/i.container_width*100),n-=6,i.sliders.push([i.gx(r).css("background-color"),n]);this.sliders.sort(function(t,e){return t[1]>e[1]?1:-1})},get_style_value:function(){var t=i.slider_ids.length;if(1===t)e=this.sliders[0][0];else{for(var e="",n="",r=0;r<t;r++)""==this.sliders[r][1]?e+=n+this.sliders[r][0]:(this.sliders[r][1]>100&&(this.sliders[r][1]=100),e+=n+(this.sliders[r][0]+" ")+this.sliders[r][1]+"%"),n=" , ";e="linear"==this.type?this.direction+" , "+e:this.direction+" , "+this.type+" "+this.shape+" , "+e}return e},get_rgb_obj:function(t){return t=(t=(t=t.split("("))[1]).split(","),{r:parseInt(t[0]),g:parseInt(t[1]),b:parseInt(t[2])}},load_info:function(t){var e="#"+t.id;if(this.current_slider_id=e,this.slider_ids.indexOf(t.id)>-1){var n=i.gx(e).css("backgroundColor"),r=this.get_rgb_obj(n),s=i.gx(e).css("left");parseInt(s)>26&&parseInt(s)<426&&i.gx("#gradx_slider_info").css("left",s).show(),this.set_colorpicker(r),console.log(r)}},add_slider:function(t){var e,n,r,s;0===t.length&&(t=[{color:i.get_random_rgb(),position:i.get_random_position()},{color:i.get_random_rgb(),position:i.get_random_position()}]);var a=t;for(r in a){if(void 0===a[r].position)break;var o=26;s=parseInt(a[r].position*this.container_width/100)+o+"px",e="gradx_slider_"+this.slider_index,this.sliders.push([a[r].color,a[r].position]),this.slider_ids.push(e),n="<div class='gradx_slider' id='"+e+"'></div>",i.gx("#gradx_start_sliders_"+this.id).append(n),i.gx("#"+e).css("backgroundColor",a[r].color).css("left",s),this.slider_index++}for(var l=0,u=this.slider_ids.length;l<u;l++)i.gx("#"+this.slider_ids[l]).draggable({containment:"parent",axis:"x",start:function(){i.jQ_present&&(i.current_slider_id="#"+i.gx(this).attr("id"))},drag:function(){i.update_style_array(),i.apply_style(i.panel,i.get_style_value());var t=i.gx(i.current_slider_id).css("left");parseInt(t)>26&&parseInt(t)<426&&i.gx("#gradx_slider_info").css("left",t).show();var e=i.gx(i.current_slider_id).css("backgroundColor"),n=i.get_rgb_obj(e);i.cp.colorer().set(n)}}).click(function(){return i.load_info(this),!1})},set_colorpicker:function(t){i.cp.colorer({picked:function(t,e){if(0!=i.current_slider_id){var n=e.toRgbString();i.gx(i.current_slider_id).css("background-color",n),i.update_style_array(),i.apply_style(i.panel,i.get_style_value())}},choosed:function(t){i.gx("#gradx_slider_info").hide()},canceled:function(t){i.gx("#gradx_slider_info").hide()},flat:!0,showAlpha:!0,color:t,clickoutFiresChange:!0,showInput:!0,showButtons:!1})},generate_options:function(t){for(var e,n,r=t.length,i="",s=0;s<r;s++)e=(e=t[s].split(" "))[0],n=s<2?e[1]:"",e=e.replace("-"," "),i+="<option value="+t[s]+" "+n+">"+e+"</option>";return i},generate_radial_options:function(){var t;t=["horizontal-center disabled","center selected","left","right"],i.gx("#gradx_gradient_subtype").html(i.generate_options(t)),t=["vertical-center disabled","center selected","top","bottom"],i.gx("#gradx_gradient_subtype2").html(i.generate_options(t)).show()},generate_linear_options:function(){var t;t=["horizontal-center disabled","left selected","right","top","bottom"],i.gx("#gradx_gradient_subtype").html(i.generate_options(t)),i.gx("#gradx_gradient_subtype2").hide()},destroy:function(){var t={targets:[],sliders:[],direction:"left",type:"linear",code_shown:!1,change:function(t,e){}};for(var e in t)i[e]=t[e]},load_gradx:function(t,e){this.me=i.gx(t),this.id=t.replace("#",""),t=this.id,this.current_slider_id=!1;var n="<div class='gradx'>\n<div id='gradx_add_slider' class='gradx_add_slider gradx_btn'><i class='icon icon-add'></i>add</div>\n<div class='gradx_slectboxes'>\n<select id='gradx_gradient_type' class='gradx_gradient_type'>\n    <option value='linear'>Linear</option>\n    <option value='circle'>Radial - Circle</option>\n    <option value='ellipse'>Radial - Ellipse</option>\n</select>\n<select id='gradx_gradient_subtype' class='gradx_gradient_type'>\n    <option id='gradx_gradient_subtype_desc' value='gradient-direction' disabled>gradient direction</option>\n    <option value='left' selected>Left</option>\n    <option value='right'>Right</option>\n    <option value='top'>Top</option>\n    <option value='bottom'>Bottom</option>\n</select>\n<select id='gradx_gradient_subtype2' class='gradx_gradient_type gradx_hide'>\n</select>\n<select id='gradx_radial_gradient_size' class='gradx_gradient_type gradx_hide'>\n</select>\n</div>\n<div class='gradx_container' id='gradx_"+t+"'>\n    <div id='gradx_stop_sliders_"+t+"'></div>\n    <div class='gradx_panel' id='gradx_panel_"+t+"'></div>\n    <div class='gradx_start_sliders' id='gradx_start_sliders_"+t+"'>\n        <div class='cp-default' id='gradx_slider_info'>\n            <div id='gradx_slider_controls'>\n                <div id='gradx_delete_slider' class='gradx_btn'><i class='icon icon-remove'></i>delete</div>\n            </div>\n            <div id='gradx_slider_content'></div>\n        </div> \n    </div>\n</div>\n<div id='gradx_show_code' class='gradx_show_code gradx_btn'><i class='icon icon-file-css'></i><span>show the code</span></div>\n<div id='gradx_show_presets' style='display:none' class='gradx_show_presets gradx_btn'><i class='icon icon-preset'></i><span>show presets</span></div>\n<textarea class='gradx_code' id='gradx_code'></textarea>\n</div>";this.me.html(n);var r="";if(r=i.generate_options(["gradient-size disabled","closest-side selected","closest-corner","farthest-side","farthest-corner","contain","cover"]),i.gx("#gradx_radial_gradient_size").html(r),this.container=i.gx("#gradx_"+t),this.panel=i.gx("#gradx_panel_"+t),this.container_width=400,this.add_slider(e),i.add_event(document,"click",function(){if(!i.slider_hovered[t])return i.gx("#gradx_slider_info").hide(),!1}),i.gx("#gradx_add_slider").click(function(){i.add_slider([{color:i.get_random_rgb(),position:i.get_random_position()}]),i.update_style_array(),i.apply_style(i.panel,i.get_style_value())}),i.cp=i.gx("#gradx_slider_content"),i.set_colorpicker("blue"),i.gx("#gradx_delete_slider").click(function(){i.gx(i.current_slider_id).remove(),i.gx("#gradx_slider_info").hide();for(var t=i.current_slider_id.replace("#",""),e=0;e<i.slider_ids.length;e++)i.slider_ids[e]==t&&i.slider_ids.splice(e,1);i.update_style_array(),i.apply_style(i.panel,i.get_style_value()),i.current_slider_id=!1}),i.gx("#gradx_code").focus(function(){var t=i.gx(this);t.select(),t.mouseup(function(){return t.off("mouseup"),!1})}),i.gx("#gradx_gradient_type").change(function(){var t=i.gx(this).val();"linear"!==t?i.generate_radial_options():(i.generate_linear_options(),i.gx("#gradx_gradient_subtype").val("left")),i.type=t,i.direction=i.gx("#gradx_gradient_subtype").val(),i.apply_style(i.panel,i.get_style_value())}),"linear"!==this.type){var s;if(i.gx("#gradx_gradient_type").val(this.type),i.generate_radial_options(),"left"!==this.direction)s=this.direction.indexOf(",")>-1?this.direction.split(","):this.direction.split(" "),a=s[0],o=s[1],i.gx("#gradx_gradient_subtype").val(a),i.gx("#gradx_gradient_subtype2").val(o);else var a=i.gx("#gradx_gradient_subtype").val(),o=i.gx("#gradx_gradient_subtype2").val();i.direction=a+" "+o,i.apply_style(i.panel,i.get_style_value())}else"left"!==this.direction&&i.gx("#gradx_gradient_subtype").val(this.direction);i.gx("#gradx_gradient_subtype").change(function(){if("linear"===i.type)i.direction=i.gx(this).val();else{var t=i.gx(this).val(),e=i.gx("#gradx_gradient_subtype2").val();i.direction=t+" "+e}i.apply_style(i.panel,i.get_style_value())}),i.gx("#gradx_gradient_subtype2").change(function(){var t=i.gx("#gradx_gradient_subtype").val(),e=i.gx(this).val();i.direction=t+" "+e,i.apply_style(i.panel,i.get_style_value())}),i.gx("#gradx_radial_gradient_size").change(function(){i.shape=i.gx(this).val(),i.apply_style(i.panel,i.get_style_value())}),i.gx("#gradx_show_code").click(function(){i.code_shown?(i.code_shown=!1,i.gx("#gradx_show_code span").text("show the code"),i.gx("#gradx_code").hide()):(i.gx("#gradx_show_code span").text("hide the code"),i.gx("#gradx_code").show(),i.code_shown=!0)}),i.code_shown&&(i.gx("#gradx_show_code span").text("hide the code"),i.gx("#gradx_code").show()),i.add_event(document.getElementById("gradx_slider_info"),"mouseout",function(){i.slider_hovered[t]=!1}),i.add_event(document.getElementById("gradx_slider_info"),"mouseover",function(){i.slider_hovered[t]=!0})}};for(var a in i.load_jQ(),t.mixin(r,n),r)i[a]=r[a];i.load_gradx(e,i.sliders),i.apply_default_styles()}}),define("skylark-domx-colors/main",["skylark-domx-query","./colors","./colorer","./ColorPalette","./ColorPicker","./ColorPane","./Gradienter"],function(t,e,n){return e}),define("skylark-domx-colors",["skylark-domx-colors/main"],function(t){return t}),define("skylark-domx-forms/forms",["skylark-langx/skylark"],function(t){return t.attach("domx.forms",{})}),define("skylark-domx-forms/deserialize",["skylark-langx/langx","skylark-domx-query","./forms"],function(t,e,n){function r(t,e,n){var r=n[t];return void 0===r?n[t]=[e]:r.push(e),n}var i={checked:["radio","checkbox"],selected:["option","select-one","select-multiple"],value:["button","color","date","datetime","datetime-local","email","hidden","month","number","password","range","reset","search","submit","tel","text","textarea","time","url","week"]};function s(e,n,r,s,a){var o=function(e){var n=function(t){return(t.type||t.nodeName).toLowerCase()}(e),r=void 0;return t.each(i,function(e,i){if(t.inArray(n,i)>-1)return r=e,!1}),r}(e);if("value"==o&&n==s)e.value=r,a.call(e,r);else if("checked"==o||"selected"==o){var l=[];e.options?t.each(e.options,function(t,e){l.push(e)}):l.push(e),e.multiple&&0==s&&(e.selectedIndex=-1),t.each(l,function(t,e){e.value==r&&(e[o]=!0,a.call(e,r))})}}var a={change:t.noop,complete:t.noop};return n.deserialize=function(n,i,o){t.isFunction(o)&&(o={complete:o});o=t.extend(a,o||{}),i=function(e){var n={},i=/\+/g;t.isPlainObject(e)?(t.extend(n,e),t.each(n,function(e,r){t.isArray(r)||(n[e]=[r])})):t.isArray(e)?t.each(e,function(t,e){r(e.name,e.value,n)}):"string"==typeof e&&t.each(e.split("&"),function(t,e){var s=e.split("="),a=decodeURIComponent(s[0].replace(i,"%20")),o=decodeURIComponent(s[1].replace(i,"%20"));r(a,o,n)});return n}(i);var l=function(n,i){var s={},a=e(n).map(function(){return this.elements?t.makeArray(this.elements):this}).filter(i||":input:not(:disabled)").get();return t.each(a,function(t,e){r(e.name,e,s)}),s}(n,o.filter);return t.each(i,function(e,n){t.each(l[e],function(e,r){t.each(n,function(t,n){s(r,e,n,t,o.change)})})}),o.complete.call(n),this}}),define("skylark-domx-forms/serializeArray",["skylark-langx/langx","skylark-domx-data","./forms"],function(t,e,n){return n.serializeArray=function(n){var r,i,s=[],a=function(t){if(t.forEach)return t.forEach(a);s.push({name:r,value:t})};return t.each(n.elements,function(t,n){i=n.type,(r=n.name)&&"fieldset"!=n.nodeName.toLowerCase()&&!n.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||n.checked)&&a(e.val(n))}),s}}),define("skylark-domx-forms/serializeObject",["skylark-langx/langx","./forms","./serializeArray"],function(t,e,n){return e.serializeObject=function(e){var r={};return t.each(n(e),function(e,n){var i=n.name,s=n.value;r[i]=void 0===r[i]?s:t.isArray(r[i])?r[i].concat(s):[r[i],s]}),r}}),define("skylark-domx-forms/serialize",["skylark-langx/langx","./forms","./serializeArray"],function(t,e,n){return e.serialize=function(t){var e=[];return n(t).forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")}}),define("skylark-domx-forms/main",["./forms","skylark-domx-velm","skylark-domx-query","./deserialize","./serializeArray","./serializeObject","./serialize"],function(t,e,n){return e.delegate(["deserialize","serializeArray","serializeObject","serialize"],t),n.fn.deserialize=n.wraps.wrapper_value(t.deserialize,t,t.deserialize),n.fn.serializeArray=n.wraps.wrapper_value(t.serializeArray,t,t.serializeArray),n.fn.serializeObject=n.wraps.wrapper_value(t.serializeObject,t,t.serializeObject),n.fn.serialize=n.wraps.wrapper_value(t.serialize,t,t.serialize),t}),define("skylark-domx-forms",["skylark-domx-forms/main"],function(t){return t}),define("skylark-jquery/core",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-data","skylark-domx-eventer","skylark-domx-finder","skylark-domx-forms","skylark-domx-fx","skylark-domx-styler","skylark-domx-query","skylark-domx-scripter"],function(t,e,n,r,i,s,a,o,l,u,c,h){var f,d=Array.prototype.filter;Array.prototype.slice;return(f=c).fn.jquery="2.2.0",f.browser=n,f.camelCase=e.camelCase,f.cleanData=function(t){for(var e,n=0;void 0!==(e=t[n]);n++)i.cleanData(e)},f.removeData=function(t,e){i.removeData(t,e)},f.each=e.each,f.extend=e.extend,f.grep=function(t,e){return d.call(t,e)},f.attr=function(t,e){return i.attr(t,e)},f.isArray=e.isArray,f.isEmptyObject=e.isEmptyObject,f.isFunction=e.isFunction,f.isWindow=e.isWindow,f.isPlainObject=e.isPlainObject,f.isNumeric=e.isNumber,f.inArray=e.inArray,f.makeArray=e.makeArray,f.map=e.map,f.noop=function(){},f.parseJSON=window.JSON.parse,f.proxy=e.proxy,f.trim=e.trim,f.type=e.type,f.fn.extend=function(t){e.mixin(f.fn,t)},function(t){t.Event=function(t,n){if(e.isString(t)){var r=t;return s.create(r,n)}return s.proxy(t,n)},t.event={},t.event.special=s.special,t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this},t.fn.triggerHandler=t.fn.trigger,t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.bind=function(t,e,n,r){return this.on(t,e,n,r)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.ready=function(t){return s.ready(t),this},t.fn.stop=function(){return this},t.fn.moveto=function(t,e){return this.animate({left:t+"px",top:e+"px"},.4)},t.ready=s.ready,t.on=s.on,t.off=s.off}(c),function(t){t.uuid=0,t.support=n.support,t.expr={},t.expr[":"]=t.expr.pseudos=t.expr.filters=a.pseudos,t.expr.createPseudo=function(t){return t},t.cssHooks=u.cssHooks,t.contains=r.contains,t.css=u.css,t.data=i.data,t.fx=l,t.fx.step={},t.speed=function(e,n,r){var i=e&&"object"==typeof e?t.extend({},e):{complete:r||!r&&n||t.isFunction(e)&&e,duration:e,easing:r&&n||n&&!t.isFunction(n)&&n};return t.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in t.fx.speeds?i.duration=t.fx.speeds[i.duration]:i.duration=t.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){t.isFunction(i.old)&&i.old.call(this),i.queue&&t.dequeue(this,i.queue)},i},t.easing={},t.offset={},t.offset.setOffset=function(e,n,r){var i=t.css(e,"position");"static"===i&&(e.style.position="relative");var s,a,o=t(e),l=o.offset(),u=t.css(e,"top"),c=t.css(e,"left"),h=("absolute"===i||"fixed"===i)&&t.inArray("auto",[u,c])>-1,f={},d={};h?(d=o.position(),s=d.top,a=d.left):(s=parseFloat(u)||0,a=parseFloat(c)||0),t.isFunction(n)&&(n=n.call(e,r,l)),null!=n.top&&(f.top=n.top-l.top+s),null!=n.left&&(f.left=n.left-l.left+a),"using"in n?n.using.call(e,f):o.css(f)},t._data=function(t,e){return t.hasAttribute?i.data(t,e):{}};var e=t.fn.text;t.fn.text=function(t){var n=e.apply(this,arguments);return void 0===n&&(n=""),n},t.fn.pos=t.fn.position}(c),c.parseHTML=function(t){return r.createFragment(t)},c.uniqueSort=c.unique=e.uniq,c.skylark=t,window.jQuery=window.$=c}),define("skylark-jquery/ajax",["skylark-langx/langx","skylark-net-http/Xhr","./core"],function(t,e,n){var r=0;function i(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function s(t,e,r,i){return n.isFunction(t)?(i=e,r=t,e=void 0,t=void 0):n.isFunction(e)&&(i=r,r=e,e=void 0),n.isFunction(r)||(i=r,r=void 0),{url:t,data:e,success:r,dataType:i}}n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){n.fn[e]=function(t){return this.on(e,t)}}),n.ajaxJSONP=function(e){var s,a,o=new t.Deferred,l=e.jsonpCallback,u=(n.isFunction(l)?l():l)||"jsonp"+ ++r,c=document.createElement("script"),h=window[u],f=function(t){n(c).triggerHandler("error",t||"abort")},d={abort:f};for(var p in e.data)e.url=i(e.url,p+"="+e.data[p]);return n(c).on("load error",function(t,e){clearTimeout(a),n(c).off().remove(),"error"!=t.type&&s?o.resolve(s[0],200,d):o.reject(t),window[u]=h,s&&n.isFunction(h)&&h(s[0]),h=s=void 0}),window[u]=function(){s=arguments},c.src=e.url.replace(/\?(.+)=\?/,"?$1="+u),document.head.appendChild(c),e.timeout>0&&(a=setTimeout(function(){f("timeout")},e.timeout)),o},n.ajaxSettings={processData:!0},n.ajax=function(r,s){if(r?s?s.url=r:s=t.isString(r)?{url:r}:r:s={url:"./"},"jsonp"==(s=t.mixin({},n.ajaxSettings,s)).dataType){var a=/\?.+=\?/.test(s.url);return a||(s.url=i(s.url,s.jsonp?s.jsonp+"=?":!1===s.jsonp?"":"callback=?")),n.ajaxJSONP(s)}var o=e.request(s.url,s);return(o=o.then(function(t,e,r){n(document).trigger("ajaxSucess"),s.success&&s.success.apply(this,arguments);s.complete&&s.complete.apply(this,arguments);return t},function(){n(document).trigger("ajaxError"),s.error&&s.error.apply(this,arguments)})).success=o.done,o.error=o.fail,o.complete=o.always,o},n.get=function(){return n.ajax(s.apply(null,arguments))},n.post=function(){var t=s.apply(null,arguments);return t.type="POST",n.ajax(t)},n.getJSON=function(){var t=s.apply(null,arguments);return t.dataType="json",n.ajax(t)};var a=n.fn.load;function o(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,s=e.toLowerCase().match(l)||[];if(jQuery.isFunction(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}n.fn.load=function(t,e,r){if("string"!=typeof t&&a)return a.apply(this,arguments);if(!this.length)return this;var i,o=this,l=s(t,e,r),u=l.url&&l.url.split(/\s/),c=l.success;return u&&u.length>1&&(l.url=u[0],i=u[1]),l.data&&"object"==typeof l.data&&(l.type="POST"),l.success=function(t){o.html(i?n("<div>").html(t.replace(rscript,"")).find(i):t),c&&c.apply(o,arguments)},n.ajax(l),this},n.param=e.param;var l=/\S+/g;return n.ajaxPrefilter=o({}),n.ajaxTransport=o({}),n.ajaxSetup=function(n,r){t.mixin(e.defaultOptions,n,r)},n.getScript=function(t,e){return n.get(t,void 0,e,"script")},n}),define("skylark-jquery/callbacks",["./core"],function(t){return t.Callbacks=function(e){var n,r,i,s,a,o,l=[],u=!(e=t.extend({},e)).once&&[],c=function(t){for(n=e.memory&&t,r=!0,o=s||0,s=0,a=l.length,i=!0;l&&o<a;++o)if(!1===l[o].apply(t[0],t[1])&&e.stopOnFalse){n=!1;break}i=!1,l&&(u?u.length&&c(u.shift()):n?l.length=0:h.disable())},h={add:function(){if(l){var r=l.length,o=function(n){t.each(n,function(t,n){"function"==typeof n?e.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!=typeof n&&o(n)})};o(arguments),i?a=l.length:n&&(s=r,c(n))}return this},remove:function(){return l&&t.each(arguments,function(e,n){for(var r;(r=t.inArray(n,l,r))>-1;)l.splice(r,1),i&&(r<=a&&--a,r<=o&&--o)}),this},has:function(e){return!(!l||!(e?t.inArray(e,l)>-1:l.length))},empty:function(){return a=l.length=0,this},disable:function(){return l=u=n=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,n||h.disable(),this},locked:function(){return!u},fireWith:function(t,e){return!l||r&&!u||(e=[t,(e=e||[]).slice?e.slice():e],i?u.push(e):c(e)),this},fire:function(){return h.fireWith(this,arguments)},fired:function(){return!!r}};return h},t}),define("skylark-jquery/deferred",["./core","skylark-langx/langx"],function(t,e){return t.Deferred=function(){var t=new e.Deferred,n={promise:function(){return t.promise}};return["resolve","resolveWith","reject","rejectWith","notify","then","done","fail","progress","always","state"].forEach(function(e){n[e]=function(){var r=t[e].apply(t,arguments);return r==t&&(r=n),r}}),n},t.when=function(){var t=e.Deferred.all(e.makeArray(arguments)),n=t.then;return t.then=function(e,r){return n.call(t,function(t){return e&&e.apply(null,t)},r)},t},t}),define("skylark-jquery/queue",["skylark-langx/langx","./core","./callbacks"],function(t,e){var n="Sky"+("1.0"+Math.random()).replace(/\D/g,""),r=/\S+/g,i=[].push;function s(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n+Math.random()}s.uid=1,s.accepts=function(t){return!t.nodeType||(1===t.nodeType||9===t.nodeType)},s.prototype={key:function(t){if(!s.accepts(t))return 0;var n={},r=t[this.expando];if(!r){r=s.uid++;try{n[this.expando]={value:r},Object.defineProperties(t,n)}catch(i){n[this.expando]=r,e.extend(t,n)}}return this.cache[r]||(this.cache[r]={}),r},set:function(t,n,r){var i,s=this.key(t),a=this.cache[s];if("string"==typeof n)a[n]=r;else if(e.isEmptyObject(a))e.extend(this.cache[s],n);else for(i in n)a[i]=n[i];return a},get:function(t,e){var n=this.cache[this.key(t)];return void 0===e?n:n[e]},access:function(t,n,r){var i;return void 0===n||n&&"string"==typeof n&&void 0===r?void 0!==(i=this.get(t,n))?i:this.get(t,e.camelCase(n)):(this.set(t,n,r),void 0!==r?r:n)},remove:function(t,n){var i,s,a,o=this.key(t),l=this.cache[o];if(void 0===n)this.cache[o]={};else{e.isArray(n)?s=n.concat(n.map(e.camelCase)):(a=e.camelCase(n),s=n in l?[n,a]:(s=a)in l?[s]:s.match(r)||[]),i=s.length;for(;i--;)delete l[s[i]]}},hasData:function(t){return!e.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var a=new s;return e.extend(e,{queue:function(t,n,r){var i;if(t)return n=(n||"fx")+"queue",i=a.get(t,n),r&&(!i||e.isArray(r)?i=a.access(t,n,e.makeArray(r)):i.push(r)),i||[]},dequeue:function(t,n){n=n||"fx";var r=e.queue(t,n),i=r.length,s=r.shift(),a=e._queueHooks(t,n);"inprogress"===s&&(s=r.shift(),i--),s&&("fx"===n&&r.unshift("inprogress"),delete a.stop,s.call(t,function(){e.dequeue(t,n)},a)),!i&&a&&a.empty.fire()},_queueHooks:function(t,n){var r=n+"queueHooks";return a.get(t,r)||a.access(t,r,{empty:e.Callbacks("once memory").add(function(){a.remove(t,[n+"queue",r])})})},makeArray:function(t,n){var r=n||[];return null!=t&&(!function(t){var n=t.length,r=e.type(t);if(e.isWindow(t))return!1;if(1===t.nodeType&&n)return!0;return"array"===r||"function"!==r&&(0===n||"number"==typeof n&&n>0&&n-1 in t)}(Object(t))?i.call(r,t):e.merge(r,"string"==typeof t?[t]:t)),r},merge:function(t,e){var n=e.length,r=t.length,i=0;if("number"==typeof n)for(;i<n;i++)t[r++]=e[i];else for(;void 0!==e[i];)t[r++]=e[i++];return t.length=r,t}}),e.extend(e.fn,{queue:function(t,n){var r=2;return"string"!=typeof t&&(n=t,t="fx",r--),arguments.length<r?e.queue(this[0],t):void 0===n?this:this.each(function(){var r=e.queue(this,t,n);e._queueHooks(this,t),"fx"===t&&"inprogress"!==r[0]&&e.dequeue(this,t)})},dequeue:function(t){return this.each(function(){e.dequeue(this,t)})},delay:function(t,n){return t=e.fx&&e.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(e,n){var r=setTimeout(e,t);n.stop=function(){clearTimeout(r)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,n){var r,i=1,s=e.Deferred(),o=this,l=this.length,u=function(){--i||s.resolveWith(o,[o])};for("string"!=typeof t&&(n=t,t=void 0),t=t||"fx";l--;)(r=a.get(o[l],t+"queueHooks"))&&r.empty&&(i++,r.empty.add(u));return u(),s.promise(n)}}),e}),define("skylark-jquery/JqueryPlugin",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx/langx","skylark-domx-data","skylark-domx-eventer","skylark-domx-plugins","skylark-domx-query"],function(t,e,n,r,i,s,a,o){var l=0,u=a.Plugin.inherit({klassName:"JqPlugin",pluginEventPrefix:"",options:{create:null},destroy:function(){this.overrided(),this.element.off(this.eventNamespace),this.bindings.off(this.eventNamespace)},_construct:function(t,e){t=o(t||this.defaultElement||this)[0],this.element=o(t),this.uuid=l++,this.eventNamespace="."+this.pluginName+this.uuid,this.bindings=o(),this.classesElementLookup={},this.hoverable=o(),this.focusable=o(),t!==this&&(i.data(t,this.pluginName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=o(t.style?t.ownerDocument:t.document||t),this.window=o(this.document[0].defaultView||this.document[0].parentWindow)),this.overrided(t,e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_initOptions:function(t){t=r.mixin(this._getCreateOptions(),t),this.overrided(t)},_getCreateOptions:function(){return{}},_getCreateEventData:r.noop,_super:function(){if(this.overrided)return this.overrided.apply(this,arguments)},_superApply:function(t){if(this.overrided)return this.overrided.apply(this,t)},_create:r.noop,_init:r.noop,_classes:function(t){var n=[],i=this;function s(e,s){var a,l;for(l=0;l<e.length;l++)a=i.classesElementLookup[e[l]]||o(),t.add?(t.element.each(function(t,e){var n=r.map(i.classesElementLookup,function(t){return t}).some(function(t){return o(t).is(e)});n||i._on(o(e),{remove:"_untrackClassesElement"})}),a=o(r.uniq(a.get().concat(t.element.get())))):a=o(a.not(t.element).get()),i.classesElementLookup[e[l]]=a,n.push(e[l]),s&&t.classes[e[l]]&&n.push(t.classes[e[l]])}return(t=e.mixin({element:this.element,classes:this.options.classes||{}},t)).keys&&s(t.keys.match(/\S+/g)||[],!0),t.extra&&s(t.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(t){var e=this;r.each(e.classesElementLookup,function(r,i){-1!==n.inArray(t.target,i)&&(e.classesElementLookup[r]=o(i.not(t.target).get()))}),this._off(o(t.target))},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,r){r="boolean"==typeof r?r:n;var i="string"==typeof t||null===t,s={extra:i?e:n,keys:i?t:e,element:i?this.element:t,add:r};return s.element.toggleClass(this._classes(s),r),this},_on:function(t,n,r){var i,s=this;"boolean"!=typeof t&&(r=n,n=t,t=!1),r?(n=i=o(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(e,r){function a(){if(t||!0!==s.options.disabled&&!o(this).hasClass("ui-state-disabled"))return("string"==typeof r?s[r]:r).apply(s,arguments)}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||o.guid++);var l=e.match(/^([\w:-]*)\s*(.*)$/),u=l[1]+s.eventNamespace,c=l[2];c?i.on(u,c,a):n.on(u,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(e),this.bindings=o(this.bindings.not(t).get()),this.focusable=o(this.focusable.not(t).get()),this.hoverable=o(this.hoverable.not(t).get())},_trigger:function(e,n,r){var i,a,o=this.options[e];if(r=r||{},(n=s.proxy(n)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],a=n.originalEvent)for(i in a)i in n||(n[i]=a[i]);return this.element.trigger(n,r),!(t.isFunction(o)&&!1===o.apply(this.element[0],[n].concat(r))||n.isDefaultPrevented())},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})}});return u}),define("skylark-jquery/widget",["skylark-langx/langx","skylark-domx-plugins","./core","./JqueryPlugin"],function(t,e,n,r){var i,s=Array.prototype.hasOwnProperty,a=Array.prototype.slice;return n.cleanData=(i=n.cleanData,function(t){var e,r,s;for(s=0;null!=(r=t[s]);s++)(e=n._data(r,"events"))&&e.remove&&n(r).triggerHandler("remove");i(t)}),n.widget=function(t,r,i){var s,a,o=t.split(".")[0];t=t.split(".")[1];var l=o+"-"+t;i||(i=r,r=n.Widget),n.isArray(i)&&(i=n.extend.apply(null,[{}].concat(i))),n.expr.pseudos[l.toLowerCase()]=function(t){return!!n.data(t,l)},n[o]=n[o]||{},s=n[o][t];var u=r.prototype,c={};for(var h in i){var f=i[h];n.isPlainObject(f)?c[h]=n.isPlainObject(u[h])?n.widget.extend({},u[h],f):n.widget.extend({},f):c[h]=f}var d=n.widget.extend({widgetEventPrefix:s&&r.prototype.widgetEventPrefix||t},{options:r.prototype.options},c,{name:l,namespace:o,widgetName:t,pluginName:"jqueryui."+(o?o+".":"")+t,widgetFullName:l});return a=n[o][t]=r.inherit(d),n.extend(a,s,{version:i.version,_proto:d,_childConstructors:[]}),s?(n.each(s._childConstructors,function(t,e){var r=e.prototype;n.widget(r.namespace+"."+r.widgetName,a,e._proto)}),delete s._childConstructors):r._childConstructors&&r._childConstructors.push(a),e.register(a,t,l),a},n.widget.extend=function(t){for(var e,r,i=a.call(arguments,1),o=0,l=i.length;o<l;o++)for(e in i[o])r=i[o][e],s.call(i[o],e)&&void 0!==r&&(n.isPlainObject(r)?t[e]=n.isPlainObject(t[e])?n.widget.extend({},t[e],r):n.widget.extend({},r):t[e]=r);return t},n.Widget=r.inherit({widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},widget:function(){return this.element},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(t){var e,r,i;for(e in t)i=this.classesElementLookup[e],t[e]!==this.options.classes[e]&&i&&i.length&&(r=n(i.get()),this._removeClass(i,e),r.addClass(this._classes({element:r,keys:e,classes:t,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_delay:function(t,e){var n=this;return setTimeout(function(){return("string"==typeof t?n[t]:t).apply(n,arguments)},e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(n(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(n(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(n(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(n(t.currentTarget),null,"ui-state-focus")}})}}),n.Widget._childConstructors=[],n.each({show:"fadeIn",hide:"fadeOut"},function(t,e){n.Widget.prototype["_"+t]=function(r,i,s){var a;"string"==typeof i&&(i={effect:i});var o=i?!0===i||"number"==typeof i?e:i.effect||e:t;"number"==typeof(i=i||{})&&(i={duration:i}),a=!n.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),a&&n.effects&&n.effects.effect[o]?r[t](i):o!==t&&r[o]?r[o](i.duration,i.easing,s):r.queue(function(e){n(this)[t](),s&&s.call(r[0]),e()})}}),n.widget}),define("skylark-jquery/main",["./core","./ajax","./callbacks","./deferred","./queue","./JqueryPlugin","./widget"],function(t){return t}),define("skylark-jquery",["skylark-jquery/main"],function(t){return t}),define("skylark-ajaxify-routers/routers",["skylark-langx/skylark","skylark-langx/langx"],function(t,e){return t.attach("ajaxify.routers",{createEvent:function(t,n){var r=new CustomEvent(t,n);return e.safeMixin(r,n)}})}),define("skylark-ajaxify-routers/Route",["skylark-langx/langx","./routers"],function(t,e){var n=e.createEvent,r=t.Evented.inherit({klassName:"Route",init:function(e,n){var r=(n=t.mixin({},n)).pathto||"",i=r,s=i.match(/\:([a-zA-Z0-9_]+)/g);null!==s?(s=s.map(function(t){return t.substring(1)}),i=i.replace(/\:([a-zA-Z0-9_]+)/g,"(.*?)")):s=[],i="*"===i?"(.*)":i.replace("/","\\/"),this._setting=n,this.name=e,this.pathto=r,this.paramNames=s,this.params=i,this.regex=new RegExp("^"+i+"$","");var a=this;["entering","entered","exiting","exited"].forEach(function(e){t.isFunction(n[e])&&a.on(e,n[e])})},enter:function(e,r){if(r){var i=this._entering(e),s=this;return t.Deferred.when(i).then(function(){var t=n("entering",{route:s,result:!0});return s.trigger(t),t.result})}return this._entered(e),this.trigger(n("entered",t.safeMixin({route:this},e))),this},exit:function(e,r){if(r){var i=this._exiting(e);if(!i)return!1;var s=n("exiting",{route:this,result:!0});return this.trigger(s),s.result}return this._exited(e),this.trigger(n("exited",t.safeMixin({route:this},e))),this},match:function(t){var e=this.paramNames,n=t.indexOf("?"),t=~n?t.slice(0,n):decodeURIComponent(t),r=this.regex.exec(t);if(!r)return!1;for(var i={},s=1,a=r.length;s<a;++s){var o=e[s-1],l=decodeURIComponent(r[s]);i[o]=l}return i},path:function(t){var e=this.pathto;return t&&(e=e.replace(/:([a-zA-Z0-9_]+)/g,function(e,n){return t[n]})),e},_entering:function(t){return!0},_entered:function(t){return!0},_exiting:function(t){return!0},_exited:function(t){return!0}});return e.Route=r}),define("skylark-ajaxify-routers/Router",["skylark-langx/langx","./routers","./Route"],function(t,e,n){var r=e.createEvent;return e.Router=function(){var e,i,s,a,o={},l={},u=new t.Evented,c=this;function h(n){if(e){var s=e.route.exit({path:e.path,params:e.params},!0);if(!s)return}if(i=e,!(e=n).route){var a=d(e.path);e.route=a.route,e.params=a.params}var o=e.route.enter({force:e.force,path:e.path,params:e.params},!0);t.Deferred.when(o).then(function(){u.trigger(r("routing",{current:e,previous:i})),e.route.enter({path:e.path,params:e.params},!1),i&&i.route.exit({path:i.path,params:i.params},!1),u.trigger(r("routed",{current:e,previous:i}))})}function f(t,n){if(!n&&e&&e.path==t)return!1;var i=d(t);if(i)if(i.path=t,c.useHistoryApi){var a={force:n,path:t};window.history.pushState(a,document.title,(s+t).replace("//","/")),window.dispatchEvent(r("popstate",{state:a}))}else if(c.useHashbang){var o="#!"+t;window.location.hash!==o?window.location.hash=o:h(i)}else h(i);return!0}function d(e,n){var r=!1;return!n&&(r=l[e])?r:(t.each(o,function(t,n){var i=n.match(e);return!i||(r={route:n,params:i},!1)}),r&&!n&&(l[e]=r),r)}function p(e){if(!t.isDefined(e))return t.mixin({},o);for(var n in e)o[n]=new c.Route(n,e[n])}t.mixin(c,{Route:n,current:function(){return e},go:f,map:d,hub:function(){return u},off:function(){u.off.apply(u,arguments)},on:function(){u.on.apply(u,arguments)},one:function(){u.one.apply(u,arguments)},path:function(t,e){var n,r=o[t];r&&(n=r.path(e));return n},previous:function(){return i},baseUrl:function(e){return t.isDefined(e)?(s=e,this):s},homePath:function(e){return t.isDefined(e)?(a=e,this):a},route:function(e,n){if(t.isDefined(n)){var r={};return r[e]=n,p(r),this}return o[e]},routes:p,start:function(){null==c.useHashbang&&null==c.useHistoryApi&&(window.location.host&&window.history.pushState?c.useHistoryApi=!0:c.useHashbang=!0);var t="";c.useHistoryApi?(t=window.location.pathname,void 0===s&&(s=t.replace(/\/$/,"")),t=t.replace(s,"")||a||"/"):t=c.useHashbang&&(window.location.hash.replace("#!","")||a)||"/";t.startsWith("/")||(t="/"+t);c.useHistoryApi?window.addEventListener("popstate",function(t){t.state&&h(t.state),t.preventDefault()}):c.useHashbang&&window.addEventListener("hashchange",function(t){h({path:window.location.hash.replace(/^#!/,"")}),t.preventDefault()});f(t)},trigger:function(t){return u.trigger(t),this},useHistoryApi:null,useHashbang:null})}}),define("skylark-ajaxify-routers/main",["./routers","./Router","./Route"],function(t){return t}),define("skylark-ajaxify-routers",["skylark-ajaxify-routers/main"],function(t){return t}),define("skylark-ajaxify-spa/spa",["skylark-langx/skylark","skylark-langx/langx","skylark-ajaxify-routers"],function(t,e,n){var r=e.Deferred;function i(t,n){var r=new CustomEvent(t,n);return e.safeMixin(r,n)}var s,a=new n.Router,o=a.Route=a.Route.inherit({klassName:"SpaRoute",init:function(t,n){this.overrided(t,n),this.content=n.content,this.forceRefresh=n.forceRefresh,this.data=n.data;var r=this;["preparing","rendering","rendered"].forEach(function(t){e.isFunction(n[t])&&r.on(t,n[t])})},_entering:function(t){return this.forceRefresh||t.force||!this._prepared?this.prepare():this},getConfigData:function(t){return t?this.data[t]:this.data},getNamedValue:function(){return window.location.pathname.match(this.regex)},prepare:function(){var t=new r,e=this._setting,n=e.controller,s=(this.controller,this);e.content,e.contentPath;return require([n.type],function(e){s.controller=new e(n),t.resolve()}),t.then(function(){var t=i("preparing",{route:s,result:!0});return s.trigger(t),r.when(t.result).then(function(){s._prepared=!0})})},render:function(t){var e=i("rendering",{route:this,context:t,content:this.content});return this.trigger(e),e.content},trigger:function(t){var e=this.controller;return e?e.perform(t):this.overrided(t)}}),l=e.Evented.inherit({klassName:"SpaRouteController",init:function(t,e){e=e||{},this.content=e.content,this.data=e.data},getConfigData:function(t){return t?this.data[t]:this.data},perform:function(t){var e=t.type;if(this[e])return this[e].call(this,t)}}),u=e.Evented.inherit({klassName:"SpaPage",init:function(t){t=e.mixin({routeViewer:"body"},t),this._params=t,this._rvc=document.querySelector(t.routeViewer),this._router=a,a.on("routed",e.proxy(this,"refresh"))},prepare:function(){},refresh:function(){var t=a.current(),n=(a.previous(),t.route.render(t));void 0!==n&&null!==n&&(e.isString(n)?this._rvc.innerHTML=n:(this._rvc.innerHTML="",this._rvc.appendChild(n)),t.route.trigger(i("rendered",{route:t.route,content:n})))}}),c=e.Evented.inherit({klassName:"SpaPlugin",init:function(t,n){this.name=t,e.isString(n.hookers)&&(n.hookers=n.hookers.split(" ")),this._setting=n},isHooked:function(t){var e=this._setting.hookers||[];return e.indexOf(t)>-1},prepare:function(){var t=new r,n=this._setting,s=n.controller,o=this.controller,l=this;return require([s.type],function(r){o=l.controller=new r(s),a.on(n.hookers,{plugin:l},e.proxy(o.perform,o)),t.resolve()}),t.then(function(){var t=i("preparing",{plugin:l,result:!0});return l.trigger(t),r.when(t.result).then(function(){l._prepared=!0})})},trigger:function(t){var e=this.controller;return e?e.perform(t):this.overrided(t)}}),h=e.Evented.inherit({klassName:"SpaPluginController",init:function(t){this.plugin=t},perform:function(t){var e=t.type;if(this[e])return this[e].call(this,t)}}),f=e.Evented.inherit({klassName:"SpaApplication",init:function(t){if(s)return s;var n=this._plugins={};t=this._config=e.mixin({plugins:{}},t,!0),e.each(t.plugins,function(t,e){n[t]=new c(t,e)}),a.routes(t.routes),this._router=a,this._page=new d.Page(t.page),document.title=t.title;var r=t.baseUrl;void 0===r&&(r=t.baseUrl=new e.URL(document.baseURI).pathname),a.baseUrl(r),t.homePath&&a.homePath(t.homePath),s=this},baseUrl:function(){return a.baseUrl()},getConfig:function(t){return t?this._config[t]:this._config},go:function(t,e){return a.go(t,e),this},page:function(){return this._page},prepare:function(){if(this._prepared)return r.resolve();var t=this,n=e.map(this._plugins,function(t,e){if(t.isHooked("starting"))return t.prepare()});return r.all(n).then(function(){a.trigger(i("starting",{spa:t}));var n=e.map(a.routes(),function(t,e){if(!1===t.lazy)return t.prepare()}),s=e.map(t._plugins,function(t,e){if(!t.isHooked("starting"))return t.prepare()});return r.all(n.concat(s)).then(function(){t._prepared=!0})})},run:function(){this._router.start(),a.trigger(i("started",{spa:this}))}}),d=function(t){return s||(window[t.name||"app"]=s=new d.Application(t)),s};return e.mixin(d,{Application:f,Page:u,Plugin:c,PluginController:h,Route:o,router:a,RouteController:l}),t.attach("ajaxify.spa",d)}),define("skylark-ajaxify-spa/main",["./spa"],function(t){return t}),define("skylark-ajaxify-spa",["skylark-ajaxify-spa/main"],function(t){return t}),define("skylark-ajaxify-shells/shells",["skylark-langx/skylark"],function(t){return t.attach("ajaxify.shells",{})}),define("skylark-nprogress/nprogress",[],function(){return function(){var t={version:"0.2.0"},e=t.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function n(t,e,n){return t<e?e:t>n?n:t}function r(t){return 100*(-1+t)}t.configure=function(t){var n,r;for(n in t)void 0!==(r=t[n])&&t.hasOwnProperty(n)&&(e[n]=r);return this},t.status=null,t.set=function(i){var s=t.isStarted();i=n(i,e.minimum,1),t.status=1===i?null:i;var l=t.render(!s),u=l.querySelector(e.barSelector),c=e.speed,h=e.easing;return l.offsetWidth,a(function(n){""===e.positionUsing&&(e.positionUsing=t.getPositioningCSS()),o(u,function(t,n,i){var s;s="translate3d"===e.positionUsing?{transform:"translate3d("+r(t)+"%,0,0)"}:"translate"===e.positionUsing?{transform:"translate("+r(t)+"%,0)"}:{"margin-left":r(t)+"%"};return s.transition="all "+n+"ms "+i,s}(i,c,h)),1===i?(o(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout(function(){o(l,{transition:"all "+c+"ms linear",opacity:0}),setTimeout(function(){t.remove(),n()},c)},c)):setTimeout(n,c)}),this},t.isStarted=function(){return"number"==typeof t.status},t.start=function(){t.status||t.set(0);var n=function(){setTimeout(function(){t.status&&(t.trickle(),n())},e.trickleSpeed)};return e.trickle&&n(),this},t.done=function(e){return e||t.status?t.inc(.3+.5*Math.random()).set(1):this},t.inc=function(e){var r=t.status;return r?("number"!=typeof e&&(e=(1-r)*n(Math.random()*r,.1,.95)),r=n(r+e,0,.994),t.set(r)):t.start()},t.trickle=function(){return t.inc(Math.random()*e.trickleRate)},i=0,s=0,t.promise=function(e){return e&&"resolved"!==e.state()?(0===s&&t.start(),i++,s++,e.always(function(){0==--s?(i=0,t.done()):t.set((i-s)/i)}),this):this},t.render=function(n){if(t.isRendered())return document.getElementById("nprogress");u(document.documentElement,"nprogress-busy");var i=document.createElement("div");i.id="nprogress",i.innerHTML=e.template;var s,a=i.querySelector(e.barSelector),l=n?"-100":r(t.status||0),c=document.querySelector(e.parent);return o(a,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),e.showSpinner||(s=i.querySelector(e.spinnerSelector))&&f(s),c!=document.body&&u(c,"nprogress-custom-parent"),c.appendChild(i),i},t.remove=function(){c(document.documentElement,"nprogress-busy"),c(document.querySelector(e.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&f(t)},t.isRendered=function(){return!!document.getElementById("nprogress")},t.getPositioningCSS=function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"};var i,s;var a=function(){var t=[];function e(){var n=t.shift();n&&n(e)}return function(n){t.push(n),1==t.length&&e()}}(),o=function(){var t=["Webkit","O","Moz","ms"],e={};function n(n){return n=n.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()}),e[n]||(e[n]=function(e){var n=document.body.style;if(e in n)return e;var r,i=t.length,s=e.charAt(0).toUpperCase()+e.slice(1);for(;i--;)if((r=t[i]+s)in n)return r;return e}(n))}function r(t,e,r){e=n(e),t.style[e]=r}return function(t,e){var n,i,s=arguments;if(2==s.length)for(n in e)void 0!==(i=e[n])&&e.hasOwnProperty(n)&&r(t,n,i);else r(t,s[1],s[2])}}();function l(t,e){var n="string"==typeof t?t:h(t);return n.indexOf(" "+e+" ")>=0}function u(t,e){var n=h(t),r=n+e;l(n,e)||(t.className=r.substring(1))}function c(t,e){var n,r=h(t);l(t,e)&&(n=r.replace(" "+e+" "," "),t.className=n.substring(1,n.length-1))}function h(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")}function f(t){t&&t.parentNode&&t.parentNode.removeChild(t)}return t}}),define("skylark-nprogress/main",["./nprogress"],function(t){return t}),define("skylark-nprogress",["skylark-nprogress/main"],function(t){return t}),define("skylark-bootbox4/bootbox",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-query","skylark-domx-data","skylark-domx-styler"],function(t,e,n){"use strict";var r={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},i={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body"},s={};function a(t){var e=d[i.locale];return e?e[t]:d.en[t]}function o(t,n,r){t.stopPropagation(),t.preventDefault();var i=e.isFunction(r)&&!1===r.call(n,t);i||n.modal("hide")}function l(t,n){var r=0;e.each(t,function(t,e){n(t,e,r++)})}function u(t,n,r){return e.extend(!0,{},t,function(t,e){var n=t.length,r={};if(n<1||n>2)throw new Error("Invalid argument length");2===n||"string"==typeof t[0]?(r[e[0]]=t[0],r[e[1]]=t[1]):r=t[0];return r}(n,r))}function c(t,e,n,r){var i={className:"bootbox-"+t,buttons:h.apply(null,e)};return f(u(i,r,n),e)}function h(){for(var t={},e=0,n=arguments.length;e<n;e++){var r=arguments[e],i=r.toLowerCase(),s=r.toUpperCase();t[i]={label:a(s)}}return t}function f(t,e){var n={};return l(e,function(t,e){n[e]=!0}),l(t.buttons,function(t){if(void 0===n[t])throw new Error("button key "+t+" is not allowed (options are "+e.join("\n")+")")}),t}s.alert=function(){var t;if((t=c("alert",["ok"],["message","callback"],arguments)).callback&&!e.isFunction(t.callback))throw new Error("alert requires callback property to be a function when provided");return t.buttons.ok.callback=t.onEscape=function(){return!e.isFunction(t.callback)||t.callback.call(this)},s.dialog(t)},s.confirm=function(){var t;if((t=c("confirm",["cancel","confirm"],["message","callback"],arguments)).buttons.cancel.callback=t.onEscape=function(){return t.callback.call(this,!1)},t.buttons.confirm.callback=function(){return t.callback.call(this,!0)},!e.isFunction(t.callback))throw new Error("confirm requires a callback");return s.dialog(t)},s.prompt=function(){var t,i,a,o,c,d,p;if(o=n(r.form),i={className:"bootbox-prompt",buttons:h("cancel","confirm"),value:"",inputType:"text"},t=f(u(i,arguments,["title","callback"]),["cancel","confirm"]),d=void 0===t.show||t.show,t.message=o,t.buttons.cancel.callback=t.onEscape=function(){return t.callback.call(this,null)},t.buttons.confirm.callback=function(){var e;switch(t.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":e=c.val();break;case"checkbox":var r=c.find("input:checked");e=[],l(r,function(t,r){e.push(n(r).val())})}return t.callback.call(this,e)},t.show=!1,!t.title)throw new Error("prompt requires a title");if(!e.isFunction(t.callback))throw new Error("prompt requires a callback");if(!r.inputs[t.inputType])throw new Error("invalid prompt type");switch(c=n(r.inputs[t.inputType]),t.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":c.val(t.value);break;case"select":var m={};if(p=t.inputOptions||[],!e.isArray(p))throw new Error("Please pass an array of input options");if(!p.length)throw new Error("prompt with select requires options");l(p,function(t,e){var r=c;if(void 0===e.value||void 0===e.text)throw new Error("given options in wrong format");e.group&&(m[e.group]||(m[e.group]=n("<optgroup/>").attr("label",e.group)),r=m[e.group]),r.append("<option value='"+e.value+"'>"+e.text+"</option>")}),l(m,function(t,e){c.append(e)}),c.val(t.value);break;case"checkbox":var g=e.isArray(t.value)?t.value:[t.value];if(!(p=t.inputOptions||[]).length)throw new Error("prompt with checkbox requires options");if(!p[0].value||!p[0].text)throw new Error("given options in wrong format");c=n("<div/>"),l(p,function(e,i){var s=n(r.inputs[t.inputType]);s.find("input").attr("value",i.value),s.find("label").append(i.text),l(g,function(t,e){e===i.value&&s.find("input").prop("checked",!0)}),c.append(s)})}return t.placeholder&&c.attr("placeholder",t.placeholder),t.pattern&&c.attr("pattern",t.pattern),t.maxlength&&c.attr("maxlength",t.maxlength),o.append(c),o.on("submit",function(t){t.preventDefault(),t.stopPropagation(),a.find(".btn-primary").click()}),(a=s.dialog(t)).off("shown.bs.modal"),a.on("shown.bs.modal",function(){c.focus()}),!0===d&&a.modal("show"),a},s.dialog=function(t){t=function(t){var n,r;if("object"!=typeof t)throw new Error("Please supply an object of options");if(!t.message)throw new Error("Please specify a message");(t=e.extend({},i,t)).buttons||(t.buttons={});return n=t.buttons,r=function(t){var e,n=0;for(e in t)n++;return n}(n),l(n,function(t,i,s){if(e.isFunction(i)&&(i=n[t]={callback:i}),"object"!==e.type(i))throw new Error("button with key "+t+" must be an object");i.label||(i.label=t),i.className||(i.className=r<=2&&s===r-1?"btn-primary":"btn-default")}),t}(t);var s=n(r.dialog),a=s.find(".modal-dialog"),u=s.find(".modal-body"),c=t.buttons,h="",f={onEscape:t.onEscape};if(void 0===n.fn.modal)throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.");if(l(c,function(t,e){h+="<button data-bb-handler='"+t+"' type='button' class='btn "+e.className+"'>"+e.label+"</button>",f[t]=e.callback}),u.find(".bootbox-body").html(t.message),!0===t.animate&&s.addClass("fade"),t.className&&s.addClass(t.className),"large"===t.size?a.addClass("modal-lg"):"small"===t.size&&a.addClass("modal-sm"),t.title&&u.before(r.header),t.closeButton){var d=n(r.closeButton);t.title?s.find(".modal-header").prepend(d):d.css("margin-top","-10px").prependTo(u)}return t.title&&s.find(".modal-title").html(t.title),h.length&&(u.after(r.footer),s.find(".modal-footer").html(h)),s.on("hidden.bs.modal",function(t){t.target===this&&s.remove()}),s.on("shown.bs.modal",function(){s.find(".btn-primary:first").focus()}),"static"!==t.backdrop&&s.on("click.dismiss.bs.modal",function(t){s.children(".modal-backdrop").length&&(t.currentTarget=s.children(".modal-backdrop").get(0)),t.target===t.currentTarget&&s.trigger("escape.close.bb")}),s.on("escape.close.bb",function(t){f.onEscape&&o(t,s,f.onEscape)}),s.on("click",".modal-footer button",function(t){var e=n(this).data("bb-handler");o(t,s,f[e])}),s.on("click",".bootbox-close-button",function(t){o(t,s,f.onEscape)}),s.on("keyup",function(t){27===t.which&&s.trigger("escape.close.bb")}),n(t.container).append(s),s.modal({backdrop:!!t.backdrop&&"static",keyboard:!1,show:!1}),t.show&&s.modal("show"),s},s.setDefaults=function(){var t={};2===arguments.length?t[arguments[0]]=arguments[1]:t=arguments[0],e.extend(i,t)},s.hideAll=function(){return n(".bootbox").modal("hide"),s};var d={bg_BG:{OK:"",CANCEL:"",CONFIRM:""},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zruit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"",CANCEL:"",CONFIRM:""},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"",CANCEL:"",CONFIRM:""},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"",CANCEL:"",CONFIRM:""},hu:{OK:"OK",CANCEL:"Mgsem",CONFIRM:"Megerst"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"",CONFIRM:""},lt:{OK:"Gerai",CANCEL:"Ataukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprint"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierd"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"",CONFIRM:""},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},th:{OK:"",CANCEL:"",CONFIRM:""},tr:{OK:"Tamam",CANCEL:"ptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"",CONFIRM:""},zh_TW:{OK:"OK",CANCEL:"",CONFIRM:""}};return s.addLocale=function(t,n){return e.each(["OK","CANCEL","CONFIRM"],function(t,e){if(!n[e])throw new Error("Please supply a translation for '"+e+"'")}),d[t]={OK:n.OK,CANCEL:n.CANCEL,CONFIRM:n.CONFIRM},s},s.removeLocale=function(t){return delete d[t],s},s.setLocale=function(t){return s.setDefaults("locale",t)},s.init=function(t){return init(t||n)},t.attach("itg.bootbox",s)}),define("skylark-bootbox4/main",["./bootbox"],function(t){return t}),define("skylark-bootbox4",["skylark-bootbox4/main"],function(t){return t}),define("skylark-visibility/fallback",[],function(){if(!document.visibilityState&&!document.webkitVisibilityState){document.hidden=!1,document.visibilityState="visible";var t=null,e=function(){document.createEvent?(t||(t=document.createEvent("HTMLEvents")).initEvent("visibilitychange",!0,!0),document.dispatchEvent(t)):"object"==typeof Visibility&&Visibility._change.call(Visibility,{})},n=function(){document.hidden=!1,document.visibilityState="visible",e()},r=function(){document.hidden=!0,document.visibilityState="hidden",e()};document.addEventListener?(window.addEventListener("focus",n,!0),window.addEventListener("blur",r,!0)):(document.attachEvent("onfocusin",n),document.attachEvent("onfocusout",r))}}),define("skylark-visibility/core",["./fallback"],function(){if(window.Visibility)return window.Visibility;var t=-1,e={onVisible:function(t){var n=e.isSupported();if(!n||!e.hidden())return t(),n;var r=e.change(function(n,i){e.hidden()||(e.unbind(r),t())});return r},change:function(n){if(!e.isSupported())return!1;var r=t+=1;return e._callbacks[r]=n,e._listen(),r},unbind:function(t){delete e._callbacks[t]},afterPrerendering:function(t){var n=e.isSupported();if(!n||"prerender"!=e.state())return t(),n;var r=e.change(function(n,i){"prerender"!=i&&(e.unbind(r),t())});return r},hidden:function(){return!(!e._doc.hidden&&!e._doc.webkitHidden)},state:function(){return e._doc.visibilityState||e._doc.webkitVisibilityState||"visible"},isSupported:function(){return void 0!==e._doc.hidden||void 0!==e._doc.webkitHidden},_doc:document||{},_callbacks:{},_change:function(t){var n=e.state();for(var r in e._callbacks)e._callbacks[r].call(e._doc,t,n)},_listen:function(){if(!e._init){var t="visibilitychange";e._doc.webkitVisibilityState&&(t="webkit"+t);var n=function(){e._change.apply(e,arguments)};e._doc.addEventListener?e._doc.addEventListener(t,n):e._doc.attachEvent(t,n),e._init=!0}}};return window.Visibility=e}),define("skylark-visibility/visibility",["./core"],function(t){var e,n=-1;return(e=t).every=function(t,r,i){e._time(),i||(i=r,r=null);var s=n+=1;return e._timers[s]={visible:t,hidden:r,callback:i},e._run(s,!1),e.isSupported()&&e._listen(),s},e.stop=function(t){return!!e._timers[t]&&(e._stop(t),delete e._timers[t],!0)},e._timers={},e._time=function(){e._timed||(e._timed=!0,e._wasHidden=e.hidden(),e.change(function(){e._stopRun(),e._wasHidden=e.hidden()}))},e._run=function(t,n){var r,i=e._timers[t];if(e.hidden()){if(null===i.hidden)return;r=i.hidden}else r=i.visible;var s=function(){i.last=new Date,i.callback.call(window)};if(n){var a=new Date-i.last;r>a?i.delay=setTimeout(function(){i.id=setInterval(s,r),s()},r-a):(i.id=setInterval(s,r),s())}else i.id=setInterval(s,r)},e._stop=function(t){var n=e._timers[t];clearInterval(n.id),clearTimeout(n.delay),delete n.id,delete n.delay},e._stopRun=function(t){var n=e.hidden(),r=e._wasHidden;if(n&&!r||!n&&r)for(var i in e._timers)e._stop(i),e._run(i,!n)},e}),define("skylark-visibility/main",["./visibility"],function(t){return t}),define("skylark-visibility",["skylark-visibility/main"],function(t){return t}),define("skylark-tinycon/tinycon",["skylark-langx/skylark"],function(t){var e,n={},r=null,i=null,s=null,a=null,o={},l=window.devicePixelRatio||1,u=16*l,c={width:7,height:9,font:10*l+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},h=(e=navigator.userAgent.toLowerCase(),function(t){return-1!==e.indexOf(t)}),f={ie:h("trident"),chrome:h("chrome"),webkit:h("chrome")||h("safari"),safari:h("safari")&&!h("chrome"),mozilla:h("mozilla")&&!h("chrome")&&!h("safari")},d=function(){if(!i||!r){var t=function(){for(var t=document.getElementsByTagName("link"),e=0,n=t.length;e<n;e++)if((t[e].getAttribute("rel")||"").match(/\bicon\b/i))return t[e];return!1}();r=t?t.getAttribute("href"):"/favicon.ico",i||(i=r)}return r},p=function(){return a||((a=document.createElement("canvas")).width=u,a.height=u),a},m=function(t){if(t){!function(){for(var t=document.getElementsByTagName("link"),e=document.getElementsByTagName("head")[0],n=0,r=t.length;n<r;n++){var i=void 0!==t[n];i&&(t[n].getAttribute("rel")||"").match(/\bicon\b/i)&&e.removeChild(t[n])}}();var e=document.createElement("link");e.type="image/x-icon",e.rel="icon",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}},g=function(t){if(o.fallback){var e=document.title;"("===e[0]&&(e=e.slice(e.indexOf(" "))),document.title=(t+"").length>0?"("+t+") "+e:e}},y=function(t,e,n){"number"==typeof e&&e>99&&o.abbreviate&&(e=x(e));var r=(e+"").length-1,i=o.width*l+6*l*r,s=o.height*l,a=u-s,c=u-i-l,h=16*l,d=16*l,p=2*l;t.font=(f.webkit?"bold ":"")+o.font,t.fillStyle=o.background,t.strokeStyle=o.background,t.lineWidth=l,t.beginPath(),t.moveTo(c+p,a),t.quadraticCurveTo(c,a,c,a+p),t.lineTo(c,h-p),t.quadraticCurveTo(c,h,c+p,h),t.lineTo(d-p,h),t.quadraticCurveTo(d,h,d,h-p),t.lineTo(d,a+p),t.quadraticCurveTo(d,a,d-p,a),t.closePath(),t.fill(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.3)",t.moveTo(c+p/2,h),t.lineTo(d-p/2,h),t.stroke(),t.fillStyle=o.color,t.textAlign="right",t.textBaseline="top",t.fillText(e,2===l?29:15,f.mozilla?7*l:6*l)},v=function(){p().getContext&&m(p().toDataURL())},x=function(t){for(var e=[["G",1e9],["M",1e6],["k",1e3]],n=0;n<e.length;++n)if(t>=e[n][1]){t=k(t/e[n][1])+e[n][0];break}return t},k=function(t,e){var n=new Number(t);return n.toFixed(e)};return n.setOptions=function(t){for(var e in o={},t.colour&&(t.color=t.colour),c)o[e]=t.hasOwnProperty(e)?t[e]:c[e];return this},n.setImage=function(t){return r=t,v(),this},n.setBubble=function(t,e){return function(t,e){if(!p().getContext||f.ie||f.safari||"force"===o.fallback)return g(t);var n=p().getContext("2d"),e=e||"#000000",r=d();(s=document.createElement("img")).onload=function(){n.clearRect(0,0,u,u),n.drawImage(s,0,0,s.width,s.height,0,0,u,u),(t+"").length>0&&y(n,t,e),v()},!r.match(/^data/)&&o.crossOrigin&&(s.crossOrigin="anonymous");s.src=r}(t=t||"",e),this},n.reset=function(){r=i,m(i)},n.setOptions(c),t.attach("itg.tinycon",n)}),define("skylark-tinycon/main",["./tinycon"],function(t){return t}),define("skylark-tinycon",["skylark-tinycon/main"],function(t){return t}),define("skylark-ajaxify-shells/Shell",["skylark-langx/langx","skylark-domx-css","skylark-domx-scripter","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins","skylark-nprogress","skylark-bootbox4","skylark-visibility","skylark-tinycon","./shells"],function(t,e,n,r,i,s,a,o,l,u,c){function h(t,e){t.find("strong").html(e.title),t.find("p").html(e.message),t.attr("class","alert alert-dismissable alert-"+e.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),e.timeout&&d(t,e.timeout),t.children().fadeOut(100),e.translate(t.html(),function(e){t.children().fadeIn(100),t.html(e)}),t.off("click").removeClass("pointer"),"function"==typeof e.clickfn&&t.addClass("pointer").on("click",function(n){i(n.target).is(".close")||e.clickfn(),f(t)})}function f(t){t.fadeOut(500,function(){i(this).remove()})}function d(t,e){var n=setTimeout(function(){f(t)},e);t.attr("timeoutId",n),t.css("transition-property","none"),t.removeClass("animate"),setTimeout(function(){t.css("transition-property",""),t.css("transition","width "+(e+450)+"ms linear, background-color "+(e+450)+"ms ease-in"),t.addClass("animate")},50),t.on("mouseenter",function(){i(this).css("transition-duration",0)})}var p=s.Plugin.inherit({options:{i18n:{locale:"en",translate:function(e){return t.Deferred.resolve(e)}},alerts:{container:"",titles:{success:"[[global:alert.success]]",error:"[[global:alert.error]]"}},templator:{parse:null},skins:{}},_construct:function(t){s.Plugin.prototype._construct.call(this,document.body,t),this._titleObj={active:!1,interval:void 0,titles:[]};var e=this;e.isFocused=!0,l.change(function(t,n){"visible"===n?(e.isFocused=!0,e.alternatingTitle("")):"hidden"===n&&(e.isFocused=!1)})},progress:function(){return a},alert:function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:(new Date).getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";var e=i("#"+t.alert_id);t.translate=t.translate||this.option("i18n.translate"),e.length?h(e,t):(t.parseTemplate=t.parseTemplate||this.option("templator.parse"),t.container=t.container||this.option("alerts.container"),function(t,e){t.parseTemplate("alert",t,function(e){t.translate(e,function(e){var n=i("#"+t.alert_id);if(n.length)return h(n,t);(n=i(e)).fadeIn(200),t.container.prepend(n),n.find("button").on("click",function(){return"function"==typeof t.closefn&&t.closefn(),f(n),!1}),t.timeout&&d(n,t.timeout),"function"==typeof t.clickfn&&n.addClass("pointer").on("click",function(e){i(e.target).is(".close")||t.clickfn(),f(n)})})})}(t))},removeAlert:function(t){i("#alert_button_"+t).remove()},alertSuccess:function(t,e){this.alert({title:this.option("alerts.titles.success"),message:t,type:"success",timeout:e||5e3})},alertError:function(t,e){t=t.message||t,this.alert({title:this.option("alerts.titles.error"),message:t,type:"danger",timeout:e||1e4})},alternatingTitle:function(t){if("string"==typeof t){var e=this._titleObj;if(t.length>0&&!app.isFocused){e.titles[0]||(e.titles[0]=window.document.title);var n=this.option("i18n.translate");n(t,function(t){e.titles[1]=t,e.interval&&clearInterval(e.interval),e.interval=setInterval(function(){var t=e.titles[1^e.titles.indexOf(window.document.title)];t&&(window.document.title=i("<div/>").html(t).text())},2e3)})}else e.interval&&clearInterval(e.interval),e.titles[0]&&(window.document.title=i("<div/>").html(e.titles[0]).text())}},refreshTitle:function(t){var e=this,n=this.option("i18n.translate"),r=this._titleObj;n(t,function(t){r.titles[0]=t,e.alternatingTitle("")})},tinycon:function(e,n){t.isUndefined(n)&&t.isPlainObject(e)&&(n=e,e=void 0),t.isDefined(n)&&u.setOptions(n),t.isDefined(e)&&u.setBubble(e)},reskin:function(t,e,n){if(n||(n=document.getElementById("skinSheet"))){var r=i("body").attr("class").split(/\s+/).filter(function(t){return t.startsWith("skin-")}),s=r[0].slice(5);if(t!==(s="noskin"!==s?s:"")){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href=e,a.onload=function(){n.parentNode.removeChild(n),i("body").removeClass(r.join(" ")),i("body").addClass("skin-"+(t||"noskin"))},document.head.appendChild(a)}}},loadStyleSheet:function(t,n,r,i){return e.loadStyleSheet(t,n,r,i)},removeStyleSheet:function(t){return e.removeStyleSheet(t)},loadScript:function(t,e,r){return n.loadJavaScript(t,e,r)},removeScript:function(t){return n.deleteJavaScript(t)}});return c.Shell=p}),define("skylark-ajaxify-shells/main",["./shells","./Shell"],function(t){return t}),define("skylark-ajaxify-shells",["skylark-ajaxify-shells/main"],function(t){return t}),define("skylark-data-entities/entities",["skylark-langx/langx"],function(t){function e(){return e}return t.mixin(e,{emulateHTTP:!1,emulateJSON:!1,backends:{}}),e}),define("skylark-data-entities/Entity",["skylark-langx/langx","./entities"],function(t,e){var n=function(t,e){var n=e.error;e.error=function(r){n&&n.call(e.context,t,r,e),t.trigger("error",t,r,e)}},r=t.Stateful.inherit({sync:function(){return e.sync.apply(this,arguments)},matches:function(e){return t.isMatch(this.attributes,e)},fetch:function(e){var r=this,i=(e=t.mixin({parse:!0},e)).success;return e.success=function(t){var n=e.parse?r.parse(t,e):t;if(!r.set(n,e))return!1;i&&i.call(e.context,r,t,e),r.trigger("sync",r,t,e)},n(this,e),this.sync("read",this,e)},save:function(e,r,i){var s;null==e||"object"==typeof e?(s=e,i=r):(s={})[e]=r;var a=(i=t.mixin({validate:!0,parse:!0},i)).wait;if(s&&!a){if(!this.set(s,i))return!1}else if(!this._validate(s,i))return!1;var o=this,l=i.success,u=this.attributes;i.success=function(e){o.attributes=u;var n=i.parse?o.parse(e,i):e;if(a&&(n=t.mixin({},s,n)),n&&!o.set(n,i))return!1;l&&l.call(i.context,o,e,i),o.trigger("sync",o,e,i)},n(this,i),s&&a&&(this.attributes=t.mixin({},u,s));var c=this.isNew()?"create":i.patch?"patch":"update";"patch"!==c||i.attrs||(i.attrs=s);var h=this.sync(c,this,i);return this.attributes=u,h},destroy:function(e){var r=this,i=(e=e?t.clone(e):{}).success,s=e.wait,a=function(){r.stopListening(),r.trigger("destroy",r,r.collection,e)};e.success=function(t){s&&a(),i&&i.call(e.context,r,t,e),r.isNew()||r.trigger("sync",r,t,e)};var o=!1;return this.isNew()?t.defer(e.success):(n(this,e),o=this.sync("delete",this,e)),s||a(),o},url:function(){var e=t.result(this,"urlRoot")||t.result(this.collection,"url")||urlError();if(this.isNew())return e;var n=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(n)},parse:function(t,e){return t}});return e.Entity=r}),define("skylark-data-entities/Collection",["skylark-langx/langx","./entities","./Entity"],function(t,e,n){var r=t.Evented.inherit({_construct:function(e,n){n||(n={}),n.entity&&(this.entity=n.entity),void 0!==n.comparator&&(this.comparator=n.comparator),this._reset(),e&&this.reset(e,t.mixin({silent:!0},n))}}),i={add:!0,remove:!0,merge:!0},s={add:!0,remove:!1},a=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var r,i=Array(t.length-n),s=e.length;for(r=0;r<i.length;r++)i[r]=t[r+n];for(r=0;r<s;r++)t[r+n]=e[r];for(r=0;r<i.length;r++)t[r+s+n]=i[r]};return r.partial({entity:n,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,n){return this.set(e,t.mixin({merge:!1},n,s))},remove:function(e,n){n=t.mixin({},n);var r=!t.isArray(e);e=r?[e]:e.slice();var i=this._removeEntitys(e,n);return!n.silent&&i.length&&(n.changes={added:[],merged:[],removed:i},this.trigger("update",this,n)),r?i[0]:i},set:function(e,n){if(null!=e){(n=t.mixin({},i,n)).parse&&!this._isEntity(e)&&(e=this.parse(e,n)||[]);var r=!t.isArray(e);e=r?[e]:e.slice();var s=n.at;null!=s&&(s=+s),s>this.length&&(s=this.length),s<0&&(s+=this.length+1);var o,l,u=[],c=[],h=[],f=[],d={},p=n.add,m=n.merge,g=n.remove,y=!1,v=this.comparator&&null==s&&!1!==n.sort,x=t.isString(this.comparator)?this.comparator:null;for(l=0;l<e.length;l++){o=e[l];var k=this.get(o);if(k){if(m&&o!==k){var b=this._isEntity(o)?o.attributes:o;n.parse&&(b=k.parse(b,n)),k.set(b,n),h.push(k),v&&!y&&(y=k.hasChanged(x))}d[k.cid]||(d[k.cid]=!0,u.push(k)),e[l]=k}else p&&(o=e[l]=this._prepareEntity(o,n))&&(c.push(o),this._addReference(o,n),d[o.cid]=!0,u.push(o))}if(g){for(l=0;l<this.length;l++)o=this.entities[l],d[o.cid]||f.push(o);f.length&&this._removeEntitys(f,n)}var _=!1,w=!v&&p&&g;if(u.length&&w?(_=this.length!==u.length||this.entities.some(function(t,e){return t!==u[e]}),this.entities.length=0,a(this.entities,u,0),this.length=this.entities.length):c.length&&(v&&(y=!0),a(this.entities,c,null==s?this.length:s),this.length=this.entities.length),y&&this.sort({silent:!0}),!n.silent){for(l=0;l<c.length;l++)null!=s&&(n.index=s+l),(o=c[l]).trigger("add",o,this,n);(y||_)&&this.trigger("sort",this,n),(c.length||f.length||h.length)&&(n.changes={added:c,removed:f,merged:h},this.trigger("update",this,n))}return r?e[0]:e}},reset:function(e,n){n=n?t.clone(n):{};for(var r=0;r<this.entities.length;r++)this._removeReference(this.entities[r],n);return n.previousEntitys=this.entities,this._reset(),e=this.add(e,t.mixin({silent:!0},n)),n.silent||this.trigger("reset",this,n),e},push:function(e,n){return this.add(e,t.mixin({at:this.length},n))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(e,n){return this.add(e,t.mixin({at:0},n))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return slice.apply(this.entities,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.entityId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.entities[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(e){var n=this.comparator;if(!n)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=n.length;return t.isFunction(n)&&(n=t.proxy(n,this)),1===r||t.isString(n)?this.entities=this.sortBy(n):this.entities.sort(n),e.silent||this.trigger("sort",this,e),this},pluck:function(t){return this.map(t+"")},fetch:function(e){var n=(e=t.mixin({parse:!0},e)).success,r=this;return e.success=function(t){var i=e.reset?"reset":"set";r[i](t,e),n&&n.call(e.context,r,t,e),r.trigger("sync",r,t,e)},function(t,e){var n=e.error;e.error=function(r){n&&n.call(e.context,t,r,e),t.trigger("error",t,r,e)}}(this,e),this.sync("read",this,e)},create:function(e,n){var r=(n=n?t.clone(n):{}).wait;if(!(e=this._prepareEntity(e,n)))return!1;r||this.add(e,n);var i=this,s=n.success;return n.success=function(t,e,n){r&&i.add(t,n),s&&s.call(n.context,t,e,n)},e.save(null,n),e},parse:function(t,e){return t},clone:function(){return new this.constructor(this.entities,{entity:this.entity,comparator:this.comparator})},entityId:function(t){return t[this.entity.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.entities=[],this._byId={}},_prepareEntity:function(e,n){if(this._isEntity(e))return e.collection||(e.collection=this),e;(n=n?t.clone(n):{}).collection=this;var r=new this.entity(e,n);return r.validationError?(this.trigger("invalid",this,r.validationError,n),!1):r},_removeEntitys:function(t,e){for(var n=[],r=0;r<t.length;r++){var i=this.get(t[r]);if(i){var s=this.indexOf(i);this.entities.splice(s,1),this.length--,delete this._byId[i.cid];var a=this.entityId(i.attributes);null!=a&&delete this._byId[a],e.silent||(e.index=s,i.trigger("remove",i,this,e)),n.push(i),this._removeReference(i,e)}}return n},_isEntity:function(t){return t instanceof n},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.entityId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onEntityEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.entityId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onEntityEvent,this)},_onEntityEvent:function(t,e,n,r){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,r),"change"===t){var i=this.entityId(e.previousAttributes()),s=this.entityId(e.attributes);i!==s&&(null!=i&&delete this._byId[i],null!=s&&(this._byId[s]=e))}}this.trigger.apply(this,arguments)}}),e.Collection=r}),define("skylark-data-entities/backends/registry",[],function(){var t={};return{add:function(e,n){t[e]=n},remove:function(t){delete provides[t]},get:function(e){return t[e]}}}),define("skylark-data-entities/sync",["skylark-langx/langx","./entities","./backends/registry"],function(t,e,n){return e.sync=function(e,r,i){if(!i.backend)throw new Error("The backend is not specified");var s=n.get(i.backend);if(!s)throw new Error("The backend is not defined:"+i.backend);var a=s.sync;if(!a)throw new Error("The backend sync method is not defined:"+i.backend);var o=t.mixin({},s.options,i);return a.apply(this,[e,r,o])}}),define("skylark-data-entities/backends/ajaxSync",["skylark-langx/langx","../entities"],function(t,e){var n={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};return e.backends.ajaxSync=function(r,i,s){var a=n[r];t.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:a,dataType:"json"};s.url||(o.url=t.result(i,"url")||urlError());null!=s.data||!i||"create"!==r&&"update"!==r&&"patch"!==r||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||i.toJSON(s)));s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{entity:o.data}:{});if(s.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){o.type="POST",s.emulateJSON&&(o.data._method=a);var l=s.beforeSend;s.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",a),l)return l.apply(this,arguments)}}"GET"===o.type||s.emulateJSON||(o.processData=!1);var u=s.error;s.error=function(t,e,n){s.textStatus=e,s.errorThrown=n,u&&u.call(s.context,t,e,n)};var c=s.xhr=t.Xhr.request(t.mixin(o,s));return i.trigger("request",i,c,s),c}}),define("skylark-data-entities/backends/localSync",["skylark-langx/langx","../entities"],function(t,e){function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var r=t.klass({_construct:function(t){this.name=t;var e=this.localStorage().getItem(this.name);this.records=e&&e.split(",")||[]},save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(t){return t.id||(t.id=n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n(),t.set(t.idAttribute,t.id)),this.localStorage().setItem(this.name+"-"+t.id,JSON.stringify(t)),this.records.push(t.id.toString()),this.save(),this.find(t)},update:function(t){return this.localStorage().setItem(this.name+"-"+t.id,JSON.stringify(t)),_.include(this.records,t.id.toString())||this.records.push(t.id.toString()),this.save(),this.find(t)},find:function(t){return this.jsonData(this.localStorage().getItem(this.name+"-"+t.id))},findAll:function(){return _(this.records).chain().map(function(t){return this.jsonData(this.localStorage().getItem(this.name+"-"+t))},this).compact().value()},destroy:function(t){return!t.isNew()&&(this.localStorage().removeItem(this.name+"-"+t.id),this.records=_.reject(this.records,function(e){return e===t.id.toString()}),this.save(),t)},localStorage:function(){return localStorage},jsonData:function(t){return t&&JSON.parse(t)}});function i(e,n,r){var i,s,a=n.localStorage||n.collection.localStorage,o=t.Deferred();try{switch(e){case"read":i=void 0!=n.id?a.find(n):a.findAll();break;case"create":i=a.create(n);break;case"update":i=a.update(n);break;case"delete":i=a.destroy(n)}}catch(t){s=t.code===DOMException.QUOTA_EXCEEDED_ERR&&0===window.localStorage.length?"Private browsing is unsupported":t.message}return i?(n.trigger("sync",n,i,r),r&&r.success&&r.success(i),o&&o.resolve(i)):(s=s||"Record Not Found",r&&r.error&&r.error(s),o&&o.reject(s)),r&&r.complete&&r.complete(i),o&&o.promise()}return e.backends.LocalStorage=i.LocalStorage=r,e.backends.localSync=i}),define("skylark-data-entities/main",["./entities","./Collection","./Entity","./sync","./backends/ajaxSync","./backends/localSync","./backends/registry"],function(t){return t}),define("skylark-data-entities",["skylark-data-entities/main"],function(t){return t}),define("skylark-io-streams/streams",["skylark-langx/skylark"],function(t){return t.attach("data.streams",{})}),define("skylark-io-streams/Stream",["skylark-langx/skylark","skylark-langx/langx","./streams"],function(t,e,n){var r=e.Evented.inherit({klassName:"Stream",init:function(t,e,n,r){this.bytes=new Uint8Array(t),this.start=e||0,this.pos=this.start,this.end=e+n||this.bytes.length,this.dict=r},length:{get:function(){return this.end-this.start}},getByte:function(){return this.pos>=this.end?null:this.bytes[this.pos++]},getBytes:function(t){var e=this.bytes,n=this.pos,r=this.end;if(!t)return e.subarray(n,r);var i=n+t;return i>r&&(i=r),this.pos=i,e.subarray(n,i)},lookChar:function(){return this.pos>=this.end?null:String.fromCharCode(this.bytes[this.pos])},getChar:function(){return this.pos>=this.end?null:String.fromCharCode(this.bytes[this.pos++])},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(t,e,n){return new r(this.bytes.buffer,t,e,n)},isStream:!0});return n.Stream=r}),define("skylark-io-streams/DecodeStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./Stream"],function(t,e,n,r){var i=r.inherit({klassName:"DecodeStream",init:function(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null},ensureBuffer:function(t){var e=this.buffer,n=e?e.byteLength:0;if(t<n)return e;for(var r=512;r<t;)r<<=1;for(var i=new Uint8Array(r),s=0;s<n;++s)i[s]=e[s];return this.buffer=i},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(t){var e,n=this.pos;if(t){for(this.ensureBuffer(n+t),e=n+t;!this.eof&&this.bufferLength<e;)this.readBlock();var r=this.bufferLength;e>r&&(e=r)}else{for(;!this.eof;)this.readBlock();(e=this.bufferLength)||(this.buffer=new Uint8Array(0))}return this.pos=e,this.buffer.subarray(n,e)},lookChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(t,e,n){for(var i=t+e;this.bufferLength<=i&&!this.eof;)this.readBlock();return new r(this.buffer,t,e,n)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0}});return n.DecodeStream=i}),define("skylark-io-streams/Ascii85Stream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=r.inherit({klassName:"Ascii85Stream",init:function(t){this.str=t,this.dict=t.dict,this.input=new Uint8Array(5),r.prototype.init.call(this)},readBlock:function(){for(var t="~".charCodeAt(0),e="z".charCodeAt(0),n=this.str,r=n.getByte();Lexer.isSpace(String.fromCharCode(r));)r=n.getByte();if(r&&r!==t){var i,s=this.bufferLength;if(r==e){i=this.ensureBuffer(s+4);for(var a=0;a<4;++a)i[s+a]=0;this.bufferLength+=4}else{var o=this.input;o[0]=r;for(var a=1;a<5;++a){for(r=n.getByte();Lexer.isSpace(String.fromCharCode(r));)r=n.getByte();if(o[a]=r,!r||r==t)break}if(i=this.ensureBuffer(s+a-1),this.bufferLength+=a-1,a<5){for(;a<5;++a)o[a]=117;this.eof=!0}for(var l=0,a=0;a<5;++a)l=85*l+(o[a]-33);for(var a=3;a>=0;--a)i[s+a]=255&l,l>>=8}}else this.eof=!0}});return n.Ascii85Stream=i}),define("skylark-io-streams/AsciiHexStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i={9:-1,32:-1,48:0,49:1,50:2,51:3,52:4,53:5,54:6,55:7,56:8,57:9,65:10,66:11,67:12,68:13,69:14,70:15,97:10,98:11,99:12,100:13,101:14,102:15},s=r.inherit({klassName:"AsciiHexStream",init:function(t){this.str=t,this.dict=t.dict,r.prototype.init.call(this)},readBlock:function(){var t,e,n,r,s,a,o,l=">".charCodeAt(0),u=this.str.getBytes();for(n=u.length+1>>1,r=this.ensureBuffer(this.bufferLength+n),s=this.bufferLength,a=0,o=u.length;a<o;a++){for(t=i[u[a]];-1==t&&a+1<o;)t=i[u[++a]];a+1<o&&u[a+1]!==l?(e=i[u[++a]],r[s++]=16*t+e):u[a]!==l&&(r[s++]=16*t)}this.bufferLength=s,this.eof=!0}});return n.AsciiHexStream=s}),define("skylark-io-streams/ChunkedStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./Stream"],function(t,e,n,r){var i=r.inherit({klassName:"ChunkedStream",numChunks:0,numChunksLoaded:0,init:function(t){for(var e=t.length,n=new Uint8Array(e),r=0;r<e;++r)n[r]=t.charCodeAt(r);DecodeStream.prototype.init.call(n),this.dict=stream.dict},numChunks:function(){},getMissingChunks:function(){for(var t=[],e=0,n=this.numChunks;e<n;++e)e in this.loadedChunks||t.push(e);return t},getBaseStreams:function(){return[this]},allChunksLoaded:function(){var t=this._;return t.numChunksLoaded===t.numChunks},onReceiveData:function(t,e){var n=t+e.byteLength;assert(t%this.chunkSize==0,"Bad begin offset: "+t);var r=this.bytes.length;assert(n%this.chunkSize==0||n===r,"Bad end offset: "+n),this.bytes.set(new Uint8Array(e),t);for(var i=this.chunkSize,s=Math.floor(t/i),a=Math.floor((n-1)/i)+1,e=s;e<a;++e)e in this.loadedChunks||(this.loadedChunks[e]=!0,++this.numChunksLoaded)},onReceiveInitialData:function(t){this.bytes.set(t),this.initialDataLength=t.length;for(var e=this.end===t.length?this.numChunks:Math.floor(t.length/this.chunkSize),n=0;n<e;n++)this.loadedChunks[n]=!0,++this.numChunksLoaded},ensureRange:function(t,e){if(!(t>=e||e<=this.initialDataLength))for(var n=this.chunkSize,r=Math.floor(t/n),i=Math.floor((e-1)/n)+1,s=r;s<i;++s)if(!(s in this.loadedChunks))throw new MissingDataException(t,e)},nextEmptyChunk:function(t){for(var e=t,n=this.numChunks;e<n;++e)if(!(e in this.loadedChunks))return e;for(var e=0;e<t;++e)if(!(e in this.loadedChunks))return e;return null},hasChunk:function(t){return t in this._.loadedChunks},getByte:function(){var t=this.pos;return t>=this.end?-1:(this.ensureRange(t,t+1),this.bytes[this.pos++])},getBytes:function(t){var e=this.bytes,n=this.pos,r=this.end;if(!t)return this.ensureRange(n,r),e.subarray(n,r);var i=n+t;return i>r&&(i=r),this.ensureRange(n,i),this.pos=i,e.subarray(n,i)},peekBytes:function(t){var e=this.getBytes(t);return this.pos-=e.length,e},getByteRange:function(t,e){return this.ensureRange(t,e),this.bytes.subarray(t,e)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(t,e,n){function r(){}r.prototype=Object.create(this),r.prototype.getMissingChunks=function(){for(var t=this.chunkSize,e=Math.floor(this.start/t),n=Math.floor((this.end-1)/t)+1,r=[],i=e;i<n;++i)i in this.loadedChunks||r.push(i);return r};var i=new r;return i.pos=i.start=t,i.end=t+e||this.end,i.dict=n,i}});return n.ChunkedStream=i}),define("skylark-io-streams/DecryptStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=r.inherit({klassName:"DecryptStream",init:function(t,e){this.str=t,this.dict=t.dict,this.decrypt=e,r.prototype.init.call(this)},readBlock:function(){var t=this.str.getBytes(512);if(t&&0!=t.length){var e=this.decrypt;t=e(t);var n,r=this.bufferLength,i=t.length,s=this.ensureBuffer(r+i);for(n=0;n<i;n++)s[r++]=t[n];this.bufferLength=r}else this.eof=!0}});return n.DecryptStream=i}),define("skylark-io-streams/FakeStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=r.inherit({klassName:"FakeStream",init:function(t){this.dict=t.dict,Stream.prototype.init.call(this)},readBlock:function(){var t=this.bufferLength;t+=1024;this.ensureBuffer(t);this.bufferLength=t},getBytes:function(t){var e,n=this.pos;if(t){for(this.ensureBuffer(n+t),e=n+t;!this.eof&&this.bufferLength<e;)this.readBlock();var r=this.bufferLength;e>r&&(e=r)}else this.eof=!0,e=this.bufferLength;return this.pos=e,this.buffer.subarray(n,e)}});return n.FakeStream=i}),define("skylark-io-streams/FlateStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),a=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),o=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],l=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5],u=r.inherit({klassName:"FlateStream",init:function(t){var e=t.getBytes(),n=0;this.dict=t.dict;var i=e[n++],s=e[n++];-1!=i&&-1!=s||error("Invalid header in flate stream: "+i+", "+s),8!=(15&i)&&error("Unknown compression method in flate stream: "+i+", "+s),((i<<8)+s)%31!=0&&error("Bad FCHECK in flate stream: "+i+", "+s),32&s&&error("FDICT bit set in flate stream: "+i+", "+s),this.bytes=e,this.bytesPos=n,this.codeSize=0,this.codeBuf=0,r.prototype.init.call(this)},getBits:function(t){for(var e,n=this.codeSize,r=this.codeBuf,i=this.bytes,s=this.bytesPos;n<t;)void 0===(e=i[s++])&&error("Bad encoding in flate stream"),r|=e<<n,n+=8;return e=r&(1<<t)-1,this.codeBuf=r>>t,this.codeSize=n-=t,this.bytesPos=s,e},getCode:function(t){for(var e=t[0],n=t[1],r=this.codeSize,i=this.codeBuf,s=this.bytes,a=this.bytesPos;r<n;){var o;void 0===(o=s[a++])&&error("Bad encoding in flate stream"),i|=o<<r,r+=8}var l=e[i&(1<<n)-1],u=l>>16,c=65535&l;return(0==r||r<u||0==u)&&error("Bad encoding in flate stream"),this.codeBuf=i>>u,this.codeSize=r-u,this.bytesPos=a,c},generateHuffmanTable:function(t){for(var e=t.length,n=0,r=0;r<e;++r)t[r]>n&&(n=t[r]);for(var i=1<<n,s=new Uint32Array(i),a=1,o=0,l=2;a<=n;++a,o<<=1,l<<=1)for(var u=0;u<e;++u)if(t[u]==a){for(var c=0,h=o,r=0;r<a;++r)c=c<<1|1&h,h>>=1;for(var r=c;r<i;r+=l)s[r]=a<<16|u;++o}return[s,n]},readBlock:function(){var t=this.getBits(3);if(1&t&&(this.eof=!0),0!=(t>>=1)){var e,n;if(1==t)e=o,n=l;else if(2==t){for(var r=this.getBits(5)+257,u=this.getBits(5)+1,c=this.getBits(4)+4,h=new Uint8Array(i.length),f=0;f<c;++f)h[i[f]]=this.getBits(3);for(var d=this.generateHuffmanTable(h),p=0,f=0,m=r+u,g=new Uint8Array(m);f<m;){var y=this.getCode(d);if(16==y)var v=2,x=3,k=p;else if(17==y)var v=3,x=3,k=p=0;else{if(18!=y){g[f++]=p=y;continue}var v=7,x=11,k=p=0}for(var b=this.getBits(v)+x;b-- >0;)g[f++]=k}e=this.generateHuffmanTable(g.subarray(0,r)),n=this.generateHuffmanTable(g.subarray(r,m))}else error("Unknown block type in flate stream");for(var _=this.buffer,w=_?_.length:0,C=this.bufferLength;;){var S=this.getCode(e);if(S<256)C+1>=w&&(_=this.ensureBuffer(C+1),w=_.length),_[C++]=S;else{if(256==S)return void(this.bufferLength=C);var M=(S=s[S-=257])>>16;M>0&&(M=this.getBits(M));var p=(65535&S)+M;S=this.getCode(n),S=a[S],(M=S>>16)>0&&(M=this.getBits(M));var E=(65535&S)+M;C+p>=w&&(_=this.ensureBuffer(C+p),w=_.length);for(var A=0;A<p;++A,++C)_[C]=_[C-E]}}}else{var z,T=this.bytes,O=this.bytesPos;void 0===(z=T[O++])&&error("Bad block header in flate stream");var P=z;void 0===(z=T[O++])&&error("Bad block header in flate stream"),P|=z<<8,void 0===(z=T[O++])&&error("Bad block header in flate stream");var I=z;void 0===(z=T[O++])&&error("Bad block header in flate stream"),(I|=z<<8)!=(65535&~P)&&error("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var N=this.bufferLength,_=this.ensureBuffer(N+P),F=N+P;this.bufferLength=F;for(var j=N;j<F;++j){if(void 0===(z=T[O++])){this.eof=!0;break}_[j]=z}this.bytesPos=O}}});return n.FlateStream=u}),define("skylark-io-streams/LZWStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=r.inherit({klassName:"LZWStream",init:function(t,e){this.str=t,this.dict=t.dict,this.cachedData=0,this.bitsCached=0;for(var n={earlyChange:e,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(4096),dictionaryLengths:new Uint16Array(4096),dictionaryPrevCodes:new Uint16Array(4096),currentSequence:new Uint8Array(4096),currentSequenceLength:0},i=0;i<256;++i)n.dictionaryValues[i]=i,n.dictionaryLengths[i]=1;this.lzwState=n,r.prototype.init.call(this)},readBits:function(t){for(var e=this.bitsCached,n=this.cachedData;e<t;){var r=this.str.getByte();if(null==r)return this.eof=!0,null;n=n<<8|r,e+=8}return this.bitsCached=e-=t,this.cachedData=n,this.lastCode=null,n>>>e&(1<<t)-1},readBlock:function(){var t,e,n,r=1024,i=this.lzwState;if(i){var s=i.earlyChange,a=i.nextCode,o=i.dictionaryValues,l=i.dictionaryLengths,u=i.dictionaryPrevCodes,c=i.codeLength,h=i.prevCode,f=i.currentSequence,d=i.currentSequenceLength,p=0,m=this.bufferLength,g=this.ensureBuffer(this.bufferLength+r);for(t=0;t<512;t++){var y=this.readBits(c),v=d>0;if(y<256)f[0]=y,d=1;else{if(!(y>=258)){if(256==y){c=9,a=258,d=0;continue}this.eof=!0,delete this.lzwState;break}if(y<a)for(d=l[y],e=d-1,n=y;e>=0;e--)f[e]=o[n],n=u[n];else f[d++]=f[0]}if(v&&(u[a]=h,l[a]=l[h]+1,o[a]=f[0],c=++a+s&a+s-1?c:0|Math.min(Math.log(a+s)/.6931471805599453+1,12)),h=y,r<(p+=d)){do{r+=512}while(r<p);g=this.ensureBuffer(this.bufferLength+r)}for(e=0;e<d;e++)g[m++]=f[e]}i.nextCode=a,i.codeLength=c,i.prevCode=h,i.currentSequenceLength=d,this.bufferLength=m}}});return n.LZWStream=i}),define("skylark-io-streams/PredictorStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=r.inherit({klassName:"PredictorStream",init:function(t,e){var n=this.predictor=e.get("Predictor")||1;if(n<=1)return t;2!==n&&(n<10||n>15)&&error("Unsupported predictor: "+n),this.readBlock=2===n?this.readBlockTiff:this.readBlockPng,this.stream=t,this.dict=t.dict;var i=this.colors=e.get("Colors")||1,s=this.bits=e.get("BitsPerComponent")||8,a=this.columns=e.get("Columns")||1;this.pixBytes=i*s+7>>3,this.rowBytes=a*i*s+7>>3,r.prototype.init.call(this)},readBlockTiff:function(){var t=this.rowBytes,e=this.bufferLength,n=this.ensureBuffer(e+t),r=this.bits,i=this.colors,s=this.stream.getBytes(t),a=0,o=0,l=0,u=0,c=e;if(1===r)for(var h=0;h<t;++h){var f=s[h];a=a<<8|f,n[c++]=255&(f^a>>i),a&=65535}else if(8===r){for(var h=0;h<i;++h)n[c++]=s[h];for(;h<t;++h)n[c]=n[c-i]+s[h],c++}else{for(var d=new Uint8Array(i+1),p=(1<<r)-1,m=0,g=e,y=this.columns,h=0;h<y;++h)for(var v=0;v<i;++v)l<r&&(a=a<<8|255&s[m++],l+=8),d[v]=d[v]+(a>>l-r)&p,l-=r,o=o<<r|d[v],(u+=r)>=8&&(n[g++]=o>>u-8&255,u-=8);u>0&&(n[g++]=(o<<8-u)+(a&(1<<8-u)-1))}this.bufferLength+=t},readBlockPng:function(){var t=this.rowBytes,e=this.pixBytes,n=this.stream.getByte(),r=this.stream.getBytes(t),i=this.bufferLength,s=this.ensureBuffer(i+t),a=s.subarray(i-t,i);0==a.length&&(a=new Uint8Array(t));var o=i;switch(n){case 0:for(var l=0;l<t;++l)s[o++]=r[l];break;case 1:for(var l=0;l<e;++l)s[o++]=r[l];for(;l<t;++l)s[o]=s[o-e]+r[l]&255,o++;break;case 2:for(var l=0;l<t;++l)s[o++]=a[l]+r[l]&255;break;case 3:for(var l=0;l<e;++l)s[o++]=(a[l]>>1)+r[l];for(;l<t;++l)s[o]=(a[l]+s[o-e]>>1)+r[l]&255,o++;break;case 4:for(var l=0;l<e;++l){var u=a[l],c=r[l];s[o++]=u+c}for(;l<t;++l){var u=a[l],h=a[l-e],f=s[o-e],d=f+u-h,p=d-f;p<0&&(p=-p);var m=d-u;m<0&&(m=-m);var g=d-h;g<0&&(g=-g);var c=r[l];s[o++]=p<=m&&p<=g?f+c:m<=g?u+c:h+c}break;default:error("Unsupported predictor: "+n)}this.bufferLength+=t}});return n.PredictorStream=i}),define("skylark-io-streams/StreamsSequenceStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./DecodeStream"],function(t,e,n,r){var i=r.inherit({klassName:"StreamsSequenceStream",init:function(t){this.dict=stream.dict,r.prototype.init.call(this)},readBlock:function(){var t=this.streams;if(0!=t.length){var e=t.shift(),n=e.getBytes(),r=this.bufferLength,i=r+n.length,s=this.ensureBuffer(i);s.set(n,r),this.bufferLength=i}else this.eof=!0}});return n.StreamsSequenceStream=i}),define("skylark-io-streams/StringStream",["skylark-langx/skylark","skylark-langx/langx","./streams","./Stream"],function(t,e,n,r){var i=r.inherit({klassName:"StringStream",init:function(t){for(var e=t.length,n=new Uint8Array(e),r=0;r<e;++r)n[r]=t.charCodeAt(r);DecodeStream.prototype.init.call(this)}});return n.StringStream=i}),define("skylark-io-streams/main",["./streams","./Ascii85Stream","./AsciiHexStream","./ChunkedStream","./DecodeStream","./DecryptStream","./FakeStream","./FlateStream","./LZWStream","./PredictorStream","./Stream","./StreamsSequenceStream","./StringStream"],function(t){return t}),define("skylark-io-streams",["skylark-io-streams/main"],function(t){return t}),define("skylark-slax-runtime/main",["./slax","./caches","skylark-langx","skylark-domx","skylark-domx-files","skylark-domx-images","skylark-domx-colors","skylark-jquery","skylark-ajaxify-spa","skylark-ajaxify-shells","skylark-data-entities","skylark-io-streams"],function(t){return t}),define("skylark-slax-runtime",["skylark-slax-runtime/main"],function(t){return t})}(define,require),!isAmd){var skylarkjs=require("skylark-langx-ns");isCmd?module.exports=skylarkjs:globals.skylarkjs=skylarkjs}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-slax-runtime-all.js.map
